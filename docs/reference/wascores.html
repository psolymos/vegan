<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Weighted Averages Scores for Species — wascores • vegan</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Weighted Averages Scores for Species — wascores" />
<meta property="og:description" content="Computes Weighted Averages scores of species for ordination
  configuration or for environmental variables." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vegandevs/vegan">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Weighted Averages Scores for Species</h1>
    
    <div class="hidden name"><code>wascores.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes Weighted Averages scores of species for ordination
  configuration or for environmental variables.</p>
    </div>

    <pre class="usage"><span class='fu'>wascores</span>(<span class='no'>x</span>, <span class='no'>w</span>, <span class='kw'>expand</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='fu'>eigengrad</span>(<span class='no'>x</span>, <span class='no'>w</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>Environmental variables or ordination scores.</p></td>
    </tr>
    <tr>
      <th>w</th>
      <td><p>Weights: species abundances.</p></td>
    </tr>
    <tr>
      <th>expand</th>
      <td><p>Expand weighted averages so that they have the same
    weighted variance as the corresponding environmental variables.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Function <code>wascores</code> computes weighted averages. Weighted averages
  &#8220;shrink&#8221;: they cannot be more extreme than values used for
  calculating the averages. With <code>expand = TRUE</code>, the function
  &#8220;deshrinks&#8221; the weighted averages by making their biased
  weighted variance equal to the biased weighted variance of the
  corresponding environmental variable.  Function <code>eigengrad</code>
  returns the inverses of squared expansion factors or the attribute
  <code>shrinkage</code> of the <code>wascores</code> result for each environmental
  gradient.  This is equal to the constrained eigenvalue of
  <code><a href='cca.html'>cca</a></code> when only this one gradient was used as a
  constraint, and describes the strength of the gradient.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Function <code>wascores</code> returns a matrix where species define rows
  and ordination axes or environmental variables define columns. If
  <code>expand = TRUE</code>, attribute <code>shrinkage</code> has the inverses of
  squared expansion factors or <code><a href='cca.html'>cca</a></code> eigenvalues for the
  variable.  Function <code>eigengrad</code> returns only the <code>shrinkage</code>
  attribute.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='monoMDS.html'>monoMDS</a></code>, <code><a href='cca.html'>cca</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>varespec</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>varechem</span>)
<span class='no'>vare.dist</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='vegdist.html'>vegdist</a></span>(<span class='fu'><a href='decostand.html'>wisconsin</a></span>(<span class='no'>varespec</span>))
<span class='no'>vare.mds</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='monoMDS.html'>monoMDS</a></span>(<span class='no'>vare.dist</span>)
<span class='no'>vare.points</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='metaMDS.html'>postMDS</a></span>(<span class='no'>vare.mds</span>$<span class='no'>points</span>, <span class='no'>vare.dist</span>)
<span class='no'>vare.wa</span> <span class='kw'>&lt;-</span> <span class='fu'>wascores</span>(<span class='no'>vare.points</span>, <span class='no'>varespec</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='scores.html'>scores</a></span>(<span class='no'>vare.points</span>), <span class='kw'>pch</span><span class='kw'>=</span><span class='st'>"+"</span>, <span class='kw'>asp</span><span class='kw'>=</span><span class='fl'>1</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span>(<span class='no'>vare.wa</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span>(<span class='no'>vare.wa</span>), <span class='kw'>cex</span><span class='kw'>=</span><span class='fl'>0.8</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"blue"</span>)</div><div class='img'><img src='wascores-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## Omit rare species (frequency &lt;= 4)</span>
<span class='no'>freq</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='no'>varespec</span><span class='kw'>&gt;</span><span class='fl'>0</span>, <span class='fl'>2</span>, <span class='no'>sum</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='scores.html'>scores</a></span>(<span class='no'>vare.points</span>), <span class='kw'>pch</span><span class='kw'>=</span><span class='st'>"+"</span>, <span class='kw'>asp</span><span class='kw'>=</span><span class='fl'>1</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span>(<span class='no'>vare.wa</span>[<span class='no'>freq</span> <span class='kw'>&gt;</span> <span class='fl'>4</span>,], <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span>(<span class='no'>vare.wa</span>)[<span class='no'>freq</span> <span class='kw'>&gt;</span> <span class='fl'>4</span>],<span class='kw'>cex</span><span class='kw'>=</span><span class='fl'>0.8</span>,<span class='kw'>col</span><span class='kw'>=</span><span class='st'>"blue"</span>)</div><div class='img'><img src='wascores-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## Works for environmental variables, too.</span>
<span class='fu'>wascores</span>(<span class='no'>varechem</span>, <span class='no'>varespec</span>)</div><div class='output co'>#&gt;                 N        P         K       Ca        Mg        S        Al
#&gt; Callvulg 25.12401 41.66188 246.92383 572.3431  99.40828 49.10552 245.15751
#&gt; Empenigr 21.61371 44.17350 158.92517 580.8403  89.20628 35.75327 107.05670
#&gt; Rhodtome 22.34553 40.35530 162.31108 643.8819  95.07712 30.84303  28.83159
#&gt; Vaccmyrt 24.96352 49.80649 189.70177 656.4179  96.75529 34.55190  32.75705
#&gt; Vaccviti 21.14028 45.86984 162.12372 613.2126  94.30084 37.26975 116.14656
#&gt; Pinusylv 18.37299 44.24818 163.60195 670.9387  93.52214 37.02238 150.45523
#&gt; Descflex 22.24089 54.74804 212.20357 771.0159 114.15179 38.00000  24.64143
#&gt; Betupube 21.51034 28.86552 112.28276 513.5586  75.15172 23.55172  33.12414
#&gt; Vacculig 28.00729 33.48758 114.90230 372.9653  70.89954 29.32378 202.89008
#&gt; Diphcomp 22.34228 39.71049 127.44259 446.1565  80.16173 32.32963 122.31574
#&gt; Dicrsp   21.33007 60.03758 185.04563 828.0544 148.67509 46.75427  90.42294
#&gt; Dicrfusc 23.45681 39.14575 162.91954 578.2309  77.81648 33.48086  60.66890
#&gt; Dicrpoly 20.65446 43.87409 150.51485 665.5845 115.22112 36.17079  90.16733
#&gt; Hylosple 26.10599 67.88980 245.78681 779.6520 111.96685 42.27433  24.92738
#&gt; Pleuschr 22.60476 54.22534 199.96241 712.6278 109.23425 40.01132  70.43900
#&gt; Polypili 23.17377 43.75902 144.82623 724.9738  85.42623 30.58525 145.73115
#&gt; Polyjuni 22.89480 47.98022 154.81906 643.3864  87.27819 33.63863  53.24888
#&gt; Polycomm 21.73521 41.17042 154.91549 631.8704 101.84789 32.17324  46.80986
#&gt; Pohlnuta 19.99885 48.59198 169.68855 678.3813 104.31641 39.94427 132.05458
#&gt; Ptilcili 21.27880 33.44211 127.08522 564.5652  85.96417 27.11720  56.60692
#&gt; Barbhatc 21.17461 27.93323 113.13542 497.9138  77.50564 23.72288  42.09749
#&gt; Cladarbu 23.56127 38.04952 142.03073 454.9019  74.00779 33.81002 173.12698
#&gt; Cladrang 24.28421 38.60534 135.31177 463.2750  70.54209 32.53349 183.79979
#&gt; Cladstel 19.28049 46.71060 158.00576 540.4904  80.19153 40.29106 225.89526
#&gt; Cladunci 21.41240 45.49844 163.40402 621.9100  98.35538 40.00734 119.59481
#&gt; Cladcocc 21.72473 42.80681 156.32330 557.9007  80.95448 36.25161 149.82616
#&gt; Cladcorn 22.11640 47.06656 160.36881 623.5185  95.17781 36.75273 104.71463
#&gt; Cladgrac 22.51887 44.06576 156.50214 583.1558  94.10292 36.93930 134.13424
#&gt; Cladfimb 21.77980 41.82652 153.29444 512.4646  78.28232 35.62323 128.96061
#&gt; Cladcris 20.88795 44.12262 171.04016 574.5672  92.52169 38.24003 116.03507
#&gt; Cladchlo 19.51207 45.39655 150.93190 571.0233  95.77586 39.50862 156.81983
#&gt; Cladbotr 22.97660 38.89574 167.20000 590.8021  99.57234 34.79362  87.75957
#&gt; Cladamau 25.07143 35.84286 105.07857 395.2214  68.18571 27.11429  95.91429
#&gt; Cladsp   19.21923 47.37308 168.49231 526.7654  79.54423 45.15385 215.33846
#&gt; Cetreric 21.00944 47.76972 165.07972 579.6322  99.14944 42.25472 163.46000
#&gt; Cetrisla 18.36552 42.73695 151.78374 626.2813  89.77833 35.33498 132.68227
#&gt; Flavniva 18.56110 61.18194 207.67705 502.9203  60.91755 50.22532 396.82405
#&gt; Nepharct 23.33099 49.10019 146.84715 618.1601  64.27319 29.95760  31.72300
#&gt; Stersp   28.19743 32.84800  94.33459 389.5143  53.25377 24.22175  95.39326
#&gt; Peltapht 21.08553 54.45395 193.38816 886.5487 119.35132 37.92500 106.16447
#&gt; Icmaeric 28.88636 27.00000  87.86818 307.0500  40.48182 22.17273  89.94091
#&gt; Cladcerv 20.25000 56.79000 192.36000 519.2300  62.10000 45.18000 314.92000
#&gt; Claddefo 22.19198 45.22981 167.73069 583.7983  92.01320 38.51369 100.46139
#&gt; Cladphyl 15.73750 54.56875 180.39375 775.4500  99.65625 43.35000 208.55000
#&gt;                  Fe        Mn        Zn        Mo  Baresoil Humdepth       pH
#&gt; Callvulg  75.457843  52.38247  8.281074 0.4734635 27.241036 2.187819 2.845108
#&gt; Empenigr  38.146102  53.49357  7.159938 0.3289657 27.324317 2.367439 2.888078
#&gt; Rhodtome   5.560906  70.48260  7.444100 0.2251490 37.325030 2.689154 2.895352
#&gt; Vaccmyrt   5.589213  75.17221  7.838533 0.2666732 31.404171 2.798935 2.855216
#&gt; Vaccviti  37.586067  51.81515  7.617213 0.3680289 26.307701 2.307879 2.923128
#&gt; Pinusylv  39.121898  35.22311  7.733333 0.3485401 17.762968 1.996350 3.049148
#&gt; Descflex   6.066429 110.87232  9.526607 0.2316071 22.740179 2.834821 2.822857
#&gt; Betupube   5.417241  37.53448  5.637931 0.2068966 51.496552 2.527586 2.979310
#&gt; Vacculig  93.963929  37.73062  4.593824 0.3780552 21.410710 2.041196 3.006965
#&gt; Diphcomp  73.281173  46.88025  4.593827 0.3725309 31.836574 2.103704 2.856790
#&gt; Dicrsp    22.504617  65.35020 13.060765 0.5610370 23.182889 2.232247 2.954272
#&gt; Dicrfusc  13.922252  61.40958  6.922859 0.3218816 26.918674 2.484399 2.806431
#&gt; Dicrpoly  20.973927  33.28779  9.110561 0.3892739 37.304043 2.228713 3.015842
#&gt; Hylosple   4.729157 115.14606  9.885976 0.2851996 20.956264 2.925000 2.807594
#&gt; Pleuschr  19.113811  77.12277  9.007860 0.3405945 24.584979 2.596881 2.858446
#&gt; Polypili  51.993443  36.74754  8.045902 0.2204918 17.368852 1.493443 3.227869
#&gt; Polyjuni  12.885704  82.56274  7.945126 0.2760289 28.116303 2.615523 2.874729
#&gt; Polycomm   7.895775  68.22535  7.843662 0.2591549 38.687324 2.926761 2.860563
#&gt; Pohlnuta  33.089313  42.02290  8.452290 0.3935115 24.709351 2.147328 2.985496
#&gt; Ptilcili  14.036188  33.93547  5.906924 0.2303712 48.941884 2.502498 2.973376
#&gt; Barbhatc   8.199687  31.11379  5.550784 0.2084639 54.331975 2.514734 2.986834
#&gt; Cladarbu  65.470394  38.28429  6.387500 0.4464046 22.592997 2.048540 2.937879
#&gt; Cladrang  76.612752  34.86010  6.616452 0.3903501 17.270158 1.799128 3.022346
#&gt; Cladstel  84.639467  33.27903  7.287216 0.4054879  9.854042 1.851973 3.052167
#&gt; Cladunci  27.463504  40.10322  9.108102 0.5120114 28.312376 2.362687 2.858564
#&gt; Cladcocc  46.653763  43.53584  7.269176 0.3698925 19.972222 2.025090 2.974194
#&gt; Cladcorn  32.916238  53.38441  7.518489 0.3639871 26.620868 2.399518 2.890997
#&gt; Cladgrac  45.758366  44.63911  7.702724 0.4244163 25.546654 2.230350 2.933658
#&gt; Cladfimb  41.710354  47.83687  6.815152 0.3887626 24.763889 2.239394 2.902778
#&gt; Cladcris  34.729585  44.75984  6.933735 0.3746988 29.711352 2.400000 2.841633
#&gt; Cladchlo  42.089655  35.13276  7.908621 0.3814655 22.319655 2.075000 3.022414
#&gt; Cladbotr  23.374468  46.54255  7.263830 0.3106383 45.725532 2.580851 2.904255
#&gt; Cladamau  68.971429  41.98571  4.928571 0.3214286 27.592857 1.857143 2.914286
#&gt; Cladsp    47.913462  49.61923  8.421154 0.6173077 16.864423 2.213462 2.921154
#&gt; Cetreric  42.614167  36.96694  9.516389 0.5687500 21.452639 2.058056 2.923889
#&gt; Cetrisla  29.617734  33.24138  7.518227 0.3192118 26.417980 2.027586 3.065025
#&gt; Flavniva  94.339916  37.03232  9.116371 0.9987764 19.692312 1.799241 2.923629
#&gt; Nepharct  12.910837 115.15684  7.743536 0.2180608 23.135932 2.541065 2.918251
#&gt; Stersp    30.226998  31.97061  7.635502 0.2828767 15.844007 1.477740 3.038756
#&gt; Peltapht  37.598684  56.64079  7.652632 0.2046053 28.321053 2.286842 3.026316
#&gt; Icmaeric  24.236364  23.95909  6.618182 0.2863636 18.727273 1.568182 2.968182
#&gt; Cladcerv 111.090000  52.04000  8.530000 0.6800000 15.393000 1.870000 2.900000
#&gt; Claddefo  25.116325  48.81105  7.599609 0.4096285 33.814545 2.468133 2.823656
#&gt; Cladphyl  50.475000  35.28125  8.568750 0.2812500  7.728125 1.575000 3.231250</div><div class='input'><span class='co'>## And the strengths of these variables are:</span>
<span class='fu'>eigengrad</span>(<span class='no'>varechem</span>, <span class='no'>varespec</span>)</div><div class='output co'>#&gt;          N          P          K         Ca         Mg          S         Al 
#&gt; 0.13000842 0.18880078 0.16246365 0.15722067 0.16359171 0.13391967 0.29817406 
#&gt;         Fe         Mn         Zn         Mo   Baresoil   Humdepth         pH 
#&gt; 0.20766831 0.27254480 0.16783834 0.09542514 0.20931501 0.25051326 0.14583161 </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Jari Oksanen</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


