<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Detrended Correspondence Analysis and Basic Reciprocal Averaging — decorana • vegan</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Detrended Correspondence Analysis and Basic Reciprocal Averaging — decorana" />
<meta property="og:description" content="Performs detrended correspondence analysis and basic reciprocal
  averaging or orthogonal correspondence analysis." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vegandevs/vegan">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Detrended Correspondence Analysis and Basic Reciprocal Averaging</h1>
    
    <div class="hidden name"><code>decorana.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs detrended correspondence analysis and basic reciprocal
  averaging or orthogonal correspondence analysis.</p>
    </div>

    <pre class="usage"><span class='fu'>decorana</span>(<span class='no'>veg</span>, <span class='kw'>iweigh</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>iresc</span><span class='kw'>=</span><span class='fl'>4</span>, <span class='kw'>ira</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>mk</span><span class='kw'>=</span><span class='fl'>26</span>, <span class='kw'>short</span><span class='kw'>=</span><span class='fl'>0</span>,
         <span class='kw'>before</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>after</span><span class='kw'>=</span><span class='kw'>NULL</span>)

<span class='co'># S3 method for decorana</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>x</span>, <span class='kw'>choices</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>), <span class='kw'>origin</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
     <span class='kw'>display</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"both"</span>,<span class='st'>"sites"</span>,<span class='st'>"species"</span>,<span class='st'>"none"</span>),
     <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>0.8</span>, <span class='kw'>cols</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>), <span class='no'>type</span>, <span class='no'>xlim</span>, <span class='no'>ylim</span>, <span class='no'>...</span>)

<span class='co'># S3 method for decorana</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span>(<span class='no'>x</span>, <span class='kw'>display</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"sites"</span>, <span class='st'>"species"</span>), <span class='no'>labels</span>,
     <span class='kw'>choices</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>2</span>, <span class='kw'>origin</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>select</span>,  <span class='no'>...</span>)

<span class='co'># S3 method for decorana</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='no'>x</span>, <span class='kw'>display</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"sites"</span>, <span class='st'>"species"</span>),
       <span class='kw'>choices</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>2</span>, <span class='kw'>origin</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>select</span>, <span class='no'>...</span>)

<span class='co'># S3 method for decorana</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>object</span>, <span class='kw'>digits</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>origin</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
        <span class='kw'>display</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"both"</span>, <span class='st'>"species"</span>,<span class='st'>"sites"</span>,<span class='st'>"none"</span>), <span class='no'>...</span>)

<span class='co'># S3 method for summary.decorana</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>x</span>, <span class='kw'>head</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>tail</span> <span class='kw'>=</span> <span class='no'>head</span>, <span class='no'>...</span>)

<span class='fu'>downweight</span>(<span class='no'>veg</span>, <span class='kw'>fraction</span> <span class='kw'>=</span> <span class='fl'>5</span>)

<span class='co'># S3 method for decorana</span>
<span class='fu'><a href='scores.html'>scores</a></span>(<span class='no'>x</span>, <span class='kw'>display</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"sites"</span>,<span class='st'>"species"</span>), <span class='kw'>choices</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>4</span>,
       <span class='kw'>origin</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>veg</th>
      <td><p>Community data, a matrix-like object.</p></td>
    </tr>
    <tr>
      <th>iweigh</th>
      <td><p>Downweighting of rare species (0: no).</p></td>
    </tr>
    <tr>
      <th>iresc</th>
      <td><p>Number of rescaling cycles (0: no rescaling).</p></td>
    </tr>
    <tr>
      <th>ira</th>
      <td><p>Type of analysis (0: detrended, 1: basic reciprocal averaging).</p></td>
    </tr>
    <tr>
      <th>mk</th>
      <td><p>Number of segments in rescaling.</p></td>
    </tr>
    <tr>
      <th>short</th>
      <td><p>Shortest gradient to be rescaled.</p></td>
    </tr>
    <tr>
      <th>before</th>
      <td><p>Hill's piecewise transformation: values before transformation.</p></td>
    </tr>
    <tr>
      <th>after</th>
      <td><p>Hill's piecewise transformation: values after
  transformation -- these must correspond to values in <code>before</code>.</p></td>
    </tr>
    <tr>
      <th>x, object</th>
      <td><p>A <code>decorana</code> result object.</p></td>
    </tr>
    <tr>
      <th>choices</th>
      <td><p>Axes shown.</p></td>
    </tr>
    <tr>
      <th>origin</th>
      <td><p>Use true origin even in detrended correspondence analysis.</p></td>
    </tr>
    <tr>
      <th>display</th>
      <td><p>Display only sites, only species, both or neither.</p></td>
    </tr>
    <tr>
      <th>cex</th>
      <td><p>Plot character size.</p></td>
    </tr>
    <tr>
      <th>cols</th>
      <td><p>Colours used for sites and species.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Type of plots, partial match to <code>"text"</code>,
    <code>"points"</code> or <code>"none"</code>.</p></td>
    </tr>
    <tr>
      <th>labels</th>
      <td><p>Optional text to be used instead of row names.</p></td>
    </tr>
    <tr>
      <th>select</th>
      <td><p>Items to be displayed.  This can either be a logical
    vector which is <code>TRUE</code> for displayed items or a vector of indices
    of displayed items.</p></td>
    </tr>
    <tr>
      <th>xlim, ylim</th>
      <td><p>the x and y limits (min,max) of the plot.</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>Number of digits in summary output.</p></td>
    </tr>
    <tr>
      <th>head, tail</th>
      <td><p>Number of rows printed from the head and tail of
    species and site scores. Default <code>NA</code> prints all.</p></td>
    </tr>
    <tr>
      <th>fraction</th>
      <td><p>Abundance fraction where downweighting begins.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments for <code>plot</code> function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In late 1970s, correspondence analysis became the method of choice for
  ordination in vegetation science, since it seemed better able to cope 
  with non-linear species responses than principal components
  analysis. However, even correspondence analysis can produce an arc-shaped
  configuration of a single gradient. Mark Hill developed detrended
  correspondence analysis to correct two assumed &#8216;faults&#8217; in 
  correspondence analysis: curvature of straight gradients and packing
  of sites at the ends of the gradient.</p>
<p>The curvature is removed by replacing the orthogonalization of axes
  with detrending.  In orthogonalization successive axes are made
  non-correlated, but detrending should remove all systematic dependence
  between axes.  Detrending is performed using a five-segment smoothing
  window with weights (1,2,3,2,1) on <code>mk</code> segments --- which indeed
  is more robust than the suggested alternative of detrending by
  polynomials. The packing of sites at the ends of the gradient is
  undone by rescaling the axes after extraction.  After rescaling, the
  axis is supposed to be scaled by &#8216;SD&#8217; units, so that the average width
  of Gaussian species responses is supposed to be one over whole axis.
  Other innovations were the piecewise linear transformation of species
  abundances and downweighting of rare species which were regarded to
  have an unduly high influence on ordination axes.</p>
<p>It seems that detrending actually works by twisting the ordination
  space, so that the results look non-curved in two-dimensional projections
  (&#8216;lolly paper effect&#8217;).  As a result, the points usually have an
  easily recognized triangular or diamond shaped pattern, obviously an
  artefact of detrending.  Rescaling works differently than commonly
  presented, too. <code>decorana</code> does not use, or even evaluate, the
  widths of species responses.  Instead, it tries to equalize the
  weighted variance of species scores on axis segments (parameter
  <code>mk</code> has only a small effect, since <code>decorana</code> finds the
  segment number from the current estimate of axis length).  This 
  equalizes response widths only for the idealized species packing
  model, where all species initially have unit width responses and
  equally spaced modes.</p>
<p>The <code>summary</code> method prints the ordination scores,
  possible prior weights used in downweighting, and the marginal totals
  after applying these weights. The <code>plot</code> method plots
  species and site scores.  Classical <code>decorana</code> scaled the axes
  so that smallest site score was 0 (and smallest species score was
  negative), but <code>summary</code>, <code>plot</code> and
  <code>scores</code> use the true origin, unless <code>origin = FALSE</code>.</p>
<p>In addition to proper eigenvalues, the function also reports
  &#8216;decorana values&#8217; in detrended analysis. These &#8216;decorana
  values&#8217; are the values that the legacy code of <code>decorana</code> returns
  as eigenvalues.  They are estimated internally during iteration, and
  it seems that detrending interferes the estimation so that these
  values are generally too low and have unclear
  interpretation. Moreover, &#8216;decorana values&#8217; are estimated
  before rescaling which will change the eigenvalues. The proper
  eigenvalues are estimated after extraction of the axes and they are
  the ratio of biased weighted variances of site and species scores even
  in detrended and rescaled solutions. The &#8216;decorana values&#8217; are
  provided only for the compatibility with legacy software, and they
  should not be used.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>decorana</code> returns an object of class <code>"decorana"</code>, which has
  <code>print</code>, <code>summary</code> and <code>plot</code> methods.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Hill, M.O. and Gauch, H.G. (1980). Detrended correspondence analysis:
  an improved ordination technique. <em>Vegetatio</em> <strong>42</strong>,
  47--58.</p>
<p>Oksanen, J. and Minchin, P.R. (1997). Instability of ordination
  results under changes in input data order: explanations and
  remedies. <em>Journal of Vegetation Science</em> <strong>8</strong>, 447--454.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p><code>decorana</code> uses the central numerical engine of the
  original Fortran code (which is in the public domain), or about 1/3 of
  the original program.  I have tried to implement the original
  behaviour, although a great part of preparatory steps were written in
  <span style="R">R</span> language, and may differ somewhat from the original code. However,
  well-known bugs are corrected and strict criteria used (Oksanen &amp;
  Minchin 1997).</p>
<p>Please note that there really is no need for piecewise transformation
  or even downweighting within <code>decorana</code>, since there are more
  powerful and extensive alternatives in <span style="R">R</span>, but these options are
  included for compliance with the original software.  If a different
  fraction of abundance is needed in downweighting, function
  <code>downweight</code> must be applied before <code>decorana</code>.  Function
  <code>downweight</code> indeed can be applied prior to correspondence
  analysis, and so it can be used together with <code><a href='cca.html'>cca</a></code>, too.</p>
<p>The function finds only four axes: this is not easily changed.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>For unconstrained ordination, non-metric multidimensional scaling in
  <code><a href='monoMDS.html'>monoMDS</a></code> may be more robust (see also
  <code><a href='metaMDS.html'>metaMDS</a></code>).  Constrained (or &#8216;canonical&#8217;)
  correspondence analysis can be made with <code><a href='cca.html'>cca</a></code>.
  Orthogonal correspondence analysis can be made with
  <code><a href='https://rdrr.io/pkg/MASS/man/corresp.html'>corresp</a></code>, or with <code>decorana</code> or
  <code><a href='cca.html'>cca</a></code>, but the scaling of results vary (and the one in
  <code>decorana</code> corresponds to <code>scaling = "sites"</code> and
  <code>hill = TRUE</code> in <code><a href='cca.html'>cca</a></code>.).  See
  <code><a href='predict.cca.html'>predict.decorana</a></code> for adding new points to an
  ordination.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>varespec</span>)
<span class='no'>vare.dca</span> <span class='kw'>&lt;-</span> <span class='fu'>decorana</span>(<span class='no'>varespec</span>)
<span class='no'>vare.dca</span></div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; decorana(veg = varespec) 
#&gt; 
#&gt; Detrended correspondence analysis with 26 segments.
#&gt; Rescaling of axes with 4 iterations.
#&gt; 
#&gt;                   DCA1   DCA2    DCA3    DCA4
#&gt; Eigenvalues     0.5235 0.3253 0.20010 0.19176
#&gt; Decorana values 0.5249 0.1572 0.09669 0.06075
#&gt; Axis lengths    2.8161 2.2054 1.54650 1.64864
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>vare.dca</span>)</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; decorana(veg = varespec) 
#&gt; 
#&gt; Detrended correspondence analysis with 26 segments.
#&gt; Rescaling of axes with 4 iterations.
#&gt; 
#&gt;                   DCA1   DCA2    DCA3    DCA4
#&gt; Eigenvalues     0.5235 0.3253 0.20010 0.19176
#&gt; Decorana values 0.5249 0.1572 0.09669 0.06075
#&gt; Axis lengths    2.8161 2.2054 1.54650 1.64864
#&gt; </div><div class='output co'>#&gt; Species scores:
#&gt; 
#&gt;              DCA1     DCA2     DCA3     DCA4 Totals
#&gt; Callvulg  0.04119 -1.53268 -2.55101  1.32277  45.07
#&gt; Empenigr  0.09019  0.82274  0.20569  0.30631 151.99
#&gt; Rhodtome  1.34533  2.47141 -0.34970 -1.13823   8.39
#&gt; Vaccmyrt  1.86298  1.71424 -0.60535 -0.40205  50.71
#&gt; Vaccviti  0.16641  0.71095  0.00313 -0.55801 275.03
#&gt; Pinusylv -0.73490  1.62050 -1.60275 -2.10199   4.11
#&gt; Descflex  1.97061  1.81651  1.74896 -0.91463   5.60
#&gt; Betupube  0.79745  3.36374 -0.94546 -1.01741   0.29
#&gt; Vacculig -0.08912 -1.17478  2.86624  0.87025  15.22
#&gt; Diphcomp -0.82669 -0.44195  2.58579 -0.38459   3.24
#&gt; Dicrsp    2.37743 -0.27373 -0.47099 -1.89036  40.50
#&gt; Dicrfusc  1.58267 -1.33770 -1.33563  1.47417 113.52
#&gt; Dicrpoly  0.86689  2.39519 -0.82064 -3.41534   6.06
#&gt; Hylosple  2.66242  1.19669  1.48288 -0.69978  18.04
#&gt; Pleuschr  1.64098  0.15607  0.30044 -0.26717 377.97
#&gt; Polypili -0.56213  0.14009  0.25198  0.49177   0.61
#&gt; Polyjuni  1.22244 -0.89173  0.61287  3.60066  13.85
#&gt; Polycomm  1.01545  2.08388  0.06402  0.84199   0.71
#&gt; Pohlnuta -0.00712  1.09704 -0.82126 -1.59862   2.62
#&gt; Ptilcili  0.48093  2.86420 -0.71801 -1.02698  14.01
#&gt; Barbhatc  0.58303  3.71792 -0.84212 -1.88837   3.19
#&gt; Cladarbu -0.18554 -1.18973  0.68113  0.55399 255.05
#&gt; Cladrang -0.83427 -0.78085  0.90603  0.70057 388.71
#&gt; Cladstel -1.67768  0.98907 -0.83789 -0.60206 486.71
#&gt; Cladunci  0.97686 -1.70859 -1.68281 -2.26756  56.28
#&gt; Cladcocc -0.27221 -0.76713 -0.63836  0.66927   2.79
#&gt; Cladcorn  0.29068 -0.97039  0.50414  0.95738   6.22
#&gt; Cladgrac  0.21778 -0.41879  0.06530 -0.31472   5.14
#&gt; Cladfimb  0.00889 -0.23922 -0.26505  0.33123   3.96
#&gt; Cladcris  0.37774 -1.09161 -0.55627  0.23868   7.47
#&gt; Cladchlo -0.91983  1.54955 -0.58109 -1.48643   1.16
#&gt; Cladbotr  0.66438  2.19584 -0.90331 -0.91391   0.47
#&gt; Cladamau -0.96418 -0.98992  2.71458  0.52352   0.14
#&gt; Cladsp   -1.12318 -0.15330 -0.69833  0.44040   0.52
#&gt; Cetreric  0.27163 -1.28867 -0.81682 -1.93935   3.60
#&gt; Cetrisla -0.50158  2.22098 -1.16461 -1.89349   2.03
#&gt; Flavniva -1.67937 -3.67985  4.15644  3.18919  11.85
#&gt; Nepharct  2.18561 -0.82837  0.71958  5.81930   5.26
#&gt; Stersp   -0.78699 -2.01214  2.31212  2.03946  17.52
#&gt; Peltapht  0.45763 -0.34395  0.09916  1.34695   0.76
#&gt; Icmaeric  0.04950 -1.97605  1.41509  2.10154   0.22
#&gt; Cladcerv -1.21585 -2.30519  2.55186  3.41532   0.10
#&gt; Claddefo  0.60517 -1.19771 -0.33388  0.22585  10.23
#&gt; Cladphyl -1.53959  1.48574 -1.43209 -1.52387   0.80
#&gt; 
#&gt; Site scores:
#&gt; 
#&gt;       DCA1    DCA2    DCA3    DCA4 Totals
#&gt; 18 -0.1729 -0.2841  0.4775  0.2521   89.2
#&gt; 15  0.8539 -0.3360  0.0708  0.0924   89.8
#&gt; 24  1.2467 -0.1183 -0.1211 -0.8718   94.2
#&gt; 27  1.0675  0.4169  0.2897 -0.1758  125.6
#&gt; 23  0.4234  0.0112  0.2179  0.1265   90.5
#&gt; 19  0.0252  0.3600 -0.0263 -0.1168   81.3
#&gt; 22  1.0695 -0.3707 -0.4285  0.4145  109.8
#&gt; 16  0.7724 -0.5325 -0.2856  0.5269   88.5
#&gt; 28  1.6189  0.5482  0.2342 -0.3333  110.7
#&gt; 13 -0.2642 -0.6851 -0.3777  0.5003  101.9
#&gt; 14  0.6431 -0.9604 -0.6000 -0.2885   81.7
#&gt; 20  0.4504 -0.1666  0.1850 -0.1291   64.1
#&gt; 25  1.2501 -0.2248  0.0244  0.3741   94.1
#&gt; 7  -0.3910 -0.7618  0.8640  0.5557  103.4
#&gt; 5  -0.6407 -0.9427  0.9465  0.7769   94.8
#&gt; 6  -0.4523 -0.5529  0.3988  0.2781  110.9
#&gt; 3  -1.1043  0.2106 -0.0653 -0.0539  106.7
#&gt; 4  -0.9454 -0.5974  0.4639  0.4889   84.8
#&gt; 2  -1.1971  0.5691 -0.3246 -0.2522  119.1
#&gt; 9  -1.0983  0.7850 -0.5274 -0.4848  122.6
#&gt; 12 -0.8673  0.5621 -0.3254 -0.3217  119.8
#&gt; 10 -1.1842  0.7442 -0.4995 -0.3917  122.4
#&gt; 11 -0.4134  0.0260  0.0107 -0.0682  112.8
#&gt; 21  0.3210  1.2450 -0.2541 -0.5253   99.2
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>vare.dca</span>)</div><div class='img'><img src='decorana-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>### the detrending rationale:</span>
<span class='no'>gaussresp</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>,<span class='no'>u</span>) <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span>(-(<span class='no'>x</span>-<span class='no'>u</span>)^<span class='fl'>2</span>/<span class='fl'>2</span>)
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>0</span>,<span class='fl'>6</span>,<span class='kw'>length</span><span class='kw'>=</span><span class='fl'>15</span>) <span class='co'>## The gradient</span>
<span class='no'>u</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>2</span>,<span class='fl'>8</span>,<span class='kw'>len</span><span class='kw'>=</span><span class='fl'>23</span>)   <span class='co'>## The optima</span>
<span class='no'>pack</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/outer.html'>outer</a></span>(<span class='no'>x</span>,<span class='no'>u</span>,<span class='no'>gaussresp</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/matplot.html'>matplot</a></span>(<span class='no'>x</span>, <span class='no'>pack</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"l"</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Species packing"</span>)</div><div class='img'><img src='decorana-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='no'>opar</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='scores.html'>scores</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/prcomp.html'>prcomp</a></span>(<span class='no'>pack</span>)), <span class='kw'>asp</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"b"</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"PCA"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='scores.html'>scores</a></span>(<span class='fu'>decorana</span>(<span class='no'>pack</span>, <span class='kw'>ira</span><span class='kw'>=</span><span class='fl'>1</span>)), <span class='kw'>asp</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"b"</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"CA"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='scores.html'>scores</a></span>(<span class='fu'>decorana</span>(<span class='no'>pack</span>)), <span class='kw'>asp</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"b"</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"DCA"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='scores.html'>scores</a></span>(<span class='fu'><a href='cca.html'>cca</a></span>(<span class='no'>pack</span> ~ <span class='no'>x</span>), <span class='kw'>dis</span><span class='kw'>=</span><span class='st'>"sites"</span>), <span class='kw'>asp</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"b"</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"CCA"</span>)</div><div class='img'><img src='decorana-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>### Let's add some noise:</span>
<span class='no'>noisy</span> <span class='kw'>&lt;-</span> (<span class='fl'>0.5</span> + <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>pack</span>)))*<span class='no'>pack</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>1</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/matplot.html'>matplot</a></span>(<span class='no'>x</span>, <span class='no'>pack</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"l"</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Ideal model"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/matplot.html'>matplot</a></span>(<span class='no'>x</span>, <span class='no'>noisy</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"l"</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Noisy model"</span>)</div><div class='img'><img src='decorana-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='scores.html'>scores</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/prcomp.html'>prcomp</a></span>(<span class='no'>noisy</span>)), <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"b"</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"PCA"</span>, <span class='kw'>asp</span><span class='kw'>=</span><span class='fl'>1</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='scores.html'>scores</a></span>(<span class='fu'>decorana</span>(<span class='no'>noisy</span>, <span class='kw'>ira</span><span class='kw'>=</span><span class='fl'>1</span>)), <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"b"</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"CA"</span>, <span class='kw'>asp</span><span class='kw'>=</span><span class='fl'>1</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='scores.html'>scores</a></span>(<span class='fu'>decorana</span>(<span class='no'>noisy</span>)), <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"b"</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"DCA"</span>, <span class='kw'>asp</span><span class='kw'>=</span><span class='fl'>1</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='scores.html'>scores</a></span>(<span class='fu'><a href='cca.html'>cca</a></span>(<span class='no'>noisy</span> ~ <span class='no'>x</span>), <span class='kw'>dis</span><span class='kw'>=</span><span class='st'>"sites"</span>), <span class='kw'>asp</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"b"</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"CCA"</span>)</div><div class='img'><img src='decorana-5.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='no'>opar</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Mark O. Hill wrote the original Fortran code, the <span style="R">R</span> port was by
  Jari Oksanen.</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


