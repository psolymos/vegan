<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Null Model and Simulation — nullmodel • vegan</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Null Model and Simulation — nullmodel" />
<meta property="og:description" content="The nullmodel function creates an object,
which can serve as a basis for Null Model simulation
via the simulate method.
The update method updates the nullmodel
object without sampling (effective for sequential algorithms).
smbind binds together multiple simmat objects." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vegandevs/vegan">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Null Model and Simulation</h1>
    
    <div class="hidden name"><code>nullmodel.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>nullmodel</code> function creates an object,
which can serve as a basis for Null Model simulation
via the <code><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></code> method.
The <code><a href='https://rdrr.io/r/stats/update.html'>update</a></code> method updates the nullmodel
object without sampling (effective for sequential algorithms).
<code>smbind</code> binds together multiple <code>simmat</code> objects.</p>
    </div>

    <pre class="usage"><span class='fu'>nullmodel</span>(<span class='no'>x</span>, <span class='no'>method</span>)
<span class='co'># S3 method for nullmodel</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>x</span>, <span class='no'>...</span>)
<span class='co'># S3 method for nullmodel</span>
<span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span>(<span class='no'>object</span>, <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
    <span class='kw'>burnin</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>thin</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>...</span>)
<span class='co'># S3 method for nullmodel</span>
<span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span>(<span class='no'>object</span>, <span class='kw'>nsim</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)
<span class='co'># S3 method for simmat</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>x</span>, <span class='no'>...</span>)
<span class='fu'>smbind</span>(<span class='no'>object</span>, <span class='no'>...</span>, <span class='no'>MARGIN</span>, <span class='kw'>strict</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A community matrix.
For the <code>print</code> method, it is an object to be printed.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Character, specifying one of the null model algorithms
listed on the help page of <code><a href='commsim.html'>commsim</a></code>.
It can be a user supplied object of class <code>commsim</code>.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>An object of class <code>nullmodel</code> returned by
the function <code>nullmodel</code>.
In case of <code>smbind</code> it is a <code>simmat</code> object
as returned by the <code>update</code> or <code>simulate</code> methods.</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>Positive integer, the number of simulated matrices to return.
For the <code>update</code> method, it is the number of
burnin steps made for sequential algorithms
to update the status of the input model <code>object</code>.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>An object specifying if and how the random number
generator should be initialized ("seeded").
Either <code>NULL</code> or an integer that will be
used in a call to <code><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></code> before
simulating the matrices.
If set, the value is saved as the
<code>"seed"</code> attribute of the returned value.
The default, <code>NULL</code> will not change the
random generator state, and return
<code><a href='https://rdrr.io/r/base/Random.html'>.Random.seed</a></code> as the <code>"seed"</code>
 attribute, see Value.</p></td>
    </tr>
    <tr>
      <th>burnin</th>
      <td><p>Nonnegative integer, specifying the number of steps
discarded before starting simulation.
Active only for sequential null model algorithms.
Ignored for non-sequential null model algorithms.</p></td>
    </tr>
    <tr>
      <th>thin</th>
      <td><p>Positive integer, number of simulation steps
made between each returned matrix.
Active only for sequential null model algorithms.
Ignored for non-sequential null model algorithms.</p></td>
    </tr>
    <tr>
      <th>MARGIN</th>
      <td><p>Integer, indicating the dimension over which multiple
<code>simmat</code> objects are to be bound together by <code>smbind</code>.
1: matrices are stacked (row bound), 2: matrices are column bound,
3: iterations are combined. Needs to be of length 1.
The other dimensions are expected to match across the objects.</p></td>
    </tr>
    <tr>
      <th>strict</th>
      <td><p>Logical, if consistency of the time series attributes
(<code>"start"</code>, <code>"end"</code>, <code>"thin"</code>, and number of simulated matrices)
of <code>simmat</code> objects are strictly enforced when
binding multiple objects together using <code>smbind</code>.
Applies only to input objects based on sequential
null model algorithms.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments supplied to algorithms.
In case of <code>smbind</code> it can contain multiple <code>simmat</code> objects.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The purpose of the <code>nullmodel</code> function is to
create an object, where all necessary statistics of the
input matrix are calculated only once.
This information is reused, but not recalculated
in each step of the simulation process done by
the <code>simulate</code> method.</p>
<p>The <code>simulate</code> method carries out the simulation,
the simulated matrices are stored in an array.
For sequential algorithms, the method updates the state
of the input <code>nullmodel</code> object.
Therefore, it is possible to do diagnostic
tests on the returned <code>simmat</code> object,
and make further simulations, or use
increased thinning value if desired.</p>
<p>The <code>update</code> method makes burnin steps in case
of sequential algorithms to update the status of the
input model without any attempt to return matrices.
For non-sequential algorithms the method does nothing.</p>
<p><code>update</code> is the preferred way of making burnin iterations
without sampling. Alternatively, burnin can be done
via the <code>simulate</code> method. For convergence
diagnostics, it is recommended to use the
<code>simulate</code> method without burnin.
The input nullmodel object is updated, so further
samples can be simulated if desired without having
to start the process all over again. See Examples.</p>
<p>The <code>smbind</code> function can be used to combine multiple
<code>simmat</code> objects. This comes handy when null model
simulations are stratified by sites (<code>MARGIN = 1</code>)
or by species (<code>MARGIN = 2</code>), or in the case when
multiple objects are returned by identical/consistent settings
e.g. during parallel computations (<code>MARGIN = 3</code>).
Sanity checks are made to ensure that combining multiple
objects is sensible, but it is the user's responsibility
to check independence of the simulated matrices
and the null distribution has converged
in case of sequential null model algorithms.
The <code>strict = FALSE</code> setting can relax
checks regarding start, end, and thinning values
for sequential null models.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function <code>nullmodel</code> returns an object of class <code>nullmodel</code>.
It is a set of objects sharing the same environment:</p><ul>
<li><p><code>data</code>: original matrix in integer mode.</p></li>
<li><p><code>nrow</code>: number of rows.</p></li>
<li><p><code>ncol</code>: number of columns.</p></li>
<li><p><code>rowSums</code>: row sums.</p></li>
<li><p><code>colSums</code>: column sums.</p></li>
<li><p><code>rowFreq</code>: row frequencies (number of nonzero cells).</p></li>
<li><p><code>colFreq</code>: column frequencies (number of nonzero cells).</p></li>
<li><p><code>totalSum</code>: total sum.</p></li>
<li><p><code>fill</code>: number of nonzero cells in the matrix.</p></li>
<li><p><code>commsim</code>: the <code>commsim</code> object as a result
    of the <code>method</code> argument.</p></li>
<li><p><code>state</code>: current state of the permutations,
    a matrix similar to the original.
    It is <code>NULL</code> for non-sequential algorithms.</p></li>
<li><p><code>iter</code>: current number of iterations
  for sequential algorithms.
    It is <code>NULL</code> for non-sequential algorithms.</p></li>
</ul>

<p>The <code>simulate</code> method returns an object of class <code>simmat</code>.
It is an array of simulated matrices (third dimension
corresponding to <code>nsim</code> argument).</p>
<p>The <code>update</code> method returns the current state (last updated matrix)
invisibly, and update the input object for sequential algorithms.
For non sequential algorithms, it returns <code>NULL</code>.</p>
<p>The <code>smbind</code> function returns an object of class <code>simmat</code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='commsim.html'>commsim</a></code>, <code><a href='commsim.html'>make.commsim</a></code>,
<code><a href='permatfull.html'>permatfull</a></code>, <code><a href='permatfull.html'>permatswap</a></code></p></div>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Care must be taken when the input matrix only contains a single
row or column. Such input is invalid for swapping and hypergeometric
distribution (calling <code><a href='https://rdrr.io/r/stats/r2dtable.html'>r2dtable</a></code>) based algorithms.
This also applies to cases when the input is stratified into subsets.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>mite</span>)
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>mite</span>)[<span class='fl'>1</span>:<span class='fl'>12</span>, <span class='fl'>21</span>:<span class='fl'>30</span>]

<span class='co'>## non-sequential nullmodel</span>
(<span class='no'>nm</span> <span class='kw'>&lt;-</span> <span class='fu'>nullmodel</span>(<span class='no'>x</span>, <span class='st'>"r00"</span>))</div><div class='output co'>#&gt; An object of class “nullmodel” 
#&gt; ‘r00’ method (binary, non-sequential)
#&gt; 12 x 10 matrix
#&gt; </div><div class='input'>(<span class='no'>sm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span>(<span class='no'>nm</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>10</span>))</div><div class='output co'>#&gt; An object of class “simmat” 
#&gt; ‘r00’ method (binary, non-sequential)
#&gt; 12 x 10 matrix
#&gt; Number of permuted matrices = 10 
#&gt; </div><div class='input'>
<span class='co'>## sequential nullmodel</span>
(<span class='no'>nm</span> <span class='kw'>&lt;-</span> <span class='fu'>nullmodel</span>(<span class='no'>x</span>, <span class='st'>"swap"</span>))</div><div class='output co'>#&gt; An object of class “nullmodel” 
#&gt; ‘swap’ method (binary, sequential)
#&gt; 12 x 10 matrix
#&gt; Iterations = 0 
#&gt; </div><div class='input'>(<span class='no'>sm1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span>(<span class='no'>nm</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>thin</span><span class='kw'>=</span><span class='fl'>5</span>))</div><div class='output co'>#&gt; An object of class “simmat” 
#&gt; ‘swap’ method (binary, sequential)
#&gt; 12 x 10 matrix
#&gt; Number of permuted matrices = 10 
#&gt; Start = 5, End = 50, Thin = 5
#&gt; </div><div class='input'>(<span class='no'>sm2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span>(<span class='no'>nm</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>thin</span><span class='kw'>=</span><span class='fl'>5</span>))</div><div class='output co'>#&gt; An object of class “simmat” 
#&gt; ‘swap’ method (binary, sequential)
#&gt; 12 x 10 matrix
#&gt; Number of permuted matrices = 10 
#&gt; Start = 55, End = 100, Thin = 5
#&gt; </div><div class='input'>
<span class='co'>## sequential nullmodel with burnin and extra updating</span>
(<span class='no'>nm</span> <span class='kw'>&lt;-</span> <span class='fu'>nullmodel</span>(<span class='no'>x</span>, <span class='st'>"swap"</span>))</div><div class='output co'>#&gt; An object of class “nullmodel” 
#&gt; ‘swap’ method (binary, sequential)
#&gt; 12 x 10 matrix
#&gt; Iterations = 0 
#&gt; </div><div class='input'>(<span class='no'>sm1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span>(<span class='no'>nm</span>, <span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>thin</span><span class='kw'>=</span><span class='fl'>5</span>))</div><div class='output co'>#&gt; An object of class “simmat” 
#&gt; ‘swap’ method (binary, sequential)
#&gt; 12 x 10 matrix
#&gt; Number of permuted matrices = 10 
#&gt; Start = 15, End = 60, Thin = 5
#&gt; </div><div class='input'>(<span class='no'>sm2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span>(<span class='no'>nm</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>thin</span><span class='kw'>=</span><span class='fl'>5</span>))</div><div class='output co'>#&gt; An object of class “simmat” 
#&gt; ‘swap’ method (binary, sequential)
#&gt; 12 x 10 matrix
#&gt; Number of permuted matrices = 10 
#&gt; Start = 5, End = 50, Thin = 5
#&gt; </div><div class='input'>
<span class='co'>## sequential nullmodel with separate initial burnin</span>
(<span class='no'>nm</span> <span class='kw'>&lt;-</span> <span class='fu'>nullmodel</span>(<span class='no'>x</span>, <span class='st'>"swap"</span>))</div><div class='output co'>#&gt; An object of class “nullmodel” 
#&gt; ‘swap’ method (binary, sequential)
#&gt; 12 x 10 matrix
#&gt; Iterations = 0 
#&gt; </div><div class='input'><span class='no'>nm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span>(<span class='no'>nm</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>10</span>)
(<span class='no'>sm2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span>(<span class='no'>nm</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>thin</span><span class='kw'>=</span><span class='fl'>5</span>))</div><div class='output co'>#&gt; An object of class “simmat” 
#&gt; ‘swap’ method (binary, sequential)
#&gt; 12 x 10 matrix
#&gt; Number of permuted matrices = 10 
#&gt; Start = 15, End = 60, Thin = 5
#&gt; </div><div class='input'>
<span class='co'>## combining multiple simmat objects</span>

<span class='co'>## stratification</span>
<span class='no'>nm1</span> <span class='kw'>&lt;-</span> <span class='fu'>nullmodel</span>(<span class='no'>x</span>[<span class='fl'>1</span>:<span class='fl'>6</span>,], <span class='st'>"r00"</span>)
<span class='no'>sm1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span>(<span class='no'>nm1</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>10</span>)
<span class='no'>nm2</span> <span class='kw'>&lt;-</span> <span class='fu'>nullmodel</span>(<span class='no'>x</span>[<span class='fl'>7</span>:<span class='fl'>12</span>,], <span class='st'>"r00"</span>)
<span class='no'>sm2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span>(<span class='no'>nm2</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>10</span>)
<span class='fu'>smbind</span>(<span class='no'>sm1</span>, <span class='no'>sm2</span>, <span class='kw'>MARGIN</span><span class='kw'>=</span><span class='fl'>1</span>)</div><div class='output co'>#&gt; An object of class “simmat” 
#&gt; ‘r00’ method (binary, non-sequential)
#&gt; 12 x 10 matrix
#&gt; Number of permuted matrices = 10 
#&gt; </div><div class='input'>
<span class='co'>## binding subsequent samples from sequential algorithms</span>
<span class='co'>## start, end, thin retained</span>
<span class='no'>nm</span> <span class='kw'>&lt;-</span> <span class='fu'>nullmodel</span>(<span class='no'>x</span>, <span class='st'>"swap"</span>)
<span class='no'>nm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span>(<span class='no'>nm</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>10</span>)
<span class='no'>sm1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span>(<span class='no'>nm</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>thin</span><span class='kw'>=</span><span class='fl'>5</span>)
<span class='no'>sm2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span>(<span class='no'>nm</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>20</span>, <span class='kw'>thin</span><span class='kw'>=</span><span class='fl'>5</span>)
<span class='no'>sm3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span>(<span class='no'>nm</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>thin</span><span class='kw'>=</span><span class='fl'>5</span>)
<span class='fu'>smbind</span>(<span class='no'>sm3</span>, <span class='no'>sm2</span>, <span class='no'>sm1</span>, <span class='kw'>MARGIN</span><span class='kw'>=</span><span class='fl'>3</span>)</div><div class='output co'>#&gt; An object of class “simmat” 
#&gt; ‘swap’ method (binary, sequential)
#&gt; 12 x 10 matrix
#&gt; Number of permuted matrices = 40 
#&gt; Start = 15, End = 210, Thin = 5
#&gt; </div><div class='input'>
<span class='co'>## 'replicate' based usage which is similar to the output</span>
<span class='co'>## of 'parLapply' or 'mclapply' in the 'parallel' package</span>
<span class='co'>## start, end, thin are set, also noting number of chains</span>
<span class='no'>smfun</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>burnin</span>, <span class='no'>nsim</span>, <span class='no'>thin</span>) {
    <span class='no'>nm</span> <span class='kw'>&lt;-</span> <span class='fu'>nullmodel</span>(<span class='no'>x</span>, <span class='st'>"swap"</span>)
    <span class='no'>nm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span>(<span class='no'>nm</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='no'>burnin</span>)
    <span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span>(<span class='no'>nm</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='no'>nsim</span>, <span class='kw'>thin</span><span class='kw'>=</span><span class='no'>thin</span>)
}
<span class='no'>smlist</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span>(<span class='fl'>3</span>, <span class='fu'>smfun</span>(<span class='no'>x</span>, <span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>50</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>thin</span><span class='kw'>=</span><span class='fl'>5</span>), <span class='kw'>simplify</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='fu'>smbind</span>(<span class='no'>smlist</span>, <span class='kw'>MARGIN</span><span class='kw'>=</span><span class='fl'>3</span>) <span class='co'># Number of permuted matrices = 30</span></div><div class='output co'>#&gt; An object of class “simmat” 
#&gt; ‘swap’ method (binary, sequential)
#&gt; 12 x 10 matrix
#&gt; Number of permuted matrices = 30 
#&gt; Start = 55, End = 100, Thin = 5 (3 chains)
#&gt; </div><div class='input'>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>## parallel null model calculations</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>parallel</span>)

<span class='kw'>if</span> (<span class='no'>.Platform</span>$<span class='no'>OS.type</span> <span class='kw'>==</span> <span class='st'>"unix"</span>) {
<span class='co'>## forking on Unix systems</span>
<span class='no'>smlist</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/parallel/mclapply.html'>mclapply</a></span>(<span class='fl'>1</span>:<span class='fl'>3</span>, <span class='kw'>function</span>(<span class='no'>i</span>) <span class='fu'>smfun</span>(<span class='no'>x</span>, <span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>50</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>thin</span><span class='kw'>=</span><span class='fl'>5</span>))
<span class='fu'>smbind</span>(<span class='no'>smlist</span>, <span class='kw'>MARGIN</span><span class='kw'>=</span><span class='fl'>3</span>)
}

<span class='co'>## socket type cluster, works on all platforms</span>
<span class='no'>cl</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></span>(<span class='fl'>3</span>)
<span class='fu'><a href='https://rdrr.io/r/parallel/clusterApply.html'>clusterEvalQ</a></span>(<span class='no'>cl</span>, <span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>vegan</span>))
<span class='fu'><a href='https://rdrr.io/r/parallel/clusterApply.html'>clusterExport</a></span>(<span class='no'>cl</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"smfun"</span>, <span class='st'>"x"</span>))
<span class='no'>smlist</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/parallel/clusterApply.html'>parLapply</a></span>(<span class='no'>cl</span>, <span class='fl'>1</span>:<span class='fl'>3</span>, <span class='kw'>function</span>(<span class='no'>i</span>) <span class='fu'>smfun</span>(<span class='no'>x</span>, <span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>50</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>thin</span><span class='kw'>=</span><span class='fl'>5</span>))
<span class='fu'><a href='https://rdrr.io/r/parallel/makeCluster.html'>stopCluster</a></span>(<span class='no'>cl</span>)
<span class='fu'>smbind</span>(<span class='no'>smlist</span>, <span class='kw'>MARGIN</span><span class='kw'>=</span><span class='fl'>3</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Jari Oksanen and Peter Solymos</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


