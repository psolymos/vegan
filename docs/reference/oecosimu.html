<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Evaluate Statistics with Null Models of Biological Communities — oecosimu • vegan</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Evaluate Statistics with Null Models of Biological Communities — oecosimu" />
<meta property="og:description" content="
 
Function evaluates a statistic or a vector of statistics in
  community and evaluates its significance in a series of simulated
  random communities.  The approach has been used traditionally for
  the analysis of nestedness, but the function is more general and can
  be used with any statistics evaluated with simulated
  communities. Function oecosimu collects and evaluates the
  statistics. The Null model communities are described in
  make.commsim and permatfull/
  permatswap, the definition of Null models in
  nullmodel, and nestedness statistics in
  nestednodf (which describes several alternative
  statistics, including nestedness temperature, \(N0\), checker
  board units, nestedness discrepancy and NODF)." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vegandevs/vegan">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Evaluate Statistics with Null Models of Biological Communities</h1>
    
    <div class="hidden name"><code>oecosimu.Rd</code></div>
    </div>

    <div class="ref-description">
    
 
<p>Function evaluates a statistic or a vector of statistics in
  community and evaluates its significance in a series of simulated
  random communities.  The approach has been used traditionally for
  the analysis of nestedness, but the function is more general and can
  be used with any statistics evaluated with simulated
  communities. Function <code>oecosimu</code> collects and evaluates the
  statistics. The Null model communities are described in
  <code><a href='commsim.html'>make.commsim</a></code> and <code><a href='permatfull.html'>permatfull</a></code>/
  <code><a href='permatfull.html'>permatswap</a></code>, the definition of Null models in
  <code><a href='nullmodel.html'>nullmodel</a></code>, and nestedness statistics in
  <code><a href='nestedtemp.html'>nestednodf</a></code> (which describes several alternative
  statistics, including nestedness temperature, \(N0\), checker
  board units, nestedness discrepancy and NODF).</p>
    </div>

    <pre class="usage"><span class='fu'>oecosimu</span>(<span class='no'>comm</span>, <span class='no'>nestfun</span>, <span class='no'>method</span>, <span class='kw'>nsimul</span> <span class='kw'>=</span> <span class='fl'>99</span>, <span class='kw'>burnin</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>thin</span> <span class='kw'>=</span> <span class='fl'>1</span>,
   <span class='kw'>statistic</span> <span class='kw'>=</span> <span class='st'>"statistic"</span>, <span class='kw'>alternative</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"two.sided"</span>, <span class='st'>"less"</span>, <span class='st'>"greater"</span>),
   <span class='kw'>batchsize</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span>(<span class='st'>"mc.cores"</span>), <span class='no'>...</span>)
<span class='co'># S3 method for oecosimu</span>
<span class='fu'><a href='https://rdrr.io/r/stats/ts.html'>as.ts</a></span>(<span class='no'>x</span>, <span class='no'>...</span>)
<span class='co'># S3 method for oecosimu</span>
<span class='fu'>as.mcmc</span>(<span class='no'>x</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>comm</th>
      <td><p>Community data, or a Null model object generated by
    <code><a href='nullmodel.html'>nullmodel</a></code> or an object of class <code>simmat</code> (array
    of permuted matrices from <code><a href='nullmodel.html'>simulate.nullmodel</a></code>). If
    <code>comm</code> is a community data, null model simulation
    <code>method</code> must be specified.  If <code>comm</code> is a
    <code><a href='nullmodel.html'>nullmodel</a></code>, the simulation <code>method</code> is ignored,
    and if <code>comm</code> is a <code>simmat</code> object, all other arguments
    are ignored except <code>nestfun</code>, <code>statistic</code> and
    <code>alternative</code>.</p></td>
    </tr>
    <tr>
      <th>nestfun</th>
      <td><p>Function analysed. Some nestedness functions are
    provided in <span class="pkg">vegan</span> (see <code><a href='nestedtemp.html'>nestedtemp</a></code>), but any
    function can be used if it accepts the community as the first
    argument, and returns either a plain number or a vector or the
    result in list item with the name defined in argument
    <code>statistic</code>. See Examples for defining your own functions.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Null model method: either a name (character string) of
    a method defined in <code><a href='commsim.html'>make.commsim</a></code> or a
    <code><a href='commsim.html'>commsim</a></code> function. This argument is ignored if
    <code>comm</code> is a <code><a href='nullmodel.html'>nullmodel</a></code> or a <code>simmat</code>
    object. See Details and Examples.</p></td>
    </tr>
    <tr>
      <th>nsimul</th>
      <td><p>Number of simulated null communities (ignored if
    <code>comm</code> is a <code>simmat</code> object).</p></td>
    </tr>
    <tr>
      <th>burnin</th>
      <td><p>Number of null communities discarded before proper
    analysis in sequential methods (such as <code>"tswap"</code>)
    (ignored with non-sequential methods or when <code>comm</code> is a
    <code>simmat</code> object).</p></td>
    </tr>
    <tr>
      <th>thin</th>
      <td><p>Number of discarded null communities between two
    evaluations of nestedness statistic in sequential methods (ignored
    with non-sequential methods or when <code>comm</code> is a <code>simmat</code>
    object).</p></td>
    </tr>
    <tr>
      <th>statistic</th>
      <td><p>The name of the statistic returned by
    <code>nestfun</code>.</p></td>
    </tr>
    <tr>
      <th>alternative</th>
      <td><p>a character string specifying the alternative
    hypothesis, must be one of <code>"two.sided"</code> (default), <code>"greater"</code>
    or <code>"less"</code>. Please note that the \(p\)-value of two-sided
    test is approximately two times higher than in the corresponding
    one-sided test (<code>"greater"</code> or <code>"less"</code> depending on the
    sign of the difference).</p></td>
    </tr>
    <tr>
      <th>batchsize</th>
      <td><p>Size in Megabytes of largest simulation object. If
    a larger structure would be produced, the analysis is broken
    internally into batches. With default <code>NA</code> the analysis is
    not broken into batches.  See Details.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>Number of parallel processes or a predefined socket
    cluster.  With <code>parallel = 1</code> uses ordinary, non-parallel
    processing. The parallel processing is done with <span class="pkg">parallel</span>
    package.  If you define a <code>nestfun</code> in Windows that needs other
    <span style="R">R</span> packages than <span class="pkg">vegan</span> or <span class="pkg">permute</span>, you must set up a
    socket cluster before the call.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>An <code>oecosimu</code> result object.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments to functions.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
  
<p>Function <code>oecosimu</code> is a wrapper that evaluates a statistic
  using function given by <code>nestfun</code>, and then simulates a series
  of null models based on <code>nullmodel</code>, and evaluates the
  statistic on these null models. The <span class="pkg">vegan</span> packages contains
  some nestedness functions that are described separately
  (<code><a href='nestedtemp.html'>nestedchecker</a></code>, <code><a href='nestedtemp.html'>nesteddisc</a></code>,
  <code><a href='nestedtemp.html'>nestedn0</a></code>, <code><a href='nestedtemp.html'>nestedtemp</a></code>,
  <code><a href='nestedtemp.html'>nestednodf</a></code>), but many other functions can be used as
  long as they are meaningful with simulated communities.  An
  applicable function must return either the statistic as a plain
  number or a vector, or as a list element <code>"statistic"</code> (like
  <code><a href='https://rdrr.io/r/stats/chisq.test.html'>chisq.test</a></code>), or in an item whose name is given in the
  argument <code>statistic</code>.  The statistic can be a single number
  (like typical for a nestedness index), or it can be a vector. The
  vector indices can be used to analyse site (row) or species (column)
  properties, see <code><a href='treedive.html'>treedive</a></code> for an example. Raup-Crick
  index (<code><a href='raupcrick.html'>raupcrick</a></code>) gives an example of using a
  dissimilarities.</p>
<p>The Null model type can be given as a name (quoted character string)
  that is used to define a Null model in <code><a href='commsim.html'>make.commsim</a></code>.
  These include all binary models described by Wright et al. (1998),
  Jonsson (2001), Gotelli &amp; Entsminger (2003), Miklós &amp;
  Podani (2004), and some others. There are several quantitative Null
  models, such those discussed by Hardy (2008), and several that are
  unpublished (see <code><a href='commsim.html'>make.commsim</a></code>,
  <code><a href='permatfull.html'>permatfull</a></code>, <code><a href='permatfull.html'>permatswap</a></code> for
  discussion). The user can also define her own <code><a href='commsim.html'>commsim</a></code>
  function (see Examples).</p>
<p>Function works by first defining a <code><a href='nullmodel.html'>nullmodel</a></code> with
  given <code><a href='commsim.html'>commsim</a></code>, and then generating a series of
  simulated communities with <code><a href='nullmodel.html'>simulate.nullmodel</a></code>. A
  shortcut can be used for any of these stages and the input can be</p><ol>
<li><p>Community data (<code>comm</code>), Null model function
      (<code>nestfun</code>) and the number of simulations (<code>nsimul</code>).</p></li>
<li><p>A <code><a href='nullmodel.html'>nullmodel</a></code> object and the number of
      simulations, and argument <code>method</code> is ignored.</p></li>
<li><p>A three-dimensional array of simulated communities generated
      with <code><a href='nullmodel.html'>simulate.nullmodel</a></code>, and arguments
      <code>method</code> and <code>nsimul</code> are ignored.</p></li>
</ol><p>The last case allows analysing several statistics with the same
  simulations.</p>
<p>The function first generates simulations with given
  <code><a href='nullmodel.html'>nullmodel</a></code> and then analyses these using the
  <code>nestfun</code>.  With large data sets and/or large number of
  simulations, the generated objects can be very large, and if the
  memory is exhausted, the analysis can become very slow and the
  system can become unresponsive. The simulation will be broken into
  several smaller batches if the simulated <code><a href='nullmodel.html'>nullmodel</a></code>
  objective will be above the set <code>batchsize</code> to avoid memory
  problems (see <code><a href='https://rdrr.io/r/utils/object.size.html'>object.size</a></code> for estimating the size of
  the current data set). The parallel processing still increases the
  memory needs.  The parallel processing is only used for evaluating
  <code>nestfun</code>.  The main load may be in simulation of the
  <code><a href='nullmodel.html'>nullmodel</a></code>, and <code>parallel</code> argument does not help
  there.</p>
<p>Function <code>as.ts</code> transforms the simulated results of sequential
  methods into a time series or a <code><a href='https://rdrr.io/r/stats/ts.html'>ts</a></code> object. This allows
  using analytic tools for time series in studying the sequences (see
  examples). Function <code>as.mcmc</code> transforms the simulated results
  of sequential methods into an <code><a href='https://rdrr.io/pkg/coda/man/mcmc.html'>mcmc</a></code> object of the
  <span class="pkg">coda</span> package. The <span class="pkg">coda</span> package provides functions for
  the analysis of stationarity, adequacy of sample size,
  autocorrelation, need of burn-in and much more for sequential
  methods, and summary of the results. Please consult the
  documentation of the <span class="pkg">coda</span> package.</p>
<p>Function <code><a href='permustats.html'>permustats</a></code> provides support to the standard
  <code><a href='https://rdrr.io/r/stats/density.html'>density</a></code>, <code><a href='https://rdrr.io/pkg/lattice/man/histogram.html'>densityplot</a></code>,
  <code><a href='https://rdrr.io/r/stats/qqnorm.html'>qqnorm</a></code> and <code><a href='https://rdrr.io/pkg/lattice/man/qqmath.html'>qqmath</a></code> functions for
  the simulated values.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

     

<p>Function <code>oecosimu</code> returns an object of class
  <code>"oecosimu"</code>.  The result object has items <code>statistic</code> and
  <code>oecosimu</code>.  The <code>statistic</code> contains the complete object
  returned by <code>nestfun</code> for the original data.  The
  <code>oecosimu</code> component contains the following items:</p>
<dt>statistic</dt><dd><p>Observed values of the statistic.</p></dd>
  <dt>simulated</dt><dd><p>Simulated values of the statistic.</p></dd>
  <dt>means</dt><dd><p>Mean values of the statistic from simulations.</p></dd>
  <dt>z</dt><dd><p>Standardized effect sizes (SES, a.k.a. the \(z\)-values)
     of the observed statistic based on simulations.</p></dd>
  <dt>pval</dt><dd><p>The \(P\)-values of the statistic based on simulations.</p></dd>
  <dt>alternative</dt><dd><p>The type of testing as given in argument <code>alternative</code>.</p></dd>
  <dt>method</dt><dd><p>The <code>method</code> used in <code><a href='nullmodel.html'>nullmodel</a></code>.</p></dd>
  <dt>isSeq</dt><dd><p><code>TRUE</code> if <code>method</code> was sequential.</p></dd>


    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Hardy, O. J. (2008) 
  Testing the spatial phylogenetic structure of local communities: 
  statistical performances of different null models 
  and test statistics on a locally neutral community. 
  <em>Journal of Ecology</em> 96, 914--926.</p>
<p>Gotelli, N.J. &amp; Entsminger, N.J. (2003). Swap algorithms in null model
  analysis. <em>Ecology</em> 84, 532--535.</p>
<p>Jonsson, B.G. (2001) A null model for randomization tests of
  nestedness in species assemblages. <em>Oecologia</em> 127, 309--313.</p>
<p>Miklós, I. &amp; Podani, J. (2004). Randomization of presence-absence
  matrices: comments and new algorithms. <em>Ecology</em> 85, 86--92.</p>
<p>Wright, D.H., Patterson, B.D., Mikkelson, G.M., Cutler, A. &amp; Atmar,
  W. (1998). A comparative analysis of nested subset patterns of species
  composition. <em>Oecologia</em> 113, 1--20.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>If you wonder about the name of <code>oecosimu</code>, look at journal
  names in the References (and more in <code><a href='nestedtemp.html'>nestedtemp</a></code>).</p>
<p>The internal structure of the function was radically changed in
  <span class="pkg">vegan 2.2-0</span> with introduction of <code><a href='commsim.html'>commsim</a></code> and
  <code><a href='nullmodel.html'>nullmodel</a></code> and deprecation of
  <code><a href='vegan-defunct.html'>commsimulator</a></code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Function <code>oecosimu</code> currently defines null models with
  <code><a href='commsim.html'>commsim</a></code> and generates the simulated null model
  communities with <code><a href='nullmodel.html'>nullmodel</a></code> and
  <code><a href='nullmodel.html'>simulate.nullmodel</a></code>. For other applications of
  <code>oecosimu</code>, see <code><a href='treedive.html'>treedive</a></code> and
  <code><a href='raupcrick.html'>raupcrick</a></code>.</p>
<p>See also <code><a href='nestedtemp.html'>nestedtemp</a></code> (that also discusses other
  nestedness functions) and <code><a href='treedive.html'>treedive</a></code> for another
  application.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Use the first eigenvalue of correspondence analysis as an index</span>
<span class='co'>## of structure: a model for making your own functions.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>sipoo</span>)
<span class='co'>## Traditional nestedness statistics (number of checkerboard units)</span>
<span class='fu'>oecosimu</span>(<span class='no'>sipoo</span>, <span class='no'>nestedchecker</span>, <span class='st'>"r0"</span>)</div><div class='output co'>#&gt; oecosimu object
#&gt; 
#&gt; Call: oecosimu(comm = sipoo, nestfun = nestedchecker, method = "r0")
#&gt; 
#&gt; nullmodel method ‘r0’ with 99 simulations
#&gt; 
#&gt; alternative hypothesis: statistic is less or greater than simulated values
#&gt; 
#&gt; Checkerboard Units    : 2767 
#&gt; C-score (species mean): 2.258776 
#&gt; 
#&gt;               statistic    SES   mean   2.5%    50%  97.5% Pr(sim.)   
#&gt; checkerboards      2767 -18.92 8032.9 7544.1 8025.0 8516.7     0.01 **
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'><span class='co'>## sequential model, one-sided test, a vector statistic</span>
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'>oecosimu</span>(<span class='no'>sipoo</span>, <span class='no'>decorana</span>, <span class='st'>"swap"</span>, <span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>thin</span><span class='kw'>=</span><span class='fl'>10</span>,
   <span class='kw'>statistic</span><span class='kw'>=</span><span class='st'>"evals"</span>, <span class='kw'>alt</span> <span class='kw'>=</span> <span class='st'>"greater"</span>)
<span class='no'>out</span></div><div class='output co'>#&gt; oecosimu object
#&gt; 
#&gt; Call: oecosimu(comm = sipoo, nestfun = decorana, method = "swap",
#&gt; burnin = 100, thin = 10, statistic = "evals", alternative = "greater")
#&gt; 
#&gt; nullmodel method ‘swap’ with 99 simulations
#&gt; options:  thin 10, burnin 100
#&gt; alternative hypothesis: statistic is greater than simulated values
#&gt; 
#&gt; 
#&gt; Call:
#&gt; nestfun(veg = comm) 
#&gt; 
#&gt; Detrended correspondence analysis with 26 segments.
#&gt; Rescaling of axes with 4 iterations.
#&gt; 
#&gt;                   DCA1   DCA2   DCA3    DCA4
#&gt; Eigenvalues     0.3822 0.2612 0.1668 0.08723
#&gt; Decorana values 0.4154 0.2465 0.1391 0.04992
#&gt; Axis lengths    2.9197 2.5442 2.7546 1.78074
#&gt; 
#&gt; 
#&gt;      statistic      SES    mean     50%    95% Pr(sim.)  
#&gt; DCA1  0.382249  2.44131 0.32359 0.32475 0.3602     0.02 *
#&gt; DCA2  0.261208  1.67081 0.21776 0.21748 0.2539     0.03 *
#&gt; DCA3  0.166788  0.21371 0.16212 0.16156 0.2013     0.38  
#&gt; DCA4  0.087226 -1.88542 0.12788 0.12779 0.1641     0.97  
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'><span class='co'>## Inspect the swap sequence as a time series object</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/ts.html'>as.ts</a></span>(<span class='no'>out</span>))</div><div class='img'><img src='oecosimu-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/lag.plot.html'>lag.plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/ts.html'>as.ts</a></span>(<span class='no'>out</span>))</div><div class='img'><img src='oecosimu-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/acf.html'>acf</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/ts.html'>as.ts</a></span>(<span class='no'>out</span>))</div><div class='img'><img src='oecosimu-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## Density plot</span>
<span class='fu'>densityplot</span>(<span class='fu'><a href='permustats.html'>permustats</a></span>(<span class='no'>out</span>), <span class='kw'>as.table</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>layout</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>4</span>))</div><div class='img'><img src='oecosimu-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## Use quantitative null models to compare</span>
<span class='co'>## mean Bray-Curtis dissimilarities</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>dune</span>)
<span class='no'>meandist</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='fu'><a href='vegdist.html'>vegdist</a></span>(<span class='no'>x</span>, <span class='st'>"bray"</span>))
<span class='no'>mbc1</span> <span class='kw'>&lt;-</span> <span class='fu'>oecosimu</span>(<span class='no'>dune</span>, <span class='no'>meandist</span>, <span class='st'>"r2dtable"</span>)
<span class='no'>mbc1</span></div><div class='output co'>#&gt; oecosimu object
#&gt; 
#&gt; Call: oecosimu(comm = dune, nestfun = meandist, method = "r2dtable")
#&gt; 
#&gt; nullmodel method ‘r2dtable’ with 99 simulations
#&gt; 
#&gt; alternative hypothesis: statistic is less or greater than simulated values
#&gt; 
#&gt;           statistic    SES    mean    2.5%     50%  97.5% Pr(sim.)   
#&gt; statistic   0.64565 13.062 0.46756 0.44416 0.46744 0.4947     0.01 **
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
<span class='co'>## Define your own null model as a 'commsim' function: shuffle cells</span>
<span class='co'>## in each row</span>
<span class='no'>foo</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>n</span>, <span class='no'>nr</span>, <span class='no'>nc</span>, <span class='no'>...</span>) {
   <span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span>(<span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>nr</span>, <span class='no'>nc</span>, <span class='no'>n</span>))
   <span class='kw'>for</span> (<span class='no'>k</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span>(<span class='no'>n</span>))
      <span class='no'>out</span>[,,<span class='no'>k</span>] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span>(<span class='no'>x</span>, <span class='fl'>2</span>, <span class='kw'>function</span>(<span class='no'>z</span>) <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='no'>z</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>z</span>)))
   <span class='no'>out</span>
}
<span class='no'>cf</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='commsim.html'>commsim</a></span>(<span class='st'>"myshuffle"</span>, <span class='no'>foo</span>, <span class='kw'>isSeq</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>binary</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
   <span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"double"</span>)
<span class='fu'>oecosimu</span>(<span class='no'>dune</span>, <span class='no'>meandist</span>, <span class='no'>cf</span>)</div><div class='output co'>#&gt; oecosimu object
#&gt; 
#&gt; Call: oecosimu(comm = dune, nestfun = meandist, method = cf)
#&gt; 
#&gt; nullmodel method ‘myshuffle’ with 99 simulations
#&gt; 
#&gt; alternative hypothesis: statistic is less or greater than simulated values
#&gt; 
#&gt;           statistic    SES    mean    2.5%     50%  97.5% Pr(sim.)   
#&gt; statistic   0.64565 3.2635 0.63528 0.62861 0.63507 0.6421     0.01 **
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
<span class='co'>## Use pre-built null model</span>
<span class='no'>nm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span>(<span class='fu'><a href='nullmodel.html'>nullmodel</a></span>(<span class='no'>sipoo</span>, <span class='st'>"curveball"</span>), <span class='fl'>99</span>)
<span class='fu'>oecosimu</span>(<span class='no'>nm</span>, <span class='no'>nestedchecker</span>)</div><div class='output co'>#&gt; oecosimu object
#&gt; 
#&gt; Call: oecosimu(comm = nm, nestfun = nestedchecker)
#&gt; 
#&gt; nullmodel method ‘curveball’ with 99 simulations
#&gt; options:  thin 1, burnin 0
#&gt; alternative hypothesis: statistic is less or greater than simulated values
#&gt; 
#&gt; Checkerboard Units    : 2767 
#&gt; C-score (species mean): 2.258776 
#&gt; 
#&gt;               statistic    SES   mean   2.5%    50%  97.5% Pr(sim.)   
#&gt; checkerboards      2767 1.9659 2660.4 2560.0 2674.0 2760.3     0.01 **
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'><span class='co'>## Several chains of a sequential model -- this can be generalized</span>
<span class='co'>## for parallel processing (see ?smbind)</span>
<span class='no'>nm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span>(<span class='fl'>5</span>, <span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span>(<span class='fu'><a href='nullmodel.html'>nullmodel</a></span>(<span class='no'>sipoo</span>, <span class='st'>"swap"</span>), <span class='fl'>99</span>,
   <span class='kw'>thin</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>100</span>), <span class='kw'>simplify</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='co'>## nm is now a list of nullmodels: use smbind to combine these into one</span>
<span class='co'>## nullmodel with several chains</span>
<span class='no'>nm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='nullmodel.html'>smbind</a></span>(<span class='no'>nm</span>, <span class='kw'>MARGIN</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='no'>nm</span></div><div class='output co'>#&gt; An object of class “simmat” 
#&gt; ‘swap’ method (binary, sequential)
#&gt; 18 x 50 matrix
#&gt; Number of permuted matrices = 495 
#&gt; Start = 110, End = 1090, Thin = 10 (5 chains)
#&gt; </div><div class='input'><span class='fu'>oecosimu</span>(<span class='no'>nm</span>, <span class='no'>nestedchecker</span>)</div><div class='output co'>#&gt; oecosimu object
#&gt; 
#&gt; Call: oecosimu(comm = nm, nestfun = nestedchecker)
#&gt; 
#&gt; nullmodel method ‘swap’ with 495 simulations
#&gt; options:  thin 10, burnin 100, chains 5
#&gt; alternative hypothesis: statistic is less or greater than simulated values
#&gt; 
#&gt; Checkerboard Units    : 2767 
#&gt; C-score (species mean): 2.258776 
#&gt; 
#&gt;               statistic    SES   mean   2.5%    50%  97.5% Pr(sim.)
#&gt; checkerboards      2767 0.5518 2715.5 2575.7 2700.0 2937.9   0.5625</div><div class='input'>## After this you can use as.mcmc() and tools in the coda package to
## analyse the chains (these will show that thin, burnin and nsimul are
## all too low for real analysis).
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Jari Oksanen and Peter Solymos</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


