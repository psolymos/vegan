<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit Fisher's Logseries and Preston's Lognormal Model to Abundance Data — fisherfit • vegan</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fit Fisher's Logseries and Preston's Lognormal Model to Abundance Data — fisherfit" />
<meta property="og:description" content="Function fisherfit fits Fisher's logseries to abundance
  data. Function prestonfit groups species frequencies into
  doubling octave classes and fits Preston's lognormal model, and
  function prestondistr fits the truncated lognormal model
  without pooling the data into octaves." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vegandevs/vegan">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit Fisher's Logseries and Preston's Lognormal Model to Abundance Data</h1>
    
    <div class="hidden name"><code>fisherfit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function <code>fisherfit</code> fits Fisher's logseries to abundance
  data. Function <code>prestonfit</code> groups species frequencies into
  doubling octave classes and fits Preston's lognormal model, and
  function <code>prestondistr</code> fits the truncated lognormal model
  without pooling the data into octaves.</p>
    </div>

    <pre class="usage"><span class='fu'>fisherfit</span>(<span class='no'>x</span>, <span class='no'>...</span>)
<span class='fu'>prestonfit</span>(<span class='no'>x</span>, <span class='kw'>tiesplit</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)
<span class='fu'>prestondistr</span>(<span class='no'>x</span>, <span class='kw'>truncate</span> <span class='kw'>=</span> -<span class='fl'>1</span>, <span class='no'>...</span>)
<span class='co'># S3 method for prestonfit</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>x</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Frequency"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Species"</span>, <span class='kw'>bar.col</span> <span class='kw'>=</span> <span class='st'>"skyblue"</span>,
    <span class='kw'>line.col</span> <span class='kw'>=</span> <span class='st'>"red"</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='no'>...</span>)
<span class='co'># S3 method for prestonfit</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='no'>x</span>, <span class='kw'>line.col</span> <span class='kw'>=</span> <span class='st'>"red"</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='no'>...</span>)
<span class='fu'>veiledspec</span>(<span class='no'>x</span>, <span class='no'>...</span>)
<span class='fu'>as.fisher</span>(<span class='no'>x</span>, <span class='no'>...</span>)
<span class='co'># S3 method for fisher</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>x</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Frequency"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Species"</span>, <span class='kw'>bar.col</span> <span class='kw'>=</span> <span class='st'>"skyblue"</span>,
             <span class='kw'>kind</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"bar"</span>, <span class='st'>"hiplot"</span>, <span class='st'>"points"</span>, <span class='st'>"lines"</span>), <span class='kw'>add</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)
<span class='fu'>as.preston</span>(<span class='no'>x</span>, <span class='kw'>tiesplit</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)
<span class='co'># S3 method for preston</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>x</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Frequency"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Species"</span>, <span class='kw'>bar.col</span> <span class='kw'>=</span> <span class='st'>"skyblue"</span>, <span class='no'>...</span>)
<span class='co'># S3 method for preston</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='no'>x</span>, <span class='kw'>xadjust</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>Community data vector for fitting functions or their result
    object for <code>plot</code> functions.</p></td>
    </tr>
    <tr>
      <th>tiesplit</th>
      <td><p>Split frequencies \(1, 2, 4, 8\) etc between adjacent 
    octaves.</p></td>
    </tr>
    <tr>
      <th>truncate</th>
      <td><p>Truncation point for log-Normal model, in log2
    units. Default value \(-1\) corresponds to the left border of zero
    Octave. The choice strongly influences the fitting results.</p></td>
    </tr>
    <tr>
      <th>xlab, ylab</th>
      <td><p>Labels for <code>x</code> and <code>y</code> axes.</p></td>
    </tr>
    <tr>
      <th>bar.col</th>
      <td><p>Colour of data bars.</p></td>
    </tr>
    <tr>
      <th>line.col</th>
      <td><p>Colour of fitted line.</p></td>
    </tr>
    <tr>
      <th>lwd</th>
      <td><p>Width of fitted line.</p></td>
    </tr>
    <tr>
      <th>kind</th>
      <td><p>Kind of plot to drawn: <code>"bar"</code> is similar bar plot
    as in <code>plot.fisherfit</code>, <code>"hiplot"</code> draws vertical lines
    as with <code class='command'>plot(..., type="h")</code>, and <code>"points"</code> and
    <code>"lines"</code> are obvious.</p></td>
    </tr>
    <tr>
      <th>add</th>
      <td><p>Add to an existing plot.</p></td>
    </tr>
    <tr>
      <th>xadjust</th>
      <td><p>Adjustment of horizontal positions in octaves.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other parameters passed to functions. Ignored in 
    <code>prestonfit</code> and <code>tiesplit</code> passed to <code>as.preston</code> in
    <code>prestondistr</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In Fisher's logarithmic series the expected
  number of species \(f\) with \(n\) observed individuals is
  \(f_n = \alpha x^n / n\) (Fisher et al. 1943).
  The estimation is possible only for genuine
  counts of individuals. The parameter \(\alpha\) is used as a
  diversity index, and \(\alpha\) and its standard error can be
  estimated with a separate function <code><a href='diversity.html'>fisher.alpha</a></code>. The
  parameter \(x\) is taken as a nuisance parameter which is not
  estimated separately but taken to be \(n/(n+\alpha)\). Helper
  function <code>as.fisher</code> transforms abundance data into Fisher
  frequency table.</p>
<p>Preston (1948) was not satisfied with Fisher's model which seemed to
  imply infinite species richness, and postulated that rare species is
  a diminishing class and most species are in the middle of frequency
  scale. This was achieved by collapsing higher frequency classes into
  wider and wider &#8220;octaves&#8221; of doubling class limits: 1, 2, 3--4,
  5--8, 9--16 etc. occurrences. It seems that Preston regarded
  frequencies 1, 2, 4, <em>etc.</em>. as &#8220;tied&#8221; between octaves
  (Williamson &amp; Gaston 2005). This means that only half of the species
  with frequency 1 are shown in the lowest octave, and the rest are
  transferred to the second octave. Half of the species from the
  second octave are transferred to the higher one as well, but this is
  usually not as large a number of species. This practise makes data
  look more lognormal by reducing the usually high lowest
  octaves. This can be achieved by setting argument <code>tiesplit = TRUE</code>. 
  With <code>tiesplit = FALSE</code> the frequencies are not split,
  but all ones are in the lowest octave, all twos in the second, etc.
  Williamson &amp; Gaston (2005) discuss alternative definitions in
  detail, and they should be consulted for a critical review of
  log-Normal model.</p>
<p>Any logseries data will look like lognormal when plotted in
  Preston's way. The expected frequency \(f\) at abundance octave
  \(o\) is defined by \(f_o = S_0 \exp(-(\log_2(o) -
  \mu)^2/2/\sigma^2)\), where
  \(\mu\) is the location of the mode and \(\sigma\) the width,
  both in \(\log_2\) scale, and \(S_0\) is the expected
  number of species at mode. The lognormal model is usually truncated
  on the left so that some rare species are not observed. Function
  <code>prestonfit</code> fits the truncated lognormal model as a second
  degree log-polynomial to the octave pooled data using Poisson (when
  <code>tiesplit = FALSE</code>) or quasi-Poisson (when <code>tiesplit = TRUE</code>)
  error.  Function <code>prestondistr</code> fits left-truncated
  Normal distribution to \(\log_2\) transformed non-pooled
  observations with direct maximization of log-likelihood. Function
  <code>prestondistr</code> is modelled after function
  <code><a href='https://rdrr.io/pkg/MASS/man/fitdistr.html'>fitdistr</a></code> which can be used for alternative
  distribution models.</p>
<p>The functions have common <code>print</code>, <code>plot</code> and <code>lines</code>
  methods. The <code>lines</code> function adds the fitted curve to the
  octave range with line segments showing the location of the mode and
  the width (sd) of the response. Function <code>as.preston</code>
  transforms abundance data to octaves.  Argument <code>tiesplit</code> will
  not influence the fit in <code>prestondistr</code>, but it will influence
  the barplot of the octaves.</p>
<p>The total extrapolated richness from a fitted Preston model can be
  found with function <code>veiledspec</code>. The function accepts results
  both from <code>prestonfit</code> and from <code>prestondistr</code>. If
  <code>veiledspec</code> is called with a species count vector, it will
  internally use <code>prestonfit</code>. Function <code><a href='specpool.html'>specpool</a></code>
  provides alternative ways of estimating the number of unseen
  species. In fact, Preston's lognormal model seems to be truncated at
  both ends, and this may be the main reason why its result differ
  from lognormal models fitted in Rank--Abundance diagrams with
  functions <code><a href='radfit.html'>rad.lognormal</a></code>.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function <code>prestonfit</code> returns an object with fitted
  <code>coefficients</code>, and with observed (<code>freq</code>) and fitted
  (<code>fitted</code>) frequencies, and a string describing the fitting
  <code>method</code>. Function <code>prestondistr</code> omits the entry
  <code>fitted</code>.  The function <code>fisherfit</code> returns the result of
  <code><a href='https://rdrr.io/r/stats/nlm.html'>nlm</a></code>, where item <code>estimate</code> is \(\alpha\). The
  result object is amended with the <code>nuisance</code> parameter and item
  <code>fisher</code> for the observed data from <code>as.fisher</code></p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Fisher, R.A., Corbet, A.S. &amp; Williams, C.B. (1943). The relation
  between the number of species and the number of individuals in a
  random sample of animal population. <em>Journal of Animal Ecology</em>
  12: 42--58.</p>
<p>Preston, F.W. (1948) The commonness and rarity of
  species. <em>Ecology</em> 29, 254--283.</p>
<p>Williamson, M. &amp; Gaston, K.J. (2005). The lognormal distribution is
  not an appropriate null hypothesis for the species--abundance
  distribution. <em>Journal of Animal Ecology</em> 74, 409--422.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='diversity.html'>diversity</a></code>, <code><a href='diversity.html'>fisher.alpha</a></code>,
  <code><a href='radfit.html'>radfit</a></code>, <code><a href='specpool.html'>specpool</a></code>. Function
  <code><a href='https://rdrr.io/pkg/MASS/man/fitdistr.html'>fitdistr</a></code> of <span class="pkg">MASS</span> package was used as the
  model for <code>prestondistr</code>. Function <code><a href='https://rdrr.io/r/stats/density.html'>density</a></code> can be used for
  smoothed non-parametric estimation of responses, and
  <code><a href='https://rdrr.io/r/stats/qqnorm.html'>qqplot</a></code> is an alternative, traditional and more effective
  way of studying concordance of observed abundances to any distribution model.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>BCI</span>)
<span class='no'>mod</span> <span class='kw'>&lt;-</span> <span class='fu'>fisherfit</span>(<span class='no'>BCI</span>[<span class='fl'>5</span>,])
<span class='no'>mod</span></div><div class='output co'>#&gt; 
#&gt; Fisher log series model
#&gt; No. of species: 101 
#&gt; Fisher alpha:   37.96423 
#&gt; </div><div class='input'><span class='co'># prestonfit seems to need large samples</span>
<span class='no'>mod.oct</span> <span class='kw'>&lt;-</span> <span class='fu'>prestonfit</span>(<span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colSums</a></span>(<span class='no'>BCI</span>))
<span class='no'>mod.ll</span> <span class='kw'>&lt;-</span> <span class='fu'>prestondistr</span>(<span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colSums</a></span>(<span class='no'>BCI</span>))
<span class='no'>mod.oct</span></div><div class='output co'>#&gt; 
#&gt; Preston lognormal model
#&gt; Method: Quasi-Poisson fit to octaves 
#&gt; No. of species: 225 
#&gt; 
#&gt;      mode     width        S0 
#&gt;  4.885798  2.932690 32.022923 
#&gt; 
#&gt; Frequencies by Octave
#&gt;                 0        1        2      3        4        5        6        7
#&gt; Observed 9.500000 16.00000 18.00000 19.000 30.00000 35.00000 31.00000 26.50000
#&gt; Fitted   7.994154 13.31175 19.73342 26.042 30.59502 31.99865 29.79321 24.69491
#&gt;                 8        9       10     11
#&gt; Observed 18.00000 13.00000 7.000000 2.0000
#&gt; Fitted   18.22226 11.97021 7.000122 3.6443
#&gt; </div><div class='input'><span class='no'>mod.ll</span></div><div class='output co'>#&gt; 
#&gt; Preston lognormal model
#&gt; Method: maximized likelihood to log2 abundances 
#&gt; No. of species: 225 
#&gt; 
#&gt;      mode     width        S0 
#&gt;  4.365002  2.753531 33.458185 
#&gt; 
#&gt; Frequencies by Octave
#&gt;                0        1        2        3        4        5        6        7
#&gt; Observed 9.50000 16.00000 18.00000 19.00000 30.00000 35.00000 31.00000 26.50000
#&gt; Fitted   9.52392 15.85637 23.13724 29.58961 33.16552 32.58022 28.05054 21.16645
#&gt;                 8         9       10      11
#&gt; Observed 18.00000 13.000000 7.000000 2.00000
#&gt; Fitted   13.99829  8.113746 4.121808 1.83516
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>mod.oct</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='no'>mod.ll</span>, <span class='kw'>line.col</span><span class='kw'>=</span><span class='st'>"blue3"</span>) <span class='co'># Different</span></div><div class='input'><span class='co'>## Smoothed density</span>
<span class='no'>den</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log2</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colSums</a></span>(<span class='no'>BCI</span>)))
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='no'>den</span>$<span class='no'>x</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>BCI</span>)*<span class='no'>den</span>$<span class='no'>y</span>, <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>2</span>) <span class='co'># Fairly similar to mod.oct</span></div><div class='img'><img src='fisherfit-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## Extrapolated richness</span>
<span class='fu'>veiledspec</span>(<span class='no'>mod.oct</span>)</div><div class='output co'>#&gt; Extrapolated     Observed       Veiled 
#&gt;    235.40577    225.00000     10.40577 </div><div class='input'><span class='fu'>veiledspec</span>(<span class='no'>mod.ll</span>)</div><div class='output co'>#&gt; Extrapolated     Observed       Veiled 
#&gt;   230.931018   225.000000     5.931018 </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Bob O'Hara and Jari Oksanen.</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


