<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Reorder a Hierarchical Clustering Tree — reorder.hclust • vegan</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Reorder a Hierarchical Clustering Tree — reorder.hclust" />
<meta property="og:description" content="

Function takes a hierarchical clustering tree from
  hclust and a vector of values and reorders the
  clustering tree in the order of the supplied vector, maintaining the
  constraints on the tree. This is a method of generic function
  reorder and an alternative to reordering a
  &quot;dendrogram&quot; object with reorder.dendrogram" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vegandevs/vegan">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Reorder a Hierarchical Clustering Tree</h1>
    
    <div class="hidden name"><code>reorder.hclust.Rd</code></div>
    </div>

    <div class="ref-description">
    

<p>Function takes a hierarchical clustering tree from
  <code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code> and a vector of values and reorders the
  clustering tree in the order of the supplied vector, maintaining the
  constraints on the tree. This is a method of generic function
  <code><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></code> and an alternative to reordering a
  <code>"dendrogram"</code> object with <code><a href='https://rdrr.io/r/stats/reorder.dendrogram.html'>reorder.dendrogram</a></code></p>
    </div>

    <pre class="usage"><span class='co'># S3 method for hclust</span>
<span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span>(<span class='no'>x</span>, <span class='no'>wts</span>,
   <span class='kw'>agglo.FUN</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"mean"</span>, <span class='st'>"min"</span>, <span class='st'>"max"</span>, <span class='st'>"sum"</span>, <span class='st'>"uwmean"</span>), <span class='no'>...</span>)
<span class='co'># S3 method for hclust</span>
<span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span>(<span class='no'>x</span>)
<span class='co'># S3 method for hclust</span>
<span class='fu'><a href='scores.html'>scores</a></span>(<span class='no'>x</span>, <span class='kw'>display</span> <span class='kw'>=</span> <span class='st'>"internal"</span>, <span class='no'>...</span>)
<span class='fu'>cutreeord</span>(<span class='no'>tree</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>h</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x, tree</th>
      <td><p>hierarchical clustering from <code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code>.</p></td>
    </tr>
    <tr>
      <th>wts</th>
      <td><p>numeric vector for reordering.</p></td>
    </tr>
    <tr>
      <th>agglo.FUN</th>
      <td><p>a function for weights agglomeration, see below.</p></td>
    </tr>
    <tr>
      <th>display</th>
      <td><p>return <code>"internal"</code> nodes or <code>"terminal"</code> nodes (also
  called <code>"leaves"</code>).</p></td>
    </tr>
    <tr>
      <th>k, h</th>
      <td><p>scalars or vectors giving the numbers of desired groups or the heights
  where the tree should be cut (passed to function
  <code><a href='https://rdrr.io/r/stats/cutree.html'>cutree</a></code>).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments (ignored).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
  
<p>Dendrograms can be ordered in many ways. The <code>reorder</code> function
  reorders an <code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code> tree and provides an alternative to
  <code><a href='https://rdrr.io/r/stats/reorder.dendrogram.html'>reorder.dendrogram</a></code> which can reorder a
  <code><a href='https://rdrr.io/r/stats/dendrogram.html'>dendrogram</a></code>. The current function will also work
  differently when the <code>agglo.FUN</code> is <code>"mean"</code>: the
  <code><a href='https://rdrr.io/r/stats/reorder.dendrogram.html'>reorder.dendrogram</a></code> will always take the direct mean of
  member groups ignoring their sizes, but this function will used
  <code><a href='https://rdrr.io/r/stats/weighted.mean.html'>weighted.mean</a></code> weighted by group sizes, so that the
  group mean is always the mean of member leaves (terminal nodes). If
  you want to ignore group sizes, you can use unweighted mean with
  <code>"uwmean"</code>.</p>
<p>The function accepts only a limited list of <code>agglo.FUN</code>
  functions for assessing the value of <code>wts</code> for groups. The
  ordering is always ascending, but the order of leaves can be
  reversed with <code>rev</code>.</p>
<p>Function <code>scores</code> finds the coordinates of nodes as a two-column
  matrix. For terminal nodes (leaves) this the value at which the item
  is merged to the tree, and the labels can still <code>hang</code> below this
  level (see <code><a href='https://rdrr.io/r/stats/hclust.html'>plot.hclust</a></code>).</p>
<p>Function <code>cutreeord</code> cuts a tree to groups numbered from left to
  right in the tree. It is based on the standard function
  <code><a href='https://rdrr.io/r/stats/cutree.html'>cutree</a></code> which numbers the groups in the order they appear
  in the input data instead of the order in the tree.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Reordered <code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code> result object with added item
  <code>value</code> that gives the value of the statistic at each merge
  level.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>These functions should really be in base <span style="R">R</span>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code> for getting clustering trees,
  <code><a href='spantree.html'>as.hclust.spantree</a></code> to change a <span class="pkg">vegan</span> minimum
  spanning tree to an <code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code> object, and
  <code><a href='https://rdrr.io/r/stats/dendrogram.html'>dendrogram</a></code> and <code><a href='https://rdrr.io/r/stats/reorder.dendrogram.html'>reorder.dendrogram</a></code> for an
  alternative implementation.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## reorder by water content of soil</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>mite</span>, <span class='no'>mite.env</span>)
<span class='no'>hc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span>(<span class='fu'><a href='vegdist.html'>vegdist</a></span>(<span class='fu'><a href='decostand.html'>wisconsin</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='no'>mite</span>))))
<span class='no'>ohc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>mite.env</span>, <span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span>(<span class='no'>hc</span>, <span class='no'>WatrCont</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>hc</span>)</div><div class='img'><img src='reorder.hclust-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>ohc</span>)</div><div class='img'><img src='reorder.hclust-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## label leaves by the observed value, and each branching point</span>
<span class='co'>## (internal node) by the cluster mean</span>
<span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>mite.env</span>, <span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>ohc</span>, <span class='kw'>labels</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='no'>WatrCont</span>), <span class='kw'>cex</span><span class='kw'>=</span><span class='fl'>0.7</span>))</div><div class='input'><span class='fu'><a href='ordilabel.html'>ordilabel</a></span>(<span class='fu'><a href='scores.html'>scores</a></span>(<span class='no'>ohc</span>), <span class='kw'>label</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='no'>ohc</span>$<span class='no'>value</span>), <span class='kw'>cex</span><span class='kw'>=</span><span class='fl'>0.7</span>)</div><div class='img'><img src='reorder.hclust-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Slightly different from reordered 'dendrogram' which ignores group</span>
<span class='co'>## sizes in assessing means.</span>
<span class='no'>den</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dendrogram.html'>as.dendrogram</a></span>(<span class='no'>hc</span>)
<span class='no'>den</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>mite.env</span>, <span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span>(<span class='no'>den</span>, <span class='no'>WatrCont</span>, <span class='kw'>agglo.FUN</span> <span class='kw'>=</span> <span class='no'>mean</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>den</span>)</div><div class='img'><img src='reorder.hclust-4.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Jari Oksanen</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


