<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Mitchell-Olds \&amp; Shaw Test for the Location of Quadratic Extreme — MOStest • vegan</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Mitchell-Olds \&amp; Shaw Test for the Location of Quadratic Extreme — MOStest" />
<meta property="og:description" content="Mitchell-Olds &amp;amp; Shaw test concerns the location of the highest (hump)
  or lowest (pit) value of a quadratic curve at given points. Typically,
  it is used to study whether the quadratic hump or pit is located
  within a studied interval. The current test is generalized so that it
  applies generalized linear models (glm) with link
  function instead of simple quadratic curve.  The test was popularized
  in ecology for the analysis of humped species richness patterns
  (Mittelbach et al. 2001), but it is more general. With logarithmic
  link function, the quadratic response defines the Gaussian response
  model of ecological gradients (ter Braak &amp;amp; Looman 1986), and the test
  can be used for inspecting the location of Gaussian optimum within a
  given range of the gradient. It can also be used to replace Tokeshi's
  test of &amp;#8220;bimodal&amp;#8221; species frequency distribution." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vegandevs/vegan">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Mitchell-Olds \&amp; Shaw Test for the Location of Quadratic Extreme</h1>
    
    <div class="hidden name"><code>MOStest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Mitchell-Olds &amp; Shaw test concerns the location of the highest (hump)
  or lowest (pit) value of a quadratic curve at given points. Typically,
  it is used to study whether the quadratic hump or pit is located
  within a studied interval. The current test is generalized so that it
  applies generalized linear models (<code><a href='https://rdrr.io/r/stats/glm.html'>glm</a></code>) with link
  function instead of simple quadratic curve.  The test was popularized
  in ecology for the analysis of humped species richness patterns
  (Mittelbach et al. 2001), but it is more general. With logarithmic
  link function, the quadratic response defines the Gaussian response
  model of ecological gradients (ter Braak &amp; Looman 1986), and the test
  can be used for inspecting the location of Gaussian optimum within a
  given range of the gradient. It can also be used to replace Tokeshi's
  test of &#8220;bimodal&#8221; species frequency distribution.</p>
    </div>

    <pre class="usage"><span class='fu'>MOStest</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='no'>interval</span>, <span class='no'>...</span>)
<span class='co'># S3 method for MOStest</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>x</span>, <span class='kw'>which</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>6</span>), <span class='no'>...</span>)
<span class='fu'>fieller.MOStest</span>(<span class='no'>object</span>, <span class='kw'>level</span> <span class='kw'>=</span> <span class='fl'>0.95</span>)
<span class='co'># S3 method for MOStest</span>
<span class='fu'><a href='https://rdrr.io/r/stats/profile.html'>profile</a></span>(<span class='no'>fitted</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.01</span>, <span class='kw'>maxsteps</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>del</span> <span class='kw'>=</span> <span class='no'>zmax</span>/<span class='fl'>5</span>, <span class='no'>...</span>)
<span class='co'># S3 method for MOStest</span>
<span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span>(<span class='no'>object</span>, <span class='kw'>parm</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>level</span> <span class='kw'>=</span> <span class='fl'>0.95</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>The independent variable or plotting object in <code>plot</code>.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>The dependent variable.</p></td>
    </tr>
    <tr>
      <th>interval</th>
      <td><p>The two points at which the test statistic is
    evaluated. If missing, the extremes of <code>x</code> are used.</p></td>
    </tr>
    <tr>
      <th>which</th>
      <td><p>Subset of plots produced. Values <code>which=1</code> and
    <code>2</code> define plots specific to <code>MOStest</code> (see Details), and
    larger values select graphs of <code><a href='https://rdrr.io/r/stats/plot.lm.html'>plot.lm</a></code> (minus 2).</p></td>
    </tr>
    <tr>
      <th>object, fitted</th>
      <td><p>A result object from <code>MOStest</code>.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>The confidence level required.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Maximum significance level allowed.</p></td>
    </tr>
    <tr>
      <th>maxsteps</th>
      <td><p>Maximum number of steps in the profile.</p></td>
    </tr>
    <tr>
      <th>del</th>
      <td><p>A step length parameter for the profile (see code).</p></td>
    </tr>
    <tr>
      <th>parm</th>
      <td><p>Ignored.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other variables passed to functions. Function
    <code>MOStest</code> passes these to <code><a href='https://rdrr.io/r/stats/glm.html'>glm</a></code> so that
    these can include <code><a href='https://rdrr.io/r/stats/family.html'>family</a></code>. The other functions pass
    these to underlying graphical functions.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    

<p>The function fits a quadratic curve \(\mu = b_0 + b_1 x + b_2
  x^2\) with given <code><a href='https://rdrr.io/r/stats/family.html'>family</a></code> and link function.  If \(b_2
  &lt; 0\), this defines a unimodal curve with highest point at \(u =
  -b_1/(2 b_2)\) (ter Braak &amp; Looman 1986). If \(b_2 &gt; 0\), the
  parabola has a minimum at \(u\) and the response is sometimes
  called &#8220;bimodal&#8221;.  The null hypothesis is that the extreme
  point \(u\) is located within the interval given by points
  \(p_1\) and \(p_2\). If the extreme point \(u\) is exactly at
  \(p_1\), then \(b_1 = 0\) on shifted axis \(x - p_1\).  In the
  test, origin of <code>x</code> is shifted to the values \(p_1\) and
  \(p_2\), and the test statistic is based on the differences of
  deviances between the original model and model where the origin is
  forced to the given location using the standard
  <code><a href='https://rdrr.io/r/stats/anova.glm.html'>anova.glm</a></code> function (Oksanen et al. 2001).
  Mitchell-Olds &amp; Shaw (1987) used the first degree coefficient with
  its significance as estimated by the <code><a href='https://rdrr.io/r/stats/summary.glm.html'>summary.glm</a></code>
  function.  This give identical results with Normal error, but for
  other error distributions it is preferable to use the test based on
  differences in deviances in fitted models.</p>
<p>The test is often presented as a general test for the location of the
  hump, but it really is dependent on the quadratic fitted curve. If the
  hump is of different form than quadratic, the test may be
  insignificant.</p>
<p>Because of strong assumptions in the test, you should use the support
  functions to inspect the fit. Function <code><a href='https://rdrr.io/r/graphics/plot.html'>plot(..., which=1)</a></code>
  displays the data points, fitted quadratic model, and its approximate
  95% confidence intervals (2 times SE). Function <code>plot</code> with
  <code>which = 2</code> displays the approximate confidence interval of
  the polynomial coefficients, together with two lines indicating the
  combinations of the coefficients that produce the evaluated points of
  <code>x</code>. Moreover, the cross-hair shows the approximate confidence
  intervals for the polynomial coefficients ignoring their
  correlations. Higher values of <code>which</code> produce corresponding
  graphs from <code><a href='https://rdrr.io/r/stats/plot.lm.html'>plot.lm</a></code>. That is, you must add 2 to the
  value of <code>which</code> in <code><a href='https://rdrr.io/r/stats/plot.lm.html'>plot.lm</a></code>.</p>
<p>Function <code>fieller.MOStest</code> approximates the confidence limits
  of the location of the extreme point (hump or pit) using Fieller's
  theorem following ter Braak &amp; Looman (1986). The test is based on
  quasideviance except if the <code><a href='https://rdrr.io/r/stats/family.html'>family</a></code> is <code>poisson</code>
  or <code>binomial</code>. Function <code>profile</code> evaluates the profile
  deviance of the fitted model, and <code>confint</code> finds the profile
  based confidence limits following Oksanen et al. (2001).</p>
<p>The test is typically used in assessing the significance of diversity
  hump against productivity gradient (Mittelbach et al. 2001). It also
  can be used for the location of the pit (deepest points) instead of
  the Tokeshi test. Further, it can be used to test the location of the
  the Gaussian optimum in ecological gradient analysis (ter Braak &amp;
  Looman 1986, Oksanen et al. 2001).</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function is based on <code><a href='https://rdrr.io/r/stats/glm.html'>glm</a></code>, and it returns the result
  of object of <code>glm</code> amended with the result of the test. The new
  items in the <code>MOStest</code> are:</p>
<dt>isHump </dt><dd><p><code>TRUE</code> if the response is a
    hump.</p></dd>
  <dt>isBracketed</dt><dd><p><code>TRUE</code> if the hump or the pit is bracketed by
    the evaluated points.</p></dd> 
  <dt>hump</dt><dd><p>Sorted vector of location of the hump or the pit and the
    points where the test was evaluated.</p></dd>
  <dt>coefficients</dt><dd><p>Table of test statistics and their significances.</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Mitchell-Olds, T. &amp; Shaw, R.G. 1987. Regression analysis of natural
selection: statistical inference and biological
interpretation. <em>Evolution</em> 41, 1149--1161.</p>
<p>Mittelbach, G.C. Steiner, C.F., Scheiner, S.M., Gross, K.L., Reynolds,
H.L., Waide, R.B., Willig, R.M., Dodson, S.I. &amp; Gough, L. 2001. What is
the observed relationship between species richness and productivity?
<em>Ecology</em> 82, 2381--2396.</p>
<p>Oksanen, J., Läärä, E., Tolonen, K. &amp; Warner, B.G. 2001. Confidence
intervals for the optimum in the Gaussian response
function. <em>Ecology</em> 82, 1191--1197.</p>
<p>ter Braak, C.J.F &amp; Looman, C.W.N 1986. Weighted averaging, logistic
regression and the Gaussian response model. <em>Vegetatio</em> 65,
3--11.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Function <code>fieller.MOStest</code> is based on package <span class="pkg">optgrad</span> in
the Ecological Archives
(<a href='https://figshare.com/articles/Full_Archive/3521975'>https://figshare.com/articles/Full_Archive/3521975</a>)
accompanying Oksanen et al. (2001). The Ecological Archive package
<span class="pkg">optgrad</span> also contains profile deviance method for the location
of the hump or pit, but the current implementation of <code>profile</code>
and <code>confint</code> rather follow the example of
<code><a href='https://rdrr.io/pkg/MASS/man/profile.glm.html'>profile.glm</a></code> and <code><a href='https://rdrr.io/pkg/MASS/man/confint.html'>confint.glm</a></code> in
the <span class="pkg">MASS</span> package.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>The no-interaction model can be fitted with <code><a href='vegan-defunct.html'>humpfit</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## The Al-Mufti data analysed in humpfit():</span>
<span class='no'>mass</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>140</span>,<span class='fl'>230</span>,<span class='fl'>310</span>,<span class='fl'>310</span>,<span class='fl'>400</span>,<span class='fl'>510</span>,<span class='fl'>610</span>,<span class='fl'>670</span>,<span class='fl'>860</span>,<span class='fl'>900</span>,<span class='fl'>1050</span>,<span class='fl'>1160</span>,<span class='fl'>1900</span>,<span class='fl'>2480</span>)
<span class='no'>spno</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,  <span class='fl'>4</span>,  <span class='fl'>3</span>,  <span class='fl'>9</span>, <span class='fl'>18</span>, <span class='fl'>30</span>, <span class='fl'>20</span>, <span class='fl'>14</span>,  <span class='fl'>3</span>,  <span class='fl'>2</span>,  <span class='fl'>3</span>,  <span class='fl'>2</span>,  <span class='fl'>5</span>,  <span class='fl'>2</span>)
<span class='no'>mod</span> <span class='kw'>&lt;-</span> <span class='fu'>MOStest</span>(<span class='no'>mass</span>, <span class='no'>spno</span>)
<span class='co'>## Insignificant</span>
<span class='no'>mod</span></div><div class='output co'>#&gt; 
#&gt; Mitchell-Olds and Shaw test
#&gt; Null: hump of a quadratic linear predictor is at min or max
#&gt; 
#&gt; Family: gaussian 
#&gt; Link function: identity 
#&gt; 
#&gt;       hump        min        max 
#&gt;   46.89749  140.00000 2480.00000 
#&gt; ***** Caution: hump/pit not bracketed by the data ******
#&gt; 
#&gt;             min/max      F Pr(&gt;F)
#&gt; hump at min     140 0.0006 0.9816
#&gt; hump at max    2480 0.3161 0.5852
#&gt; Combined                   0.9924</div><div class='input'><span class='co'>## ... but inadequate shape of the curve</span>
<span class='no'>op</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>2</span>), <span class='kw'>mar</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>4</span>,<span class='fl'>4</span>,<span class='fl'>1</span>,<span class='fl'>1</span>)+<span class='fl'>.1</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>mod</span>)</div><div class='img'><img src='MOStest-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## Looks rather like log-link with Poisson error and logarithmic biomass</span>
<span class='no'>mod</span> <span class='kw'>&lt;-</span> <span class='fu'>MOStest</span>(<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>mass</span>), <span class='no'>spno</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='no'>quasipoisson</span>)
<span class='no'>mod</span></div><div class='output co'>#&gt; 
#&gt; Mitchell-Olds and Shaw test
#&gt; Null: hump of a quadratic linear predictor is at min or max
#&gt; 
#&gt; Family: quasipoisson 
#&gt; Link function: log 
#&gt; 
#&gt;      min     hump      max 
#&gt; 4.941642 6.243371 7.816014 
#&gt; 
#&gt;             min/max      F  Pr(&gt;F)  
#&gt; hump at min  4.9416 7.1367 0.02174 *
#&gt; hump at max  7.8160 9.0487 0.01191 *
#&gt; Combined                   0.03338 *
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>mod</span>)</div><div class='img'><img src='MOStest-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='no'>op</span>)
<span class='co'>## Confidence Limits</span>
<span class='fu'>fieller.MOStest</span>(<span class='no'>mod</span>)</div><div class='output co'>#&gt;    2.5 %   97.5 % 
#&gt; 5.255827 6.782979 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span>(<span class='no'>mod</span>)</div><div class='output co'>#&gt;    2.5 %   97.5 % 
#&gt; 5.816021 6.574378 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/profile.html'>profile</a></span>(<span class='no'>mod</span>))</div><div class='img'><img src='MOStest-3.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Jari Oksanen</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


