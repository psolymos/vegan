<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Multinomial Species Classification Method (CLAM) — clamtest • vegan</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Multinomial Species Classification Method (CLAM) — clamtest" />
<meta property="og:description" content="The CLAM statistical approach for classifying generalists and
specialists in two distinct habitats is described in Chazdon et al. (2011)." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vegandevs/vegan">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multinomial Species Classification Method (CLAM)</h1>
    
    <div class="hidden name"><code>clamtest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The CLAM statistical approach for classifying generalists and
specialists in two distinct habitats is described in Chazdon et al. (2011).</p>
    </div>

    <pre class="usage"><span class='fu'>clamtest</span>(<span class='no'>comm</span>, <span class='no'>groups</span>, <span class='kw'>coverage.limit</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>specialization</span> <span class='kw'>=</span> <span class='fl'>2</span>/<span class='fl'>3</span>,
   <span class='kw'>npoints</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.05</span>/<span class='fl'>20</span>)
<span class='co'># S3 method for clamtest</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for clamtest</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>x</span>, <span class='no'>xlab</span>, <span class='no'>ylab</span>, <span class='no'>main</span>,  <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>21</span>:<span class='fl'>24</span>, <span class='kw'>col.points</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>4</span>,
   <span class='kw'>col.lines</span> <span class='kw'>=</span> <span class='fl'>2</span>:<span class='fl'>4</span>, <span class='kw'>lty</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>3</span>, <span class='kw'>position</span> <span class='kw'>=</span> <span class='st'>"bottomright"</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>comm</th>
      <td><p>Community matrix, consisting of counts.</p></td>
    </tr>
    <tr>
      <th>groups</th>
      <td><p>A vector identifying the two habitats. Must have exactly
two unique values or levels. Habitat IDs in the grouping vector
must match corresponding rows in the community matrix <code>comm</code>.</p></td>
    </tr>
    <tr>
      <th>coverage.limit</th>
      <td><p>Integer, the sample coverage based correction 
is applied to rare species with counts below this limit. 
Sample coverage is calculated separately 
for the two habitats. Sample relative abundances are used for species 
with higher than or equal to <code>coverage.limit</code> total counts per habitat.</p></td>
    </tr>
    <tr>
      <th>specialization</th>
      <td><p>Numeric, specialization threshold value between 0 and 1.
The value of \(2/3\) represents &#8216;supermajority&#8217; rule,
while a value of \(1/2\) represents a &#8216;simple majority&#8217; rule
to assign shared species as habitat specialists.</p></td>
    </tr>
    <tr>
      <th>npoints</th>
      <td><p>Integer, number of points used to determine the boundary lines
in the plots.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Numeric, nominal significance level for individual
  tests.  The default value reduces the conventional limit of
  \(0.05\) to account for overdispersion and multiple testing for
  several species simultaneously. However, the is no firm reason for
  exactly this limit.</p></td>
    </tr>
    <tr>
      <th>x, object</th>
      <td><p>Fitted model object of class <code>"clamtest"</code>.</p></td>
    </tr>
    <tr>
      <th>xlab, ylab</th>
      <td><p>Labels for the plot axes.</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p>Main title of the plot.</p></td>
    </tr>
    <tr>
      <th>pch, col.points</th>
      <td><p>Symbols and colors used in plotting species groups.</p></td>
    </tr>
    <tr>
      <th>lty, col.lines</th>
      <td><p>Line types and colors for boundary lines in plot to separate species groups.</p></td>
    </tr>
    <tr>
      <th>position</th>
      <td><p>Position of figure legend, see <code><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></code> for specification details.
Legend not shown if <code>position = NULL</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to methods.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The method uses a multinomial model based on estimated
  species relative abundance in two habitats (A, B). It minimizes bias
  due to differences in sampling intensities between two habitat types
  as well as bias due to insufficient sampling within each
  habitat. The method permits a robust statistical classification of
  habitat specialists and generalists, without excluding rare species
  <em>a priori</em> (Chazdon et al. 2011).  Based on a user-defined
  <code>specialization</code> threshold, the model classifies species into
  one of four groups: (1) generalists; (2) habitat A specialists; (3)
  habitat B specialists; and (4) too rare to classify with confidence.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame (with class attribute <code>"clamtest"</code>),
  with columns:</p><ul>
<li><p><code>Species</code>: species name (column names from <code>comm</code>),</p></li>
<li><p><code>Total_*A*</code>: total count in habitat A,</p></li>
<li><p><code>Total_*B*</code>: total count in habitat B,</p></li>
<li><p><code>Classes</code>: species classification, a factor with
       levels <code>Generalist</code>, <code>Specialist_*A*</code>,
       <code>Specialist_*B*</code>, and <code>Too_rare</code>.</p></li>
</ul><p><code>*A*</code> and <code>*B*</code> are placeholders for habitat names/labels found in the
  data.</p>
<p>The <code>summary</code> method returns descriptive statistics of the results.
The <code>plot</code> method returns values invisibly and produces a bivariate
scatterplot of species total abundances in the two habitats. Symbols and
boundary lines are shown for species groups.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Chazdon, R. L., Chao, A., Colwell, R. K., Lin, S.-Y., Norden, N., 
Letcher, S. G., Clark, D. B., Finegan, B. and Arroyo J. P.(2011). 
A novel statistical method for classifying habitat
generalists and specialists. <em>Ecology</em> <b>92</b>, 1332--1343.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The code was tested against standalone CLAM software provided
on the website of Anne Chao (which were then at http://chao.stat.nthu.edu.tw/wordpress);
minor inconsistencies were found, especially for finding the
threshold for 'too rare' species.
These inconsistencies are probably due to numerical differences between the
two implementation. The current <span style="R">R</span> implementation uses 
root finding for iso-lines instead of iterative search.</p>
<p>The original method (Chazdon et al. 2011) has two major problems:</p><ol>
<li><p>It assumes that the error distribution is multinomial. This is
    a justified choice if individuals are freely distributed, and
    there is no over-dispersion or clustering of individuals. In most
    ecological data, the variance is much higher than multinomial
    assumption, and therefore test statistic are too optimistic.</p></li>
<li><p>The original authors suggest that multiple testing adjustment
    for multiple testing should be based on the number of points
    (<code>npoints</code>) used to draw the critical lines on the plot,
    whereas the adjustment should be based on the number of tests (i.e.,
    tested species). The function uses the same numerical values as
    the original paper, but there is no automatic connection between
    <code>npoints</code> and <code>alpha</code> arguments, but you must work out
    the adjustment yourself.</p></li>
</ol>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>mite</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>mite.env</span>)
<span class='no'>sol</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>mite.env</span>, <span class='fu'>clamtest</span>(<span class='no'>mite</span>, <span class='no'>Shrub</span><span class='kw'>==</span><span class='st'>"None"</span>, <span class='kw'>alpha</span><span class='kw'>=</span><span class='fl'>0.005</span>))
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>sol</span>)</div><div class='output co'>#&gt; Two Groups Species Classification Method (CLAM)
#&gt; 
#&gt; Specialization threshold = 0.6666667
#&gt; Alpha level = 0.005
#&gt; 
#&gt; Estimated sample coverage:
#&gt;  FALSE   TRUE 
#&gt; 1.0000 0.9996 
#&gt; 
#&gt; Minimum abundance for classification:
#&gt; FALSE  TRUE 
#&gt;    27     9 
#&gt; 
#&gt;                  Species Proportion
#&gt; Generalist            10      0.286
#&gt; Specialist_FALSE      14      0.400
#&gt; Specialist_TRUE        4      0.114
#&gt; Too_rare               7      0.200</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>sol</span>)</div><div class='output co'>#&gt;   Species Total_FALSE Total_TRUE          Classes
#&gt; 1  Brachy         534         77       Generalist
#&gt; 2    PHTH          89          0 Specialist_FALSE
#&gt; 3    HPAV         389        207       Generalist
#&gt; 4    RARD          85          0 Specialist_FALSE
#&gt; 5    SSTR          22          0         Too_rare
#&gt; 6 Protopl          26          0         Too_rare</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>sol</span>)</div><div class='img'><img src='clamtest-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Peter Solymos <a href='mailto:solymos@ualberta.ca'>solymos@ualberta.ca</a></p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


