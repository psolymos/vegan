<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Minimum Spanning Tree — spantree • vegan</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Minimum Spanning Tree — spantree" />
<meta property="og:description" content="Function spantree finds a minimum spanning tree
  connecting all points, but disregarding dissimilarities that are at or
  above the threshold or NA." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vegandevs/vegan">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Minimum Spanning Tree</h1>
    
    <div class="hidden name"><code>spantree.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function <code>spantree</code> finds a minimum spanning tree
  connecting all points, but disregarding dissimilarities that are at or
  above the threshold or <code>NA</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>spantree</span>(<span class='no'>d</span>, <span class='kw'>toolong</span> <span class='kw'>=</span> <span class='fl'>0</span>)
<span class='co'># S3 method for spantree</span>
<span class='fu'><a href='https://rdrr.io/r/stats/as.hclust.html'>as.hclust</a></span>(<span class='no'>x</span>, <span class='no'>...</span>)
<span class='co'># S3 method for spantree</span>
<span class='fu'><a href='https://rdrr.io/r/stats/cophenetic.html'>cophenetic</a></span>(<span class='no'>x</span>)
<span class='fu'>spandepth</span>(<span class='no'>x</span>)
<span class='co'># S3 method for spantree</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>x</span>, <span class='no'>ord</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>0.7</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"p"</span>, <span class='no'>labels</span>, <span class='no'>dlim</span>,
     <span class='kw'>FUN</span> <span class='kw'>=</span> <span class='no'>sammon</span>,  <span class='no'>...</span>)
<span class='co'># S3 method for spantree</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='no'>x</span>, <span class='no'>ord</span>, <span class='kw'>display</span><span class='kw'>=</span><span class='st'>"sites"</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>d</th>
      <td><p>Dissimilarity data inheriting from class <code>dist</code> or
    a an object, such as a matrix, that can be converted to a
    dissimilarity matrix. Functions <code><a href='vegdist.html'>vegdist</a></code> and
    <code><a href='https://rdrr.io/r/stats/dist.html'>dist</a></code> are some functions producing suitable
    dissimilarity data.</p></td>
    </tr>
    <tr>
      <th>toolong</th>
      <td><p>Shortest dissimilarity regarded as <code>NA</code>.
    The function uses a fuzz factor, so
    that dissimilarities close to the limit will be made <code>NA</code>, too.
    If <code>toolong = 0</code> (or negative), no dissimilarity is regarded
    as too long.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>A <code>spantree</code> result object.</p></td>
    </tr>
    <tr>
      <th>ord</th>
      <td><p>An ordination configuration, or an ordination result known
    by <code><a href='scores.html'>scores</a></code>.</p></td>
    </tr>
    <tr>
      <th>cex</th>
      <td><p>Character expansion factor.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Observations are plotted as points with
    <code>type="p"</code> or <code>type="b"</code>, or as text label with
    <code>type="t"</code>. The tree (lines) will always be plotted.</p></td>
    </tr>
    <tr>
      <th>labels</th>
      <td><p>Text used with <code>type="t"</code> or node names if this is
    missing.</p></td>
    </tr>
    <tr>
      <th>dlim</th>
      <td><p>A ceiling value used to highest <code>cophenetic</code> dissimilarity.</p></td>
    </tr>
    <tr>
      <th>FUN</th>
      <td><p>Ordination function to find the configuration from
    cophenetic dissimilarities. If the supplied <code>FUN</code> does not work,
    supply ordination result as argument <code>ord</code>.</p></td>
    </tr>
    <tr>
      <th>display</th>
      <td><p>Type of <code><a href='scores.html'>scores</a></code> used for <code>ord</code>.</p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>Colour of line segments. This can be a vector which is
    recycled for points, and the line colour will be a mixture of two
    joined points.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other parameters passed to functions.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    

<p>Function <code>spantree</code> finds a minimum spanning tree for
  dissimilarities (there may be several minimum spanning trees, but the
  function finds only one). Dissimilarities at or above the threshold
  <code>toolong</code> and <code>NA</code>s are disregarded, and the spanning tree
  is found through other dissimilarities. If the data are disconnected,
  the function will return a disconnected tree (or a forest), and the
  corresponding link is <code>NA</code>. Connected subtrees can be identified
  using <code><a href='distconnected.html'>distconnected</a></code>.</p>
<p>Minimum spanning tree is closely related to single linkage
  clustering, a.k.a. nearest neighbour clustering, and in genetics as
  neighbour joining tree available in <code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code> and
  <code><a href='https://rdrr.io/pkg/cluster/man/agnes.html'>agnes</a></code> functions. The most important practical
  difference is that minimum spanning tree has no concept of cluster
  membership, but always joins individual points to each other. Function
  <code>as.hclust</code> can change the <code>spantree</code> result into a
  corresponding <code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code> object.</p>
<p>Function <code>cophenetic</code> finds distances between all points along
  the tree segments. Function <code>spandepth</code> returns the depth of
  each node. The nodes of a tree are either leaves (with one link) or
  internal nodes (more than one link). The leaves are recursively
  removed from the tree, and the depth is the layer at with the leaf
  was removed. In disconnected <code>spantree</code> object (in a forest)
  each tree is analysed separately and disconnected nodes not in any
  tree have depth zero.</p>
<p>Function <code>plot</code> displays the tree over a
  supplied ordination configuration, and <code>lines</code> adds a spanning
  tree to an ordination graph. If configuration is not supplied for <code>plot</code>,
  the function ordinates the cophenetic dissimilarities of the
  spanning tree and overlays the tree on this result. The default
  ordination function is <code><a href='https://rdrr.io/pkg/MASS/man/sammon.html'>sammon</a></code> (package <span class="pkg">MASS</span>),
  because Sammon scaling emphasizes structure in the neighbourhood of
  nodes and may be able to beautifully represent the tree (you may need
  to set <code>dlim</code>, and sometimes the results will remain
  twisted). These ordination methods do not work with disconnected
  trees, but you must supply the ordination configuration. Function
  <code>lines</code> will overlay the tree in an existing plot.</p>
<p>Function <code>spantree</code> uses Prim's method
  implemented as priority-first search for dense graphs (Sedgewick
  1990). Function <code>cophenetic</code> uses function
  <code><a href='stepacross.html'>stepacross</a></code> with option <code>path = "extended"</code>. The
  <code>spantree</code> is very fast, but <code>cophenetic</code> is slow in very
  large data sets.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Function <code>spantree</code>
  returns an object of class <code>spantree</code> which is a
  list with two vectors, each of length \(n-1\). The
  number of links in a tree is one less the number of observations, and
  the first item is omitted. The items are</p>
<dt>kid </dt><dd><p>The child node of the parent, starting from parent number
    two. If there is no link from the parent, value will be <code>NA</code>
    and tree is disconnected at the node.</p></dd>
  <dt>dist </dt><dd><p>Corresponding distance. If <code>kid = NA</code>, then
    <code>dist = 0</code>.</p></dd>
  <dt>labels </dt><dd><p>Names of nodes as found from the input dissimilarities.</p></dd>
  <dt>call</dt><dd><p>The function call.</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Sedgewick, R. (1990). <em>Algorithms in C</em>. Addison Wesley.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>In principle, minimum spanning tree is equivalent to single linkage
  clustering that can be performed using <code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code> or
  <code><a href='https://rdrr.io/pkg/cluster/man/agnes.html'>agnes</a></code>. However, these functions combine
  clusters to each other and the information of the actually connected points
  (the &#8220;single link&#8221;) cannot be recovered from the result. The
  graphical output of a single linkage clustering plotted with
  <code><a href='ordihull.html'>ordicluster</a></code> will look very different from an equivalent
  spanning tree plotted with <code>lines.spantree</code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='vegdist.html'>vegdist</a></code> or <code><a href='https://rdrr.io/r/stats/dist.html'>dist</a></code> for getting
  dissimilarities,  and <code><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></code> or
    <code><a href='https://rdrr.io/pkg/cluster/man/agnes.html'>agnes</a></code> for single linkage clustering.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>dune</span>)
<span class='no'>dis</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='vegdist.html'>vegdist</a></span>(<span class='no'>dune</span>)
<span class='no'>tr</span> <span class='kw'>&lt;-</span> <span class='fu'>spantree</span>(<span class='no'>dis</span>)
<span class='co'>## Add tree to a metric scaling</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>tr</span>, <span class='fu'><a href='https://rdrr.io/r/stats/cmdscale.html'>cmdscale</a></span>(<span class='no'>dis</span>), <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"t"</span>)</div><div class='img'><img src='spantree-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## Find a configuration to display the tree neatly</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>tr</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"t"</span>)</div><div class='output co'>#&gt; Initial stress        : 0.03111
#&gt; stress after  10 iters: 0.01302, magic = 0.500
#&gt; stress after  20 iters: 0.01139, magic = 0.500
#&gt; stress after  30 iters: 0.01118, magic = 0.500
#&gt; stress after  40 iters: 0.01114, magic = 0.500</div><div class='img'><img src='spantree-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## Depths of nodes</span>
<span class='no'>depths</span> <span class='kw'>&lt;-</span> <span class='fu'>spandepth</span>(<span class='no'>tr</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>tr</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"t"</span>, <span class='kw'>label</span> <span class='kw'>=</span> <span class='no'>depths</span>)</div><div class='output co'>#&gt; Initial stress        : 0.03111
#&gt; stress after  10 iters: 0.01302, magic = 0.500
#&gt; stress after  20 iters: 0.01139, magic = 0.500
#&gt; stress after  30 iters: 0.01118, magic = 0.500
#&gt; stress after  40 iters: 0.01114, magic = 0.500</div><div class='img'><img src='spantree-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## Plot as a dendrogram</span>
<span class='no'>cl</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/as.hclust.html'>as.hclust</a></span>(<span class='no'>tr</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>cl</span>)</div><div class='img'><img src='spantree-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## cut hclust tree to classes and show in colours in spantree</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>tr</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cutree.html'>cutree</a></span>(<span class='no'>cl</span>, <span class='fl'>5</span>), <span class='kw'>pch</span><span class='kw'>=</span><span class='fl'>16</span>)</div><div class='output co'>#&gt; Initial stress        : 0.03111
#&gt; stress after  10 iters: 0.01302, magic = 0.500
#&gt; stress after  20 iters: 0.01139, magic = 0.500
#&gt; stress after  30 iters: 0.01118, magic = 0.500
#&gt; stress after  40 iters: 0.01114, magic = 0.500</div><div class='img'><img src='spantree-5.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Jari Oksanen</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


