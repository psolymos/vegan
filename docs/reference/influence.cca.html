<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Linear Model Diagnostics for Constrained Ordination — influence.cca • vegan</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Linear Model Diagnostics for Constrained Ordination — influence.cca" />
<meta property="og:description" content="

This set of function extracts influence statistics and some other
  linear model statistics directly from a constrained ordination result
  object from cca, rda,
  capscale or dbrda. The constraints are
  linear model functions and these support functions return identical
  results as the corresponding linear models (lm), and you
  can use their documentation. The main functions for normal usage are
  leverage values (hatvalues), standardized residuals
  (rstandard), studentized or leave-one-out residuals
  (rstudent), and Cook's distance
  (cooks.distance).  In addition, vcov
  returns the variance-covariance matrix of coefficients, and its
  diagonal values the variances of coefficients. Other functions are
  mainly support functions for these, but they can be used directly." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vegandevs/vegan">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Linear Model Diagnostics for Constrained Ordination</h1>
    
    <div class="hidden name"><code>influence.cca.Rd</code></div>
    </div>

    <div class="ref-description">
    

<p>This set of function extracts influence statistics and some other
  linear model statistics directly from a constrained ordination result
  object from <code><a href='cca.html'>cca</a></code>, <code><a href='cca.html'>rda</a></code>,
  <code><a href='capscale.html'>capscale</a></code> or <code><a href='capscale.html'>dbrda</a></code>. The constraints are
  linear model functions and these support functions return identical
  results as the corresponding linear models (<code><a href='https://rdrr.io/r/stats/lm.html'>lm</a></code>), and you
  can use their documentation. The main functions for normal usage are
  leverage values (<code><a href='https://rdrr.io/r/stats/influence.measures.html'>hatvalues</a></code>), standardized residuals
  (<code><a href='https://rdrr.io/r/stats/influence.measures.html'>rstandard</a></code>), studentized or leave-one-out residuals
  (<code><a href='https://rdrr.io/r/stats/influence.measures.html'>rstudent</a></code>), and Cook's distance
  (<code><a href='https://rdrr.io/r/stats/influence.measures.html'>cooks.distance</a></code>).  In addition, <code><a href='https://rdrr.io/r/stats/vcov.html'>vcov</a></code>
  returns the variance-covariance matrix of coefficients, and its
  diagonal values the variances of coefficients. Other functions are
  mainly support functions for these, but they can be used directly.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for cca</span>
<span class='fu'><a href='https://rdrr.io/r/stats/influence.measures.html'>hatvalues</a></span>(<span class='no'>model</span>, <span class='no'>...</span>)
<span class='co'># S3 method for cca</span>
<span class='fu'><a href='https://rdrr.io/r/stats/influence.measures.html'>rstandard</a></span>(<span class='no'>model</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"response"</span>, <span class='st'>"canoco"</span>), <span class='no'>...</span>)
<span class='co'># S3 method for cca</span>
<span class='fu'><a href='https://rdrr.io/r/stats/influence.measures.html'>rstudent</a></span>(<span class='no'>model</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"response"</span>, <span class='st'>"canoco"</span>), <span class='no'>...</span>)
<span class='co'># S3 method for cca</span>
<span class='fu'><a href='https://rdrr.io/r/stats/influence.measures.html'>cooks.distance</a></span>(<span class='no'>model</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"response"</span>, <span class='st'>"canoco"</span>), <span class='no'>...</span>)

<span class='co'># S3 method for cca</span>
<span class='fu'><a href='https://rdrr.io/r/stats/sigma.html'>sigma</a></span>(<span class='no'>object</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"response"</span>, <span class='st'>"canoco"</span>), <span class='no'>...</span>)
<span class='co'># S3 method for cca</span>
<span class='fu'><a href='https://rdrr.io/r/stats/vcov.html'>vcov</a></span>(<span class='no'>object</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"canoco"</span>, <span class='no'>...</span>)
<span class='co'># S3 method for cca</span>
<span class='fu'><a href='https://rdrr.io/r/stats/SSD.html'>SSD</a></span>(<span class='no'>object</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"canoco"</span>, <span class='no'>...</span>)

<span class='co'># S3 method for cca</span>
<span class='fu'><a href='https://rdrr.io/r/base/qr.html'>qr</a></span>(<span class='no'>x</span>, <span class='no'>...</span>)
<span class='co'># S3 method for cca</span>
<span class='fu'><a href='https://rdrr.io/r/stats/df.residual.html'>df.residual</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>model, object, x</th>
      <td><p>A constrained ordination result object.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Type of statistics used for extracting raw residuals and
    residual standard deviation (<code>sigma</code>). Either
    <code>"response"</code> for species data or difference of WA and LC
    scores for <code>"canoco"</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments to functions (ignored).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    

<p>The <span class="pkg">vegan</span> algorithm for constrained ordination uses linear model
  (or weighted linear model in <code><a href='cca.html'>cca</a></code>) to find the fitted
  values of dependent community data, and constrained ordination is
  based on this fitted response (Legendre &amp; Legendre 2012). The
  <code><a href='https://rdrr.io/r/stats/influence.measures.html'>hatvalues</a></code> give the leverage values of these constraints,
  and the leverage is independent on the response data. Other influence
  statistics (<code><a href='https://rdrr.io/r/stats/influence.measures.html'>rstandard</a></code>, <code><a href='https://rdrr.io/r/stats/influence.measures.html'>rstudent</a></code>,
  <code><a href='https://rdrr.io/r/stats/influence.measures.html'>cooks.distance</a></code>) are based on leverage, and on the raw
  residuals and residual standard deviation (<code><a href='https://rdrr.io/r/stats/sigma.html'>sigma</a></code>). With
  <code>type = "response"</code> the raw residuals are given by the
  unconstrained component of the constrained ordination, and influence
  statistics are a matrix with dimensions no. of observations times
  no. of species. For <code><a href='cca.html'>cca</a></code> the statistics are the same as
  obtained from the <code><a href='https://rdrr.io/r/stats/lm.html'>lm</a></code> model using Chi-square standardized
  species data (see <code><a href='decostand.html'>decostand</a></code>) as dependent variable, and
  row sums of community data as weights, and for <code><a href='cca.html'>rda</a></code> the
  <code><a href='https://rdrr.io/r/stats/lm.html'>lm</a></code> model uses non-modified community data and no
  weights.</p>
<p>The algorithm in the CANOCO software constraints the results during
  iteration by performing a linear regression of weighted averages (WA)
  scores on constraints and taking the fitted values of this regression
  as linear combination (LC) scores (ter Braak 1984). The WA scores are
  directly found from species scores, but LC scores are linear
  combinations of constraints in the regression. With <code>type =
  "canoco"</code> the raw residuals are the differences of WA and LC scores,
  and the residual standard deviation (<code><a href='https://rdrr.io/r/stats/sigma.html'>sigma</a></code>) is taken to
  be the axis sum of squared WA scores minus one. These quantities have
  no relationship to residual component of ordination, but they rather
  are methodological artefacts of an algorithm that is not used in
  <span class="pkg">vegan</span>. The result is a matrix with dimensions no. of
  observations times no. of constrained axes.</p>
<p>Function <code><a href='https://rdrr.io/r/stats/vcov.html'>vcov</a></code> returns the matrix of variances and
  covariances of regression coefficients. The diagonal values of this
  matrix are the variances, and their square roots give the standard
  errors of regression coefficients. The function is based on
  <code><a href='https://rdrr.io/r/stats/SSD.html'>SSD</a></code> that extracts the sum of squares and crossproducts
  of residuals. The residuals are defined similarly as in influence
  measures and with each <code>type</code> they have similar properties and
  limitations, and define the dimensions of the result matrix.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    

<p>Legendre, P. and Legendre, L. (2012) <em>Numerical Ecology</em>. 3rd
  English ed. Elsevier.</p>  
<p>ter Braak, C.J.F. (1984--): CANOCO -- a FORTRAN program for
  <em>cano</em>nical <em>c</em>ommunity <em>o</em>rdination by [partial]
  [detrended] [canonical] correspondence analysis, principal components
  analysis and redundancy analysis. <em>TNO Inst. of Applied Computer
  Sci., Stat. Dept. Wageningen, The Netherlands</em>.</p>
  

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    

<p>Function <code><a href='vegan-defunct.html'>as.mlm</a></code> casts an ordination object to a multiple
  linear model of class <code>"mlm"</code> (see <code><a href='https://rdrr.io/r/stats/lm.html'>lm</a></code>), and similar
  statistics can be derived from that modified object as with this set
  of functions. However, there are some problems in the <span style="R">R</span>
  implementation of the further analysis of multiple linear model
  objects. When the results differ, the current set of functions is more
  probable to be correct. The use of <code>as.mlm</code> objects should be
  avoided.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Corresponding <code><a href='https://rdrr.io/r/stats/lm.html'>lm</a></code> methods and
  <code><a href='vegan-defunct.html'>as.mlm.cca</a></code>. Function <code><a href='ordiresids.html'>ordiresids</a></code> provides
  lattice graphics for residuals.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>varespec</span>, <span class='no'>varechem</span>)
<span class='no'>mod</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='cca.html'>cca</a></span>(<span class='no'>varespec</span> ~ <span class='no'>Al</span> + <span class='no'>P</span> + <span class='no'>K</span>, <span class='no'>varechem</span>)
<span class='co'>## leverage</span>
<span class='fu'><a href='https://rdrr.io/r/stats/influence.measures.html'>hatvalues</a></span>(<span class='no'>mod</span>)</div><div class='output co'>#&gt;         18         15         24         27         23         19         22 
#&gt; 0.06904416 0.06666628 0.15245083 0.18944882 0.09291510 0.05122338 0.15309307 
#&gt;         16         28         13         14         20         25          7 
#&gt; 0.09605909 0.27139695 0.75889765 0.04958141 0.06582891 0.10590183 0.20630888 
#&gt;          5          6          3          4          2          9         12 
#&gt; 0.19797654 0.16280522 0.22738889 0.30915530 0.15557066 0.14855598 0.09046701 
#&gt;         10         11         21 
#&gt; 0.12745850 0.10984996 0.14195559 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/influence.measures.html'>hatvalues</a></span>(<span class='no'>mod</span>), <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"h"</span>)</div><div class='img'><img src='influence.cca-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## ordination plot with leverages: points with high leverage have</span>
<span class='co'>## similar LC and WA scores</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>mod</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"n"</span>)</div><div class='input'><span class='fu'><a href='ordihull.html'>ordispider</a></span>(<span class='no'>mod</span>)       <span class='co'># segment from LC to WA scores</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='no'>mod</span>, <span class='kw'>dis</span><span class='kw'>=</span><span class='st'>"si"</span>, <span class='kw'>cex</span><span class='kw'>=</span><span class='fl'>5</span>*<span class='fu'><a href='https://rdrr.io/r/stats/influence.measures.html'>hatvalues</a></span>(<span class='no'>mod</span>), <span class='kw'>pch</span><span class='kw'>=</span><span class='fl'>21</span>, <span class='kw'>bg</span><span class='kw'>=</span><span class='fl'>2</span>) <span class='co'># WA scores</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/text.html'>text</a></span>(<span class='no'>mod</span>, <span class='kw'>dis</span><span class='kw'>=</span><span class='st'>"bp"</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='fl'>4</span>)</div><div class='img'><img src='influence.cca-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## deviation and influence</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/influence.measures.html'>rstandard</a></span>(<span class='no'>mod</span>))</div><div class='output co'>#&gt;      Callvulg   Empenigr    Rhodtome     Vaccmyrt   Vaccviti   Pinusylv
#&gt; 18  0.4084518  0.9442480 -0.68178124 -0.798241724  0.9883838 -0.3086868
#&gt; 15 -1.3902462 -1.5717947 -0.70784872 -0.645563228  0.2353736 -0.1679226
#&gt; 24  0.9622453 -0.9520875 -0.08884556 -0.654099911  0.2420416  0.4832198
#&gt; 27 -1.1080099  1.0938951  1.70146427 -0.196668562 -0.3937467 -0.7424140
#&gt; 23  0.3979939  1.3218254 -0.63872221 -1.003315524  1.8996365 -0.4495408
#&gt; 19 -1.5874575  0.7894087 -0.59609083 -0.006142973  0.1334143 -0.1060450
#&gt;      Descflex   Betupube   Vacculig   Diphcomp      Dicrsp     Dicrfusc
#&gt; 18 -0.5785258 -0.4585683  0.7640788  4.3748349 -0.39301720 -0.656213958
#&gt; 15 -0.5416812 -0.4594716 -0.3410155 -0.2704388 -0.05769657  0.406022095
#&gt; 24 -0.6409619  0.1908003  0.0198320 -0.2175720  3.75416938 -0.009140093
#&gt; 27  4.2976822 -0.2704153  0.9211453 -0.2037075 -0.84410200 -0.712968237
#&gt; 23 -0.8356637 -0.2779318 -0.0206861 -0.2899895 -0.67773316 -0.294674408
#&gt; 19 -0.4453843 -0.3739569 -0.3174207 -0.2429740 -0.14281646 -0.819230368
#&gt;      Dicrpoly   Hylosple   Pleuschr    Polypili   Polyjuni   Polycomm
#&gt; 18 -0.4933634 -0.6030042 -1.3812122 -0.07430854 -0.5332731 -0.7140513
#&gt; 15 -0.3630434 -0.4055353  1.9930791  0.02126658 -0.2274864 -0.6730241
#&gt; 24  2.2312025 -1.3907968  0.5792314 -0.45358405 -0.4628096 -0.2153846
#&gt; 27 -0.5715008  1.6310289  0.8124329 -0.34628172 -0.8630615  0.9423113
#&gt; 23 -0.4684368 -1.1995321 -0.8241477 -0.04953929  0.7890327 -0.6774675
#&gt; 19 -0.3186606 -0.3948224  0.6180114  0.05035990  0.8260214  2.3626483
#&gt;      Pohlnuta    Ptilcili    Barbhatc   Cladarbu    Cladrang   Cladstel
#&gt; 18  0.2918311 -0.42027512 -0.40191333  1.5303054  0.85056948 -0.2218833
#&gt; 15 -0.6168627 -0.47096984 -0.42715787  0.1758993 -0.45409579 -0.3739920
#&gt; 24  1.9274063  0.09984384  0.21066100  0.1668363 -0.08508535 -1.2835676
#&gt; 27 -1.5729552 -0.31944598 -0.09167396 -0.1864165  0.51080623 -0.1083797
#&gt; 23  0.4875575  0.61798970 -0.18848086  0.5574309  0.28079468 -0.4026464
#&gt; 19 -0.1141521 -0.25344373 -0.31179839 -0.2391669 -0.65577452  0.6584127
#&gt;       Cladunci    Cladcocc   Cladcorn    Cladgrac   Cladfimb   Cladcris
#&gt; 18 -0.39796095  0.93836573 -0.2564543  0.33864378  1.1572584 -0.2083305
#&gt; 15  0.06761526  0.24340663 -0.1767166  0.27491203  1.0721632  1.9724410
#&gt; 24  1.24902375 -0.98471253 -0.4801382  2.51184311 -1.4063518 -0.3084304
#&gt; 27 -0.59021669 -1.25354423 -0.2460447 -1.09351514 -1.1681499 -1.0337232
#&gt; 23 -0.34604539 -0.10730202  3.9477300  2.51924664  0.3536280  3.3882402
#&gt; 19 -0.33866721  0.02698153  0.1776632  0.03968833 -0.7512944 -0.4763562
#&gt;      Cladchlo   Cladbotr   Cladamau     Cladsp   Cetreric   Cetrisla
#&gt; 18 -0.5711604 -0.4914716  4.0852019  0.2489284 -0.4428064 -0.5834462
#&gt; 15 -0.4347061 -0.6517740 -0.3155708 -0.2568784  0.2369559 -0.3468005
#&gt; 24  0.6013607  0.4603779 -0.1576900 -0.5995616  2.7826114  0.3931826
#&gt; 27 -0.5436659 -0.2788962 -0.1606997  0.1557879 -0.7298364 -0.5867612
#&gt; 23  0.1029999  0.6494142 -0.3415411 -0.2330698 -0.6309632 -0.5301977
#&gt; 19  0.2793712 -0.1315438 -0.2705486 -0.2865837 -0.4664078 -0.5056846
#&gt;       Flavniva   Nepharct      Stersp   Peltapht     Icmaeric    Cladcerv
#&gt; 18  0.30428187 -0.3624631 -0.23665431 -0.1571633 -0.630333375  0.12058739
#&gt; 15  0.17345018 -0.1919943  0.05469573 -0.3233311 -0.561177494  0.08518455
#&gt; 24 -0.74154401 -0.4146848 -0.05500461 -0.7609417  0.255058737 -0.92761801
#&gt; 27  0.11301489 -0.5064006 -0.08681568 -0.1247151 -0.001277338 -0.04038189
#&gt; 23  0.09411988 -0.4627811  0.47668055  3.5826478 -0.274664798 -0.05517988
#&gt; 19  0.07211309 -0.1693122 -0.17244475 -0.3155345 -0.461532920 -0.02709075
#&gt;       Claddefo   Cladphyl
#&gt; 18 -0.43581630 -0.2098378
#&gt; 15  0.94176661 -0.1028102
#&gt; 24 -0.07508682 -1.0479632
#&gt; 27 -1.06110299 -0.4908554
#&gt; 23  2.66430575 -0.4244333
#&gt; 19 -0.08427954 -0.1692474</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/influence.measures.html'>cooks.distance</a></span>(<span class='no'>mod</span>))</div><div class='output co'>#&gt;       Callvulg   Empenigr     Rhodtome     Vaccmyrt     Vaccviti     Pinusylv
#&gt; 18 0.003093283 0.01653142 0.0086184263 1.181427e-02 0.0181129462 0.0017667454
#&gt; 15 0.034513793 0.04411649 0.0089472619 7.441951e-03 0.0009892926 0.0005035324
#&gt; 24 0.041636714 0.04076229 0.0003549575 1.923947e-02 0.0026344196 0.0105001237
#&gt; 27 0.071736260 0.06992022 0.1691597848 2.260067e-03 0.0090591037 0.0322065174
#&gt; 23 0.004056312 0.04474315 0.0104472601 2.577825e-02 0.0924100906 0.0051750754
#&gt; 19 0.034013281 0.00841101 0.0047958896 5.093326e-07 0.0002402422 0.0001517834
#&gt;       Descflex    Betupube     Vacculig     Diphcomp       Dicrsp     Dicrfusc
#&gt; 18 0.006205594 0.003898934 1.082466e-02 0.3548634058 2.863921e-03 7.984152e-03
#&gt; 15 0.005239584 0.003769873 2.076622e-03 0.0013060122 5.944416e-05 2.943802e-03
#&gt; 24 0.018474359 0.001637053 1.768633e-05 0.0021286828 6.337714e-01 3.756697e-06
#&gt; 27 1.079245024 0.004272814 4.958014e-02 0.0024247421 4.163335e-02 2.970242e-02
#&gt; 23 0.017883042 0.001978130 1.095811e-05 0.0021534900 1.176240e-02 2.223634e-03
#&gt; 19 0.002677405 0.001887502 1.359924e-03 0.0007968265 2.752966e-04 9.058502e-03
#&gt;       Dicrpoly    Hylosple    Pleuschr     Polypili     Polyjuni    Polycomm
#&gt; 18 0.004513066 0.006741841 0.035371924 1.023801e-04 0.0052727512 0.009453588
#&gt; 15 0.002353565 0.002936747 0.070934636 8.076156e-06 0.0009241023 0.008088546
#&gt; 24 0.223863289 0.086982577 0.015087217 9.251676e-03 0.0096318471 0.002086096
#&gt; 27 0.019084693 0.155444288 0.038567940 7.006653e-03 0.0435246182 0.051884812
#&gt; 23 0.005619275 0.036846999 0.017393559 6.284604e-05 0.0159429407 0.011753178
#&gt; 19 0.001370570 0.002104010 0.005155103 3.423056e-05 0.0092093061 0.075342921
#&gt;        Pohlnuta     Ptilcili     Barbhatc     Cladarbu     Cladrang
#&gt; 18 0.0015790689 0.0032749544 0.0029950405 0.0434204290 0.0134139742
#&gt; 15 0.0067949512 0.0039609143 0.0032582625 0.0005525065 0.0036821731
#&gt; 24 0.1670519112 0.0004482780 0.0019955986 0.0012516596 0.0003255476
#&gt; 27 0.1445719869 0.0059627459 0.0004910701 0.0020305802 0.0152462776
#&gt; 23 0.0060873754 0.0097800450 0.0009097308 0.0079572035 0.0020190921
#&gt; 19 0.0001758783 0.0008669766 0.0013121758 0.0007720518 0.0058043470
#&gt;        Cladstel     Cladunci     Cladcocc     Cladcorn     Cladgrac    Cladfimb
#&gt; 18 0.0009128242 2.936424e-03 1.632609e-02 0.0012194323 2.126298e-03 0.024831249
#&gt; 15 0.0024976637 8.163919e-05 1.057972e-03 0.0005576530 1.349574e-03 0.020527262
#&gt; 24 0.0740870642 7.015301e-02 4.360375e-02 0.0103666250 2.837200e-01 0.088939118
#&gt; 27 0.0006863532 2.035516e-02 9.181862e-02 0.0035373629 6.987166e-02 0.079734929
#&gt; 23 0.0041517010 3.066511e-03 2.948453e-04 0.3990922140 1.625248e-01 0.003202372
#&gt; 19 0.0058511426 1.548070e-03 9.826017e-06 0.0004260291 2.126033e-05 0.007618415
#&gt;        Cladcris     Cladchlo     Cladbotr     Cladamau      Cladsp    Cetreric
#&gt; 18 0.0008047178 0.0060485887 0.0044785217 0.3094317912 0.001148912 0.003635513
#&gt; 15 0.0694732020 0.0033744318 0.0075858327 0.0017782910 0.001178323 0.001002639
#&gt; 24 0.0042777886 0.0162620357 0.0095308986 0.0011181833 0.016164882 0.348184969
#&gt; 27 0.0624395810 0.0172709295 0.0045450274 0.0015089732 0.001418140 0.031124511
#&gt; 23 0.2939860714 0.0002716767 0.0107999564 0.0029872002 0.001391075 0.010194981
#&gt; 19 0.0030627243 0.0010534342 0.0002335528 0.0009879496 0.001108529 0.002936134
#&gt;       Cetrisla     Flavniva     Nepharct       Stersp     Peltapht     Icmaeric
#&gt; 18 0.006311601 1.716683e-03 0.0024359336 1.038405e-03 0.0004579733 7.366793e-03
#&gt; 15 0.002147676 5.372282e-04 0.0006582422 5.342149e-05 0.0018668272 5.623539e-03
#&gt; 24 0.006951741 2.472742e-02 0.0077328775 1.360514e-04 0.0260380002 2.925400e-03
#&gt; 27 0.020117510 7.463161e-04 0.0149844191 4.404005e-04 0.0009088445 9.533741e-08
#&gt; 23 0.007198701 2.268512e-04 0.0054844061 5.818798e-03 0.3286900860 1.931899e-03
#&gt; 19 0.003451467 7.018956e-05 0.0003869197 4.013694e-04 0.0013438101 2.875078e-03
#&gt;        Cladcerv     Claddefo     Cladphyl
#&gt; 18 2.696135e-04 3.521639e-03 0.0008164040
#&gt; 15 1.295779e-04 1.583784e-02 0.0001887477
#&gt; 24 3.869397e-02 2.535317e-04 0.0493852158
#&gt; 27 9.528504e-05 6.579101e-02 0.0140785723
#&gt; 23 7.797221e-05 1.817802e-01 0.0046131462
#&gt; 19 9.905729e-06 9.587131e-05 0.0003866237</div><div class='input'>
<span class='co'>## Influence measures from lm</span>
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='decostand.html'>decostand</a></span>(<span class='no'>varespec</span>, <span class='st'>"chi.square"</span>) <span class='co'># needed in cca</span>
<span class='no'>y1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>y</span>, <span class='no'>Cladstel</span>)         <span class='co'># take one species for lm</span>
<span class='no'>lmod1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span>(<span class='no'>y1</span> ~ <span class='no'>Al</span> + <span class='no'>P</span> + <span class='no'>K</span>, <span class='no'>varechem</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span>(<span class='no'>varespec</span>))
<span class='co'>## numerically identical within 2e-15</span>
<span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/influence.measures.html'>cooks.distance</a></span>(<span class='no'>lmod1</span>) - <span class='fu'><a href='https://rdrr.io/r/stats/influence.measures.html'>cooks.distance</a></span>(<span class='no'>mod</span>)[, <span class='st'>"Cladstel"</span>])</div><div class='output co'>#&gt; [1] -2.775558e-16  2.498002e-16</div><div class='input'>
<span class='co'>## t-values of regression coefficients based on type = "canoco"</span>
<span class='co'>## residuals</span>
<span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>mod</span>)</div><div class='output co'>#&gt;            CCA1         CCA2         CCA3
#&gt; Al  0.007478556 -0.001883637  0.003380774
#&gt; P  -0.006491081 -0.102189737 -0.022306682
#&gt; K  -0.006755568  0.015343662  0.017067351</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span>(<span class='no'>mod</span>)/<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/vcov.html'>vcov</a></span>(<span class='no'>mod</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"canoco"</span>)))</div><div class='output co'>#&gt;          CCA1      CCA2      CCA3
#&gt; Al  6.5615451 -1.397643  3.313629
#&gt; P  -0.4576132 -6.092557 -1.756774
#&gt; K  -2.0862129  4.007159  5.887926</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Jari Oksanen</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


