<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Best Subset of Environmental Variables with
  Maximum (Rank) Correlation with Community Dissimilarities — bioenv • vegan</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Best Subset of Environmental Variables with
  Maximum (Rank) Correlation with Community Dissimilarities — bioenv" />
<meta property="og:description" content="Function finds the best subset of environmental variables, so that
  the Euclidean distances of scaled environmental variables have the
  maximum (rank) correlation with community dissimilarities." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vegandevs/vegan">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Best Subset of Environmental Variables with
  Maximum (Rank) Correlation with Community Dissimilarities</h1>
    
    <div class="hidden name"><code>bioenv.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function finds the best subset of environmental variables, so that
  the Euclidean distances of scaled environmental variables have the
  maximum (rank) correlation with community dissimilarities.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for default</span>
<span class='fu'>bioenv</span>(<span class='no'>comm</span>, <span class='no'>env</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"spearman"</span>, <span class='kw'>index</span> <span class='kw'>=</span> <span class='st'>"bray"</span>,
       <span class='kw'>upto</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span>(<span class='no'>env</span>), <span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>partial</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
       <span class='kw'>metric</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"euclidean"</span>, <span class='st'>"mahalanobis"</span>, <span class='st'>"manhattan"</span>, <span class='st'>"gower"</span>),
       <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span>(<span class='st'>"mc.cores"</span>), <span class='no'>...</span>)
<span class='co'># S3 method for formula</span>
<span class='fu'>bioenv</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='no'>...</span>)
<span class='fu'>bioenvdist</span>(<span class='no'>x</span>, <span class='kw'>which</span> <span class='kw'>=</span> <span class='st'>"best"</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>comm</th>
      <td><p>Community data frame or a dissimilarity object or a square
    matrix that can be interpreted as dissimilarities.</p></td>
    </tr>
    <tr>
      <th>env</th>
      <td><p>Data frame of continuous environmental variables.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>The correlation method used in <code><a href='https://rdrr.io/r/stats/cor.html'>cor</a></code>.</p></td>
    </tr>
    <tr>
      <th>index</th>
      <td><p>The dissimilarity index used for community data (<code>comm</code>) 
    in <code><a href='vegdist.html'>vegdist</a></code>. This is ignored if <code>comm</code> are dissimilarities.</p></td>
    </tr>
    <tr>
      <th>upto</th>
      <td><p>Maximum number of parameters in studied subsets.</p></td>
    </tr>
    <tr>
      <th>formula, data</th>
      <td><p>Model <code><a href='https://rdrr.io/r/stats/formula.html'>formula</a></code> and data.</p></td>
    </tr>
    <tr>
      <th>trace</th>
      <td><p>Trace the calculations</p></td>
    </tr>
    <tr>
      <th>partial</th>
      <td><p>Dissimilarities partialled out when inspecting
    variables in <code>env</code>.</p></td>
    </tr>
    <tr>
      <th>metric</th>
      <td><p>Metric used for distances of environmental distances. See 
    Details.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>Number of parallel processes or a predefined socket
    cluster.  With <code>parallel = 1</code> uses ordinary, non-parallel
    processing. The parallel processing is done with <span class="pkg">parallel</span>
    package.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p><code>bioenv</code> result object.</p></td>
    </tr>
    <tr>
      <th>which</th>
      <td><p>The number of the model for which the environmental
    distances are evaluated, or the <code>"best"</code> model.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments passed to <code><a href='https://rdrr.io/r/stats/cor.html'>cor</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
  
<p>The function calculates a community dissimilarity matrix using
  <code><a href='vegdist.html'>vegdist</a></code>.  Then it selects all possible subsets of
  environmental variables, <code><a href='https://rdrr.io/r/base/scale.html'>scale</a></code>s the variables, and
  calculates Euclidean distances for this subset using
  <code><a href='https://rdrr.io/r/stats/dist.html'>dist</a></code>.  The function finds the correlation between
  community dissimilarities and environmental distances, and for each
  size of subsets, saves the best result.  There are \(2^p-1\)
  subsets of \(p\) variables, and an exhaustive search may take a
  very, very, very long time (parameter <code>upto</code> offers a partial
  relief).</p>
<p>The argument <code>metric</code> defines distances in the given set of
  environmental variables.  With <code>metric = "euclidean"</code>, the
  variables are scaled to unit variance and Euclidean distances are
  calculated. With <code>metric = "mahalanobis"</code>, the Mahalanobis
  distances are calculated: in addition to scaling to unit variance,
  the matrix of the current set of environmental variables is also
  made orthogonal (uncorrelated). With <code>metric = "manhanttan"</code>,
  the variables are scaled to unit range and Manhattan distances are
  calculated, so that the distances are sums of differences of
  environmental variables.  With <code>metric = "gower"</code>, the Gower
  distances are calculated using function
  <code><a href='https://rdrr.io/pkg/cluster/man/daisy.html'>daisy</a></code>. This allows also using factor
  variables, but with continuous variables the results are equal to
  <code>metric = "manhattan"</code>.</p>
<p>The function can be called with a model <code><a href='https://rdrr.io/r/stats/formula.html'>formula</a></code> where
  the LHS is the data matrix and RHS lists the environmental variables.
  The formula interface is practical in selecting or transforming
  environmental variables.</p>
<p>With argument <code>partial</code> you can perform &#8220;partial&#8221;
  analysis. The partializing item must be a dissimilarity object of
  class <code><a href='https://rdrr.io/r/stats/dist.html'>dist</a></code>. The
  <code>partial</code> item can be used with any correlation <code>method</code>,
  but it is strictly correct only for Pearson.</p>
<p>Function <code>bioenvdist</code> recalculates the environmental distances
  used within the function. The default is to calculate distances for
  the best model, but the number of any model can be given.</p>  
<p>Clarke &amp; Ainsworth (1993) suggested this method to be used for
  selecting the best subset of environmental variables in interpreting
  results of nonmetric multidimensional scaling (NMDS). They recommended a
  parallel display of NMDS of community dissimilarities and NMDS of
  Euclidean distances from the best subset of scaled environmental
  variables.  They warned against the use of Procrustes analysis, but
  to me this looks like a good way of comparing these two ordinations.</p>
<p>Clarke &amp; Ainsworth wrote a computer program BIO-ENV giving the name to
  the current function. Presumably BIO-ENV
  was later incorporated in Clarke's PRIMER software (available for
  Windows).  In addition, Clarke &amp; Ainsworth suggested a novel method of
  rank correlation which is not available in the current function.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns an object of class <code>bioenv</code> with a
  <code>summary</code> method.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Clarke, K. R &amp; Ainsworth, M. 1993. A method of linking multivariate
  community structure to environmental variables. <em>Marine Ecology
    Progress Series</em>, 92, 205--219.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>If you want to study the &#8216;significance&#8217; of <code>bioenv</code>
  results, you can use function <code><a href='mantel.html'>mantel</a></code> or
  <code><a href='mantel.html'>mantel.partial</a></code> which use the same definition of
  correlation.  However, <code>bioenv</code> standardizes environmental
  variables depending on the used metric, and you must do the same in
  <code><a href='mantel.html'>mantel</a></code> for comparable results (the standardized data are
  returned as item <code>x</code> in the result object). It is safest to use
  <code>bioenvdist</code> to extract the environmental distances that really
  were used within <code>bioenv</code>. NB., <code>bioenv</code> selects variables
  to maximize the Mantel correlation, and significance tests based on
  <em>a priori</em> selection of variables are biased.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='vegdist.html'>vegdist</a></code>, <code><a href='https://rdrr.io/r/stats/dist.html'>dist</a></code>, <code><a href='https://rdrr.io/r/stats/cor.html'>cor</a></code>
  for underlying routines, <code><a href='monoMDS.html'>monoMDS</a></code> and
  <code><a href='metaMDS.html'>metaMDS</a></code> for ordination, <code><a href='procrustes.html'>procrustes</a></code> for
  Procrustes analysis, <code><a href='procrustes.html'>protest</a></code> for an alternative, and
  <code><a href='rankindex.html'>rankindex</a></code> for studying alternatives to the default
  Bray-Curtis index.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># The method is very slow for large number of possible subsets.</span>
<span class='co'># Therefore only 6 variables in this example.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>varespec</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>varechem</span>)
<span class='no'>sol</span> <span class='kw'>&lt;-</span> <span class='fu'>bioenv</span>(<span class='fu'><a href='decostand.html'>wisconsin</a></span>(<span class='no'>varespec</span>) ~ <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>N</span>) + <span class='no'>P</span> + <span class='no'>K</span> + <span class='no'>Ca</span> + <span class='no'>pH</span> + <span class='no'>Al</span>, <span class='no'>varechem</span>)
<span class='no'>sol</span></div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; bioenv(formula = wisconsin(varespec) ~ log(N) + P + K + Ca +      pH + Al, data = varechem) 
#&gt; 
#&gt; Subset of environmental variables with best correlation to community data.
#&gt; 
#&gt; Correlations:    spearman 
#&gt; Dissimilarities: bray 
#&gt; Metric:          euclidean 
#&gt; 
#&gt; Best model has 3 parameters (max. 6 allowed):
#&gt; P Ca Al
#&gt; with correlation  0.4004806 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>sol</span>)</div><div class='output co'>#&gt;                     size correlation
#&gt; P                      1      0.2513
#&gt; P Al                   2      0.4004
#&gt; P Ca Al                3      0.4005
#&gt; P Ca pH Al             4      0.3619
#&gt; log(N) P Ca pH Al      5      0.3216
#&gt; log(N) P K Ca pH Al    6      0.2822</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Jari Oksanen</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


