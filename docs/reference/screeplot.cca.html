<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Screeplots for Ordination Results and Broken Stick Distributions — screeplot.cca • vegan</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Screeplots for Ordination Results and Broken Stick Distributions — screeplot.cca" />
<meta property="og:description" content="Screeplot methods for plotting variances of ordination axes/components
  and overlaying broken stick distributions. Also, provides alternative
  screeplot methods for princomp and prcomp." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vegandevs/vegan">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Screeplots for Ordination Results and Broken Stick Distributions</h1>
    
    <div class="hidden name"><code>screeplot.cca.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Screeplot methods for plotting variances of ordination axes/components
  and overlaying broken stick distributions. Also, provides alternative
  screeplot methods for <code><a href='https://rdrr.io/r/stats/princomp.html'>princomp</a></code> and <code><a href='https://rdrr.io/r/stats/prcomp.html'>prcomp</a></code>.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for cca</span>
<span class='fu'><a href='https://rdrr.io/r/stats/screeplot.html'>screeplot</a></span>(<span class='no'>x</span>, <span class='kw'>bstick</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"barplot"</span>, <span class='st'>"lines"</span>),
         <span class='kw'>npcs</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span>(<span class='fl'>10</span>, <span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span>(<span class='no'>x</span>$<span class='no'>CCA</span>) <span class='kw'>||</span> <span class='no'>x</span>$<span class='no'>CCA</span>$<span class='no'>rank</span> <span class='kw'>==</span> <span class='fl'>0</span>) <span class='no'>x</span>$<span class='no'>CA</span>$<span class='no'>rank</span> <span class='kw'>else</span> <span class='no'>x</span>$<span class='no'>CCA</span>$<span class='no'>rank</span>),
         <span class='kw'>ptype</span> <span class='kw'>=</span> <span class='st'>"o"</span>, <span class='kw'>bst.col</span> <span class='kw'>=</span> <span class='st'>"red"</span>, <span class='kw'>bst.lty</span> <span class='kw'>=</span> <span class='st'>"solid"</span>,
         <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Component"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Inertia"</span>,
         <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/deparse.html'>deparse</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/substitute.html'>substitute</a></span>(<span class='no'>x</span>)), <span class='kw'>legend</span> <span class='kw'>=</span> <span class='no'>bstick</span>,
         <span class='no'>...</span>)

<span class='co'># S3 method for decorana</span>
<span class='fu'><a href='https://rdrr.io/r/stats/screeplot.html'>screeplot</a></span>(<span class='no'>x</span>, <span class='kw'>bstick</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"barplot"</span>, <span class='st'>"lines"</span>),
         <span class='kw'>npcs</span> <span class='kw'>=</span> <span class='fl'>4</span>,
         <span class='kw'>ptype</span> <span class='kw'>=</span> <span class='st'>"o"</span>, <span class='kw'>bst.col</span> <span class='kw'>=</span> <span class='st'>"red"</span>, <span class='kw'>bst.lty</span> <span class='kw'>=</span> <span class='st'>"solid"</span>,
         <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Component"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Inertia"</span>,
         <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/deparse.html'>deparse</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/substitute.html'>substitute</a></span>(<span class='no'>x</span>)),
         <span class='no'>...</span>)

<span class='co'># S3 method for prcomp</span>
<span class='fu'><a href='https://rdrr.io/r/stats/screeplot.html'>screeplot</a></span>(<span class='no'>x</span>, <span class='kw'>bstick</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"barplot"</span>, <span class='st'>"lines"</span>),
         <span class='kw'>npcs</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span>(<span class='fl'>10</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>x</span>$<span class='no'>sdev</span>)),
         <span class='kw'>ptype</span> <span class='kw'>=</span> <span class='st'>"o"</span>, <span class='kw'>bst.col</span> <span class='kw'>=</span> <span class='st'>"red"</span>, <span class='kw'>bst.lty</span> <span class='kw'>=</span> <span class='st'>"solid"</span>,
         <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Component"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Inertia"</span>,
         <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/deparse.html'>deparse</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/substitute.html'>substitute</a></span>(<span class='no'>x</span>)), <span class='kw'>legend</span> <span class='kw'>=</span> <span class='no'>bstick</span>,
         <span class='no'>...</span>)

<span class='co'># S3 method for princomp</span>
<span class='fu'><a href='https://rdrr.io/r/stats/screeplot.html'>screeplot</a></span>(<span class='no'>x</span>, <span class='kw'>bstick</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"barplot"</span>, <span class='st'>"lines"</span>),
         <span class='kw'>npcs</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span>(<span class='fl'>10</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>x</span>$<span class='no'>sdev</span>)),
         <span class='kw'>ptype</span> <span class='kw'>=</span> <span class='st'>"o"</span>, <span class='kw'>bst.col</span> <span class='kw'>=</span> <span class='st'>"red"</span>, <span class='kw'>bst.lty</span> <span class='kw'>=</span> <span class='st'>"solid"</span>,
         <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Component"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"Inertia"</span>,
         <span class='kw'>main</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/deparse.html'>deparse</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/substitute.html'>substitute</a></span>(<span class='no'>x</span>)), <span class='kw'>legend</span> <span class='kw'>=</span> <span class='no'>bstick</span>,
         <span class='no'>...</span>)

<span class='fu'>bstick</span>(<span class='no'>n</span>, <span class='no'>...</span>)

<span class='co'># S3 method for default</span>
<span class='fu'>bstick</span>(<span class='no'>n</span>, <span class='kw'>tot.var</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>...</span>)

<span class='co'># S3 method for cca</span>
<span class='fu'>bstick</span>(<span class='no'>n</span>, <span class='no'>...</span>)

<span class='co'># S3 method for prcomp</span>
<span class='fu'>bstick</span>(<span class='no'>n</span>, <span class='no'>...</span>)

<span class='co'># S3 method for princomp</span>
<span class='fu'>bstick</span>(<span class='no'>n</span>, <span class='no'>...</span>)

<span class='co'># S3 method for decorana</span>
<span class='fu'>bstick</span>(<span class='no'>n</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>an object from which the component variances can be determined.</p></td>
    </tr>
    <tr>
      <th>bstick</th>
      <td><p>logical; should the broken stick distribution be drawn?</p></td>
    </tr>
    <tr>
      <th>npcs</th>
      <td><p>the number of components to be plotted.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>the type of plot.</p></td>
    </tr>
    <tr>
      <th>ptype</th>
      <td><p>if <code>type == "lines"</code> or <code>bstick = TRUE</code>, a
    character indicating the type of plotting used for the lines;
    actually any of the <code>type</code>s as in <code><a href='https://rdrr.io/r/graphics/plot.default.html'>plot.default</a></code>.</p></td>
    </tr>
    <tr>
      <th>bst.col, bst.lty</th>
      <td><p>the colour and line type used to draw the
    broken stick distribution.</p></td>
    </tr>
    <tr>
      <th>xlab, ylab, main</th>
      <td><p>graphics parameters.</p></td>
    </tr>
    <tr>
      <th>legend</th>
      <td><p>logical; draw a legend?</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>an object from which the variances can be extracted or the
    number of variances (components) in the case of
    <code>bstick.default</code>.</p></td>
    </tr>
    <tr>
      <th>tot.var</th>
      <td><p>the total variance to be split.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>arguments passed to other methods.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The functions provide screeplots for most ordination methods in
  <span class="pkg">vegan</span> and enhanced versions with broken stick for
  <code><a href='https://rdrr.io/r/stats/prcomp.html'>prcomp</a></code> and <code><a href='https://rdrr.io/r/stats/princomp.html'>princomp</a></code>.</p>
<p>Function <code>bstick</code> gives the brokenstick values which are ordered
  random proportions, defined as  \(p_i = (tot/n) \sum_{x=i}^n 
    (1/x)\) (Legendre &amp; Legendre 2012), where
  \(tot\) is the total  and \(n\) is the number of brokenstick
  components (cf. <code><a href='radfit.html'>radfit</a></code>).  Broken stick has
  been recommended as a stopping rule in principal component analysis
  (Jackson 1993): principal components should be retained as long as
  observed eigenvalues are higher than corresponding random broken stick
  components.</p>
<p>The <code>bstick</code> function is generic. The default needs the number of
  components and the total, and specific methods extract this
  information from ordination results.  There also is a <code>bstick</code>
  method for <code><a href='cca.html'>cca</a></code>.  However, the broken stick model is not
  strictly valid for correspondence analysis (CA), because eigenvalues
  of CA are defined to be \(\leq 1\), whereas brokenstick
  components have no such restrictions. The brokenstick components are not
  available for <code><a href='decorana.html'>decorana</a></code> where the sum of eigenvalues
  (total inertia) is unknown, and the eigenvalues of single axes are not
  additive in detrended analysis.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Function <code>screeplot</code> draws a plot on the currently active device, 
  and returns invisibly the <code><a href='https://rdrr.io/r/grDevices/xy.coords.html'>xy.coords</a></code> of the points or
  bars for the eigenvalues.</p>
<p>Function <code>bstick</code> returns a numeric vector of broken stick
  components.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Jackson, D. A. (1993). Stopping rules in principal components
  analysis: a comparison of heuristical and statistical
  approaches. <em>Ecology</em> 74, 2204--2214.</p>
<p>Legendre, P. and Legendre, L. (2012) <em>Numerical Ecology</em>. 3rd English
  ed. Elsevier.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='cca.html'>cca</a></code>, <code><a href='decorana.html'>decorana</a></code>, <code><a href='https://rdrr.io/r/stats/princomp.html'>princomp</a></code> and
  <code><a href='https://rdrr.io/r/stats/prcomp.html'>prcomp</a></code> for the ordination functions, and
  <code><a href='https://rdrr.io/r/stats/screeplot.html'>screeplot</a></code> for the stock version.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>varespec</span>)
<span class='no'>vare.pca</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='cca.html'>rda</a></span>(<span class='no'>varespec</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'>bstick</span>(<span class='no'>vare.pca</span>)</div><div class='output co'>#&gt;       PC1       PC2       PC3       PC4       PC5       PC6       PC7       PC8 
#&gt; 7.1438620 5.2308185 4.2742968 3.6366156 3.1583548 2.7757461 2.4569055 2.1836136 
#&gt;       PC9      PC10      PC11      PC12      PC13      PC14      PC15      PC16 
#&gt; 1.9444831 1.7319228 1.5406184 1.3667054 1.2072851 1.0601279 0.9234819 0.7959457 
#&gt;      PC17      PC18      PC19      PC20      PC21      PC22      PC23 
#&gt; 0.6763805 0.5638485 0.4575683 0.3568818 0.2612296 0.1701323 0.0831758 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/screeplot.html'>screeplot</a></span>(<span class='no'>vare.pca</span>, <span class='kw'>bstick</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"lines"</span>)</div><div class='img'><img src='screeplot.cca-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Gavin L. Simpson</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


