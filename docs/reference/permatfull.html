<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Matrix Permutation Algorithms for Presence-Absence and Count Data — permat • vegan</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Matrix Permutation Algorithms for Presence-Absence and Count Data — permat" />
<meta property="og:description" content="Individual (for count data) or incidence (for
presence-absence data) based null models can be generated for
community level simulations. Options for preserving characteristics of
the original matrix (rows/columns sums, matrix fill) and
restricted permutations (based on strata) are discussed in the
Details section." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vegandevs/vegan">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Matrix Permutation Algorithms for Presence-Absence and Count Data</h1>
    
    <div class="hidden name"><code>permatfull.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Individual (for count data) or incidence (for
presence-absence data) based null models can be generated for
community level simulations. Options for preserving characteristics of
the original matrix (rows/columns sums, matrix fill) and
restricted permutations (based on strata) are discussed in the
Details section.</p>
    </div>

    <pre class="usage"><span class='fu'>permatfull</span>(<span class='no'>m</span>, <span class='kw'>fixedmar</span> <span class='kw'>=</span> <span class='st'>"both"</span>, <span class='kw'>shuffle</span> <span class='kw'>=</span> <span class='st'>"both"</span>, <span class='kw'>strata</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
    <span class='kw'>mtype</span> <span class='kw'>=</span> <span class='st'>"count"</span>, <span class='kw'>times</span> <span class='kw'>=</span> <span class='fl'>99</span>, <span class='no'>...</span>)
<span class='fu'>permatswap</span>(<span class='no'>m</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"quasiswap"</span>, <span class='kw'>fixedmar</span><span class='kw'>=</span><span class='st'>"both"</span>, <span class='kw'>shuffle</span> <span class='kw'>=</span> <span class='st'>"both"</span>,
    <span class='kw'>strata</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>mtype</span> <span class='kw'>=</span> <span class='st'>"count"</span>, <span class='kw'>times</span> <span class='kw'>=</span> <span class='fl'>99</span>,
    <span class='kw'>burnin</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>thin</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>...</span>)
<span class='co'># S3 method for permat</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>x</span>, <span class='kw'>digits</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='no'>...</span>)
<span class='co'># S3 method for permat</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)
<span class='co'># S3 method for summary.permat</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>x</span>, <span class='kw'>digits</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='no'>...</span>)
<span class='co'># S3 method for permat</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>x</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"bray"</span>, <span class='no'>ylab</span>, <span class='no'>xlab</span>, <span class='no'>col</span>, <span class='no'>lty</span>,
    <span class='kw'>lowess</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>text</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)
<span class='co'># S3 method for permat</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='no'>x</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"bray"</span>, <span class='no'>...</span>)
<span class='co'># S3 method for permat</span>
<span class='fu'><a href='https://rdrr.io/r/stats/ts.html'>as.ts</a></span>(<span class='no'>x</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"bray"</span>, <span class='no'>...</span>)
<span class='co'># S3 method for permat</span>
<span class='fu'>as.mcmc</span>(<span class='no'>x</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>m</th>
      <td><p>A community data matrix with plots (samples) as rows and
    species (taxa) as columns.</p></td>
    </tr>
    <tr>
      <th>fixedmar</th>
      <td><p>character, stating which of the row/column sums should
    be preserved (<code>"none", "rows", "columns", "both"</code>).</p></td>
    </tr>
    <tr>
      <th>strata</th>
      <td><p>Numeric vector or factor with length same as
    <code><a href='https://rdrr.io/r/base/nrow.html'>nrow(m)</a></code> for grouping rows within strata for restricted
    permutations. Unique values or levels are used.</p></td>
    </tr>
    <tr>
      <th>mtype</th>
      <td><p>Matrix data type, either <code>"count"</code> for count data,
    or <code>"prab"</code> for presence-absence type incidence data.</p></td>
    </tr>
    <tr>
      <th>times</th>
      <td><p>Number of permuted matrices.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Character for method used for the swap algorithm
    (<code>"swap"</code>, <code>"tswap"</code>, <code>"quasiswap"</code>,
    <code>"backtrack"</code>) as described for function
    <code><a href='commsim.html'>make.commsim</a></code>. If <code>mtype="count"</code> the
    <code>"quasiswap"</code>, <code>"swap"</code>, <code>"swsh"</code> and
    <code>"abuswap"</code> methods are available (see details).</p></td>
    </tr>
    <tr>
      <th>shuffle</th>
      <td><p>Character, indicating whether individuals
    (<code>"ind"</code>), samples (<code>"samp"</code>) or both (<code>"both"</code>)
    should be shuffled, see details.</p></td>
    </tr>
    <tr>
      <th>burnin</th>
      <td><p>Number of null communities discarded before proper
    analysis in sequential (<code>"swap", "tswap"</code>) methods.</p></td>
    </tr>
    <tr>
      <th>thin</th>
      <td><p>Number of discarded permuted matrices between two
    evaluations in sequential (<code>"swap", "tswap"</code>) methods.</p></td>
    </tr>
    <tr>
      <th>x, object</th>
      <td><p>Object of class <code>"permat"</code></p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>Number of digits used for rounding.</p></td>
    </tr>
    <tr>
      <th>ylab, xlab, col, lty</th>
      <td><p>graphical parameters for the <code>plot</code>
    method.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Character, type of plot to be displayed: <code>"bray"</code> for
    Bray-Curtis dissimilarities, <code>"chisq"</code> for Chi-squared values.</p></td>
    </tr>
    <tr>
      <th>lowess, plot, text</th>
      <td><p>Logical arguments for the <code>plot</code>
    method, whether a locally weighted regression curve should be drawn,
    the plot should be drawn, and statistic values should be printed on
    the plot.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments passed to <code><a href='nullmodel.html'>simulate.nullmodel</a></code> 
    or methods.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function <code>permatfull</code> is useful when matrix fill is
  allowed to vary, and matrix type is <code>count</code>.  The <code>fixedmar</code>
  argument is used to set constraints for permutation.  If <code>none</code>
  of the margins are fixed, cells are randomised within the matrix.  If
  <code>rows</code> or <code>columns</code> are fixed, cells within rows or columns
  are randomised, respectively.  If <code>both</code> margins are fixed, the
  <code><a href='https://rdrr.io/r/stats/r2dtable.html'>r2dtable</a></code> function is used that is based on Patefield's
  (1981) algorithm. For presence absence data, matrix fill should be
  necessarily fixed, and <code>permatfull</code> is a wrapper for the function
  <code><a href='commsim.html'>make.commsim</a></code>. The <code>r00, r0, c0, quasiswap</code>
  algorithms of <code><a href='commsim.html'>make.commsim</a></code> are used for <code>"none",
  "rows", "columns", "both"</code> values of the <code>fixedmar</code> argument,
  respectively</p>
<p>The <code>shuffle</code> argument only have effect if the <code>mtype =
  "count"</code> and <code>permatfull</code> function is used with <code>"none",
  "rows", "columns"</code> values of <code>fixedmar</code>. All other cases for
  count data are individual based randomisations. The <code>"samp"</code> and
  <code>"both"</code> options result fixed matrix fill. The <code>"both"</code>
  option means that individuals are shuffled among non zero cells
  ensuring that there are no cell with zeros as a result, then cell
  (zero and new valued cells) are shuffled.</p>
<p>The function <code>permatswap</code> is useful when with matrix fill
  (i.e. the proportion of empty cells) and row/columns sums should be
  kept constant. <code>permatswap</code> uses different kinds of swap
  algorithms, and row and columns sums are fixed in all cases.  For
  presence-absence data, the <code>swap</code> and <code>tswap</code> methods of
  <code><a href='commsim.html'>make.commsim</a></code> can be used.  For count data, a special
  swap algorithm ('swapcount') is implemented that results in permuted
  matrices with fixed marginals and matrix fill at the same time.</p>
<p>The 'quasiswapcount' algorithm (<code>method="quasiswap"</code> and
  <code>mtype="count"</code>) uses the same trick as Carsten Dormann's
  <code>swap.web</code> function in the package
  <span class="pkg">bipartite</span>. First, a random matrix is generated by the
  <code><a href='https://rdrr.io/r/stats/r2dtable.html'>r2dtable</a></code> function retaining row and column sums. Then
  the original matrix fill is reconstructed by sequential steps to
  increase or decrease matrix fill in the random matrix. These steps are
  based on swapping 2x2 submatrices (see 'swapcount' algorithm for
  details) to maintain row and column totals. This algorithm generates
  independent matrices in each step, so <code>burnin</code> and <code>thin</code>
  arguments are not considered. This is the default method, because this
  is not sequential (as <code>swapcount</code> is) so independence of subsequent
  matrices does not have to be checked.</p>
<p>The <code>swapcount</code> algorithm (<code>method="swap"</code> and
  <code>mtype="count"</code>) tries to find 2x2 submatrices (identified by 2
  random row and 2 random column indices), that can be swapped in order
  to leave column and row totals and fill unchanged. First, the
  algorithm finds the largest value in the submatrix that can be swapped
  (\(d\)) and whether in diagonal or antidiagonal way. Submatrices
  that contain values larger than zero in either diagonal or
  antidiagonal position can be swapped. Swap means that the values in
  diagonal or antidiagonal positions are decreased by \(d\), while
  remaining cells are increased by \(d\). A swap is made only if fill
  doesn't change. This algorithm is sequential, subsequent matrices are
  not independent, because swaps modify little if the matrix is
  large. In these cases many burnin steps and thinning is needed to get
  independent random matrices. Although this algorithm is implemented in
  C, large burnin and thin values can slow it down
  considerably. WARNING: according to simulations, this algorithm seems
  to be biased and non random, thus its use should be avoided!</p>
<p>The algorithm <code>"swsh"</code> in the function <code>permatswap</code> is a
  hybrid algorithm. First, it makes binary quasiswaps to keep row and
  column incidences constant, then non-zero values are modified
  according to the <code>shuffle</code> argument (only <code>"samp"</code> and
  <code>"both"</code> are available in this case, because it is applied only
  on non-zero values). It also recognizes the <code>fixedmar</code>
  argument which cannot be <code>"both"</code> (<span class="pkg">vegan</span> versions &lt;= 2.0
  had this algorithm with <code>fixedmar = "none"</code>).</p>
<p>The algorithm <code>"abuswap"</code> produces two kinds of null models
  (based on <code>fixedmar="columns"</code> or <code>fixedmar="rows"</code>) as
  described in Hardy (2008; randomization scheme 2x and 3x,
  respectively).  These preserve column and row occurrences, and column
  or row sums at the same time. (Note that similar constraints
  can be achieved by the non sequential <code>"swsh"</code> algorithm
  with <code>fixedmar</code> argument set to <code>"columns"</code> or
  <code>"rows"</code>, respectively.)</p>
<p>Constraints on row/column sums, matrix fill, total sum and sums within
  strata can be checked by the <code>summary</code> method. <code>plot</code> method
  is for visually testing the randomness of the permuted matrices,
  especially for the sequential swap algorithms. If there are any
  tendency in the graph, higher <code>burnin</code> and <code>thin</code> values can
  help for sequential methods.  New lines can be added to existing plot
  with the <code>lines</code> method.</p>
<p>Unrestricted and restricted permutations: if <code>strata</code> is
  <code>NULL</code>, functions perform unrestricted permutations. Otherwise,
  it is used for restricted permutations. Each strata should contain at
  least 2 rows in order to perform randomization (in case of low row
  numbers, swap algorithms can be rather slow). If the design is not
  well balanced (i.e. same number of observations within each stratum),
  permuted matrices may be biased because same constraints are forced on
  submatrices of different dimensions. This often means, that the number
  of potential permutations will decrease with their dimensions.  So the
  more constraints we put, the less randomness can be expected.</p>
<p>The <code>plot</code> method is useful for graphically testing for trend and
  independence of permuted matrices. This is especially important when
  using sequential algorithms (<code>"swap", "tswap", "abuswap"</code>).</p>
<p>The <code>as.ts</code> method can be used to extract Bray-Curtis
  dissimilarities or Chi-squared values as time series. This can further
  used in testing independence (see Examples). The method <code>as.mcmc</code>
  is useful for accessing diagnostic tools available in the <span class="pkg">coda</span>
  package.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Functions <code>permatfull</code> and <code>permatswap</code> return an
  object of class <code>"permat"</code> containing the the function call
  (<code>call</code>), the original data matrix used for permutations
  (<code>orig</code>) and a list of permuted matrices with length <code>times</code>
  (<code>perm</code>).</p>
<p>The <code>summary</code> method returns various statistics as a list
  (including mean Bray-Curtis dissimilarities calculated pairwise among
  original and permuted matrices, Chi-square statistics, and check
  results of the constraints; see Examples). Note that when
  <code>strata</code> is used in the original call, summary calculation may
  take longer.</p>
<p>The <code>plot</code> creates a plot as a side effect.</p>
<p>The <code>as.ts</code> method returns an object of class <code>"ts"</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Original references for presence-absence algorithms are
  given on help page of <code><a href='commsim.html'>make.commsim</a></code>.</p>
<p>Hardy, O. J. (2008) Testing the spatial phylogenetic structure of
  local communities: statistical performances of different null models
  and test statistics on a locally neutral community. Journal of Ecology
  96, 914--926.</p>
<p>Patefield, W. M. (1981) Algorithm AS159. An efficient method of
  generating r x c tables with given row and column totals.  
  Applied Statistics 30, 91--97.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>For other functions to permute matrices:
<code><a href='commsim.html'>make.commsim</a></code>, <code><a href='https://rdrr.io/r/stats/r2dtable.html'>r2dtable</a></code>,
<code><a href='https://rdrr.io/r/base/sample.html'>sample</a></code>, <code>swap.web</code>.</p>
<p>For the use of these permutation algorithms: <code><a href='oecosimu.html'>oecosimu</a></code>,
<code><a href='adipart.html'>adipart</a></code>, <code><a href='adipart.html'>hiersimu</a></code>.</p>
<p>For time-series diagnostics: <code><a href='https://rdrr.io/r/stats/box.test.html'>Box.test</a></code>,
<code><a href='https://rdrr.io/r/stats/lag.plot.html'>lag.plot</a></code>, <code><a href='https://rdrr.io/r/stats/tsdiag.html'>tsdiag</a></code>, <code><a href='https://rdrr.io/r/stats/ar.html'>ar</a></code>,
<code><a href='https://rdrr.io/r/stats/arima.html'>arima</a></code></p>
<p>For underlying low level implementation:
<code><a href='commsim.html'>commsim</a></code> and <code><a href='nullmodel.html'>nullmodel</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## A simple artificial community data matrix.</span>
<span class='no'>m</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(
    <span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>2</span>,<span class='fl'>0</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,
    <span class='fl'>0</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,
    <span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>0</span>,<span class='fl'>3</span>,
    <span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>4</span>,<span class='fl'>3</span>
    ), <span class='fl'>4</span>, <span class='fl'>6</span>, <span class='kw'>byrow</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='co'>## Using the quasiswap algorithm to create a </span>
<span class='co'>## list of permuted matrices, where</span>
<span class='co'>## row/columns sums and matrix fill are preserved:</span>
<span class='no'>x1</span> <span class='kw'>&lt;-</span> <span class='fu'>permatswap</span>(<span class='no'>m</span>, <span class='st'>"quasiswap"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>x1</span>)</div><div class='output co'>#&gt; Summary of object of class 'permat'
#&gt; 
#&gt; Call: permatswap(m = m, method = "quasiswap")
#&gt; 
#&gt; Matrix type: count 
#&gt; Permutation type: swap
#&gt; Method: quasiswap_count, burnin: 0, thin: 1
#&gt; Restricted: FALSE 
#&gt; Fixed margins: both
#&gt; 
#&gt; Matrix dimensions: 4 rows, 6 columns
#&gt; Sum of original matrix: 30
#&gt; Fill of original matrix: 0.62
#&gt; Number of permuted matrices: 99 
#&gt; 
#&gt; Matrix sums retained: 100 %
#&gt; Matrix fill retained: 100 %
#&gt; Row sums retained:    100 %
#&gt; Column sums retained: 100 %
#&gt; Row incidences retained:    1.01 %
#&gt; Column incidences retained: 13.13 %
#&gt; 
#&gt; Bray-Curtis dissimilarities among original and permuted matrices:
#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;  0.2000  0.3667  0.4333  0.4145  0.4667  0.6000 
#&gt; 
#&gt; Chi-squared for original matrix: 18.55
#&gt; Chi-squared values among expected and permuted matrices:
#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;   16.27   19.59   21.10   21.51   23.36   31.69 </div><div class='input'><span class='co'>## Unrestricted permutation retaining</span>
<span class='co'>## row/columns sums but not matrix fill:</span>
<span class='no'>x2</span> <span class='kw'>&lt;-</span> <span class='fu'>permatfull</span>(<span class='no'>m</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>x2</span>)</div><div class='output co'>#&gt; Summary of object of class 'permat'
#&gt; 
#&gt; Call: permatfull(m = m)
#&gt; 
#&gt; Matrix type: count 
#&gt; Permutation type: full
#&gt; Method: r2dtable
#&gt; Restricted: FALSE 
#&gt; Fixed margins: both
#&gt; 
#&gt; Matrix dimensions: 4 rows, 6 columns
#&gt; Sum of original matrix: 30
#&gt; Fill of original matrix: 0.62
#&gt; Number of permuted matrices: 99 
#&gt; 
#&gt; Matrix sums retained: 100 %
#&gt; Matrix fill retained: 16.16 %
#&gt; Row sums retained:    100 %
#&gt; Column sums retained: 100 %
#&gt; Row incidences retained:    0 %
#&gt; Column incidences retained: 1.01 %
#&gt; 
#&gt; Bray-Curtis dissimilarities among original and permuted matrices:
#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;  0.2000  0.3333  0.3667  0.3865  0.4333  0.6333 
#&gt; 
#&gt; Chi-squared for original matrix: 18.55
#&gt; Chi-squared values among expected and permuted matrices:
#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;   7.824  12.046  15.660  16.015  19.413  28.132 </div><div class='input'><span class='co'>## Unrestricted permutation of presence-absence type</span>
<span class='co'>## not retaining row/columns sums:</span>
<span class='no'>x3</span> <span class='kw'>&lt;-</span> <span class='fu'>permatfull</span>(<span class='no'>m</span>, <span class='st'>"none"</span>, <span class='kw'>mtype</span><span class='kw'>=</span><span class='st'>"prab"</span>)
<span class='no'>x3</span>$<span class='no'>orig</span>  <span class='co'>## note: original matrix is binarized!</span></div><div class='output co'>#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]
#&gt; [1,]    1    1    1    0    1    1
#&gt; [2,]    0    1    1    0    1    1
#&gt; [3,]    0    0    1    1    0    1
#&gt; [4,]    0    0    0    1    1    1</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>x3</span>)</div><div class='output co'>#&gt; Summary of object of class 'permat'
#&gt; 
#&gt; Call: permatfull(m = m, fixedmar = "none", mtype = "prab")
#&gt; 
#&gt; Matrix type: prab 
#&gt; Permutation type: full
#&gt; Method: r00
#&gt; Restricted: FALSE 
#&gt; Fixed margins: none
#&gt; Individuals and samples are shuffled
#&gt; 
#&gt; Matrix dimensions: 4 rows, 6 columns
#&gt; Sum of original matrix: 15
#&gt; Fill of original matrix: 0.62
#&gt; Number of permuted matrices: 99 
#&gt; 
#&gt; Matrix sums retained: 100 %
#&gt; Matrix fill retained: 100 %
#&gt; Row sums retained:    4.04 %
#&gt; Column sums retained: 0 %
#&gt; Row incidences retained:    4.04 %
#&gt; Column incidences retained: 0 %
#&gt; 
#&gt; Bray-Curtis dissimilarities among original and permuted matrices:
#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;  0.2000  0.3333  0.4000  0.3852  0.4000  0.5333 
#&gt; 
#&gt; Chi-squared for original matrix: 8.4
#&gt; Chi-squared values among expected and permuted matrices:
#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;   8.812  13.583  15.208  15.295  17.083  21.896 </div><div class='input'><span class='co'>## Restricted permutation,</span>
<span class='co'>## check sums within strata:</span>
<span class='no'>x4</span> <span class='kw'>&lt;-</span> <span class='fu'>permatfull</span>(<span class='no'>m</span>, <span class='kw'>strata</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>x4</span>)</div><div class='output co'>#&gt; Summary of object of class 'permat'
#&gt; 
#&gt; Call: permatfull(m = m, strata = c(1, 1, 2, 2))
#&gt; 
#&gt; Matrix type: count 
#&gt; Permutation type: full
#&gt; Method: r2dtable
#&gt; Restricted: TRUE 
#&gt; Fixed margins: both
#&gt; 
#&gt; Matrix dimensions: 4 rows, 6 columns
#&gt; Sum of original matrix: 30
#&gt; Fill of original matrix: 0.62
#&gt; Number of permuted matrices: 99 
#&gt; 
#&gt; Matrix sums retained: 100 %
#&gt; Matrix fill retained: 38.38 %
#&gt; Row sums retained:    100 %
#&gt; Column sums retained: 100 %
#&gt; Row incidences retained:    1.01 %
#&gt; Column incidences retained: 2.02 %
#&gt; Sums within strata retained: 100 %
#&gt; 
#&gt; Bray-Curtis dissimilarities among original and permuted matrices:
#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt; 0.06667 0.20000 0.26667 0.23502 0.26667 0.46667 
#&gt; 
#&gt; Chi-squared for original matrix: 18.55
#&gt; Chi-squared values among expected and permuted matrices:
#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;   14.21   18.68   21.05   22.09   25.26   36.50 </div><div class='input'>
<span class='co'>## NOTE: 'times' argument usually needs to be &gt;= 99</span>
<span class='co'>## here much lower value is used for demonstration</span>

<span class='co'>## Not sequential algorithm</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>BCI</span>)
<span class='no'>a</span> <span class='kw'>&lt;-</span> <span class='fu'>permatswap</span>(<span class='no'>BCI</span>, <span class='st'>"quasiswap"</span>, <span class='kw'>times</span><span class='kw'>=</span><span class='fl'>19</span>)
<span class='co'>## Sequential algorithm</span>
<span class='no'>b</span> <span class='kw'>&lt;-</span> <span class='fu'>permatswap</span>(<span class='no'>BCI</span>, <span class='st'>"abuswap"</span>, <span class='kw'>fixedmar</span><span class='kw'>=</span><span class='st'>"col"</span>,
    <span class='kw'>burnin</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>thin</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>times</span><span class='kw'>=</span><span class='fl'>19</span>)
<span class='no'>opar</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>2</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>a</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Not sequential"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>b</span>, <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Sequential"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>a</span>, <span class='st'>"chisq"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>b</span>, <span class='st'>"chisq"</span>)</div><div class='img'><img src='permatfull-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='no'>opar</span>)
<span class='co'>## Extract Bray-Curtis dissimilarities</span>
<span class='co'>## as time series</span>
<span class='no'>bc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/ts.html'>as.ts</a></span>(<span class='no'>b</span>)
<span class='co'>## Lag plot</span>
<span class='fu'><a href='https://rdrr.io/r/stats/lag.plot.html'>lag.plot</a></span>(<span class='no'>bc</span>)</div><div class='img'><img src='permatfull-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## First order autoregressive model</span>
<span class='no'>mar</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/arima.html'>arima</a></span>(<span class='no'>bc</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>))
<span class='no'>mar</span></div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; arima(x = bc, order = c(1, 0, 0))
#&gt; 
#&gt; Coefficients:
#&gt;          ar1  intercept
#&gt;       0.9915     0.1850
#&gt; s.e.  0.0120     0.1374
#&gt; 
#&gt; sigma^2 estimated as 0.000346:  log likelihood = 46.71,  aic = -87.42</div><div class='input'><span class='co'>## Ljung-Box test of residuals</span>
<span class='fu'><a href='https://rdrr.io/r/stats/box.test.html'>Box.test</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/residuals.html'>residuals</a></span>(<span class='no'>mar</span>))</div><div class='output co'>#&gt; 
#&gt; 	Box-Pierce test
#&gt; 
#&gt; data:  residuals(mar)
#&gt; X-squared = 0.35725, df = 1, p-value = 0.55
#&gt; </div><div class='input'><span class='co'>## Graphical diagnostics</span>
<span class='fu'><a href='https://rdrr.io/r/stats/tsdiag.html'>tsdiag</a></span>(<span class='no'>mar</span>)</div><div class='img'><img src='permatfull-3.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Péter Sólymos,
<a href='mailto:solymos@ualberta.ca'>solymos@ualberta.ca</a> and Jari Oksanen</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


