<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Dispersion-based weighting of species counts — dispweight • vegan</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Dispersion-based weighting of species counts — dispweight" />
<meta property="og:description" content="Transform abundance data downweighting species that are 
  overdispersed to the Poisson error." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegan</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FAQ-vegan.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vegandevs/vegan">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Dispersion-based weighting of species counts</h1>
    
    <div class="hidden name"><code>dispweight.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Transform abundance data downweighting species that are 
  overdispersed to the Poisson error.</p>
    </div>

    <pre class="usage"><span class='fu'>dispweight</span>(<span class='no'>comm</span>, <span class='no'>groups</span>, <span class='kw'>nsimul</span> <span class='kw'>=</span> <span class='fl'>999</span>, <span class='kw'>nullmodel</span> <span class='kw'>=</span> <span class='st'>"c0_ind"</span>,
    <span class='kw'>plimit</span> <span class='kw'>=</span> <span class='fl'>0.05</span>)
<span class='fu'>gdispweight</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='kw'>plimit</span> <span class='kw'>=</span> <span class='fl'>0.05</span>)
<span class='co'># S3 method for dispweight</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>comm</th>
      <td><p>Community data matrix.</p></td>
    </tr>
    <tr>
      <th>groups</th>
      <td><p>Factor describing the group structure. If missing, all 
     sites are regarded as belonging to one group. <code>NA</code> values are 
     not allowed.</p></td>
    </tr>
    <tr>
      <th>nsimul</th>
      <td><p>Number of simulations.</p></td>
    </tr>
    <tr>
      <th>nullmodel</th>
      <td><p>The <code><a href='nullmodel.html'>nullmodel</a></code> used in
    <code><a href='commsim.html'>commsim</a></code> within <code>groups</code>. The default
    follows Clarke et al. (2006).</p></td>
    </tr>
    <tr>
      <th>plimit</th>
      <td><p>Downweight species if their \(p\)-value is at or
     below this limit.</p></td>
    </tr>
    <tr>
      <th>formula, data</th>
      <td><p>Formula where the left-hand side is the
    community data frame and right-hand side gives the explanatory
    variables. The explanatory variables are found in the data frame
    given in <code>data</code> or in the parent frame.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>Result object from <code>dispweight</code> or
    <code>gdispweight</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other parameters passed to functions.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    

<p>The dispersion index (\(D\)) is calculated as ratio between variance
and expected value for each species.  If the species abundances follow
Poisson distribution, expected dispersion is \(E(D) = 1\), and if
\(D &gt; 1\), the species is overdispersed. The inverse \(1/D\) can
be used to downweight species abundances.  Species are only
downweighted when overdispersion is judged to be statistically
significant (Clarke et al. 2006).</p>
<p>Function <code>dispweight</code> implements the original procedure of Clarke
et al. (2006). Only one factor can be used to group the sites and to
find the species means. The significance of overdispersion is assessed
freely distributing individuals of each species within factor
levels. This is achieved by using <code><a href='nullmodel.html'>nullmodel</a></code>
<code>"c0_ind"</code> (which accords to Clarke et al. 2006), but other
nullmodels can be used, though they may not be meaningful (see
<code><a href='commsim.html'>commsim</a></code> for alternatives). If a species is absent in
some factor level, the whole level is ignored in calculation of
overdispersion, and the number of degrees of freedom can vary among
species. The reduced number of degrees of freedom is used as a divisor
for overdispersion \(D\), and such species have higher dispersion
and hence lower weights in transformation.</p>
<p>Function <code>gdispweight</code> is a generalized parametric version of
<code>dispweight</code>. The function is based on <code><a href='https://rdrr.io/r/stats/glm.html'>glm</a></code> with
<code><a href='https://rdrr.io/r/stats/family.html'>quasipoisson</a></code> error <code><a href='https://rdrr.io/r/stats/family.html'>family</a></code>. Any
<code><a href='https://rdrr.io/r/stats/glm.html'>glm</a></code> model can be used, including several factors or
continuous covariates. Function <code>gdispweight</code> uses the same test
statistic as <code>dispweight</code> (Pearson Chi-square), but it does not
ignore factor levels where species is absent, and the number of
degrees of freedom is equal for all species. Therefore transformation
weights can be higher than in <code>dispweight</code>. The
<code>gdispweight</code> function evaluates the significance of
overdispersion parametrically from Chi-square distribution
(<code><a href='https://rdrr.io/r/stats/Chisquare.html'>pchisq</a></code>).</p>
<p>Functions <code>dispweight</code> and <code>gdispweight</code> transform data, but
they add information on overdispersion and weights as attributes of
the result. The <code>summary</code> can be used to extract and print that
information.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Function returns transformed data with the following new attributes:</p>
<dt>D</dt><dd><p>Dispersion statistic.</p></dd>
    <dt>df</dt><dd><p>Degrees of freedom for each species.</p></dd>
    <dt>p</dt><dd><p>\(p\)-value of the Dispersion statistic \(D\).</p></dd>
    <dt>weights</dt><dd><p>weights applied to community data.</p></dd>
    <dt>nsimul</dt><dd><p>Number of simulations used to assess the \(p\)-value,
      or <code>NA</code> when simulations were not performed.</p></dd>
    <dt>nullmodel</dt><dd><p>The name of <code><a href='commsim.html'>commsim</a></code> null model, or
      <code>NA</code> when simulations were not performed.</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Clarke, K. R., M. G. Chapman, P. J. Somerfield, and
H. R. Needham. 2006. Dispersion-based weighting of species counts in
assemblage analyses. <em>Marine Ecology Progress Series</em>, 320,
11–27.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>mite</span>, <span class='no'>mite.env</span>)
<span class='co'>## dispweight and its summary</span>
<span class='no'>mite.dw</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span>(<span class='no'>mite.env</span>, <span class='fu'>dispweight</span>(<span class='no'>mite</span>, <span class='no'>Shrub</span>, <span class='kw'>nsimul</span> <span class='kw'>=</span> <span class='fl'>99</span>))
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>mite.dw</span>)</div><div class='output co'>#&gt;          Dispersion    Weight Df Pr(Disp.)   
#&gt; Brachy       9.6908 0.1031909 67      0.01 **
#&gt; PHTH         3.2809 0.3047900 49      0.01 **
#&gt; HPAV         6.5263 0.1532264 67      0.01 **
#&gt; RARD         6.0477 0.1653525 49      0.01 **
#&gt; SSTR         2.2619 0.4421053 49      0.01 **
#&gt; Protopl      5.4229 0.1844031 49      0.01 **
#&gt; MEGR         4.5354 0.2204860 67      0.01 **
#&gt; MPRO         1.2687 0.7882353 67      0.05 * 
#&gt; TVIE         2.5956 0.3852706 67      0.01 **
#&gt; HMIN        10.0714 0.0992906 67      0.01 **
#&gt; HMIN2        7.5674 0.1321466 49      0.01 **
#&gt; NPRA         2.6743 0.3739344 67      0.01 **
#&gt; TVEL         9.6295 0.1038474 49      0.01 **
#&gt; ONOV        11.3628 0.0880064 67      0.01 **
#&gt; SUCT         8.7372 0.1144533 67      0.01 **
#&gt; LCIL       129.4436 0.0077254 67      0.01 **
#&gt; Oribatl1     4.1250 0.2424248 67      0.01 **
#&gt; Ceratoz1     1.7150 0.5830768 67      0.01 **
#&gt; PWIL         2.2943 0.4358538 67      0.01 **
#&gt; Galumna1     2.8777 0.3474943 49      0.01 **
#&gt; Stgncrs2     3.8242 0.2614953 49      0.01 **
#&gt; HRUF         1.7575 0.5690021 67      0.01 **
#&gt; Trhypch1    14.9225 0.0670128 67      0.01 **
#&gt; PPEL         1.3628 1.0000000 49      0.10 . 
#&gt; NCOR         2.5875 0.3864771 67      0.01 **
#&gt; SLAT         2.7857 0.3589744 49      0.01 **
#&gt; FSET         4.8901 0.2044944 49      0.01 **
#&gt; Lepidzts     1.6577 0.6032360 49      0.01 **
#&gt; Eupelops     1.4611 0.6844033 67      0.03 * 
#&gt; Miniglmn     1.6505 0.6058733 49      0.01 **
#&gt; LRUG        12.0658 0.0828790 67      0.01 **
#&gt; PLAG2        3.2403 0.3086090 67      0.01 **
#&gt; Ceratoz3     3.5125 0.2846947 67      0.01 **
#&gt; Oppiminu     3.1680 0.3156525 67      0.01 **
#&gt; Trimalc2    10.5927 0.0944046 67      0.01 **
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; Based on 99 simulations on 'c0_ind' nullmodel</div><div class='input'><span class='co'>## generalized dispersion weighting</span>
<span class='no'>mite.dw</span> <span class='kw'>&lt;-</span> <span class='fu'>gdispweight</span>(<span class='no'>mite</span> ~ <span class='no'>Shrub</span> + <span class='no'>WatrCont</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>mite.env</span>)
<span class='fu'><a href='cca.html'>rda</a></span>(<span class='no'>mite.dw</span> ~ <span class='no'>Shrub</span> + <span class='no'>WatrCont</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>mite.env</span>)</div><div class='output co'>#&gt; Call: rda(formula = mite.dw ~ Shrub + WatrCont, data = mite.env)
#&gt; 
#&gt;               Inertia Proportion Rank
#&gt; Total         38.1640     1.0000     
#&gt; Constrained    9.2129     0.2414    3
#&gt; Unconstrained 28.9511     0.7586   35
#&gt; Inertia is variance 
#&gt; 
#&gt; Eigenvalues for constrained axes:
#&gt;  RDA1  RDA2  RDA3 
#&gt; 7.986 0.748 0.480 
#&gt; 
#&gt; Eigenvalues for unconstrained axes:
#&gt;   PC1   PC2   PC3   PC4   PC5   PC6   PC7   PC8 
#&gt; 5.886 3.634 2.791 2.592 1.932 1.573 1.210 1.078 
#&gt; (Showing 8 of 35 unconstrained eigenvalues)
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Eduard Szöcs <a href='mailto:eduardszoesc@gmail.com'>eduardszoesc@gmail.com</a> wrote the original
  <code>dispweight</code>, Jari Oksanen significantly modified the code,
  provided support functions and developed <code>gdispweight</code>.</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jari Oksanen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


